function isPC(){var a=navigator.userAgent.toLowerCase();var d=new Array("android","iphone","symbianos","windows phone","ipad","ipod");var b=true;for(var c=0;c<d.length;c++){if(a.indexOf(d[c])>0){b=false;break}}return b}function validateAmpInputCollection(a){function d(e){if(e==null||e==""){return true}return false}function b(e){if(d(e)){return true}if(isNaN(e)){return false}return true}var c=true;$(a).each(function(){var h=$(this).attr("amp-input-validate");var f=h.split(",");var e=$(this).find("input").val();var k=null;var j=false;f.forEach(function(l){if(!j&&l=="required"&&d(e)){k="不能为空!";c=false;j=true}if(!j&&l=="number"&&!b(e)){k="请输入数字!";c=false;j=true}});if(k==null){$(this).removeClass("amp-input-error")}else{$(this).find(".error-msg").remove();$(this).append("<div class='error-msg'><span>"+k+"</span></div>");$(this).addClass("amp-input-error")}});return c}var globalStorage=(function(a){var c=new Object();var b=new Object();if(typeof localStorage!=="undefined"){c=localStorage}if(typeof sessionStorage!=="undefined"){b=sessionStorage}a.setLocalData=function(d,e){c[d]=JSON.stringify(e)};a.getLocalData=function(d){if(c[d]==null){return null}return JSON.parse(c[d])};a.setSessionData=function(d,e){b[d]=JSON.stringify(e)};a.getSessionData=function(d){if(b[d]==null){return null}return JSON.parse(b[d])};return a})(globalStorage||{});(function(){var a=null;try{a=angular.module("amp-directive-collection")}catch(b){a=a||angular.module("amp-directive-collection",[])}$(document).on("click",function(c){c.stopPropagation();$(".amp-auto-complete").removeClass("open")});a.directive("ampAutoComplete",["$timeout",function(c){return{restrict:"C",template:"<input type='text'/><ul></ul>",scope:{reload:"&",source:"="},link:function(e,f,d){e.$watchCollection("source",function(k,j){if(k==null||!k instanceof Array||k.length==0){return}var l="";k.forEach(function(n){var o=n.id;var m=n.name;l+="<li data-id='"+o+"' data-name='"+m+"'>"+m+"</li>"});$(f).find("ul").html(l);$(f).addClass("open")});var h=null;$(f).on("keydown","input",function(k){k.stopPropagation();c.cancel(h);var j=this;h=c(function(){var l=$(j).val();e.reload({inputMsg:l})},1000)});$(f).on("click","ul li",function(k){k.stopPropagation();k.preventDefault();var l=$(this).attr("data-id");var j=$(this).attr("data-name");$(this).closest("ul").prev().val(j);$(f).attr("data-selected-id",l);$(f).attr("data-selected-name",j);$(f).removeClass("open")})}}}])})();(function(){var a=null;try{a=angular.module("amp-directive-collection")}catch(b){a=a||angular.module("amp-directive-collection",[])}a.directive("ampPaginationToolbar",["$timeout",function(c){return{restrict:"C",template:"<span>共{{paginationInfo.recordCount}}条记录,当前{{paginationInfo.pageNo}}/{{paginationInfo.pageCount}}页</span><div class='pagination-nav-group'>                                  	<a class='pagination-prev-btn'>&lt;</a>                          	<a class='pagination-next-btn'>&gt;</a>                          	<input type='number' ng-model='paginationInfo.pageNo'/>                        </div>                                                              <input type='hidden' value='{{paginationInfo.pageSize}}'/><a class='pagination-ok-btn'>确定</a>                               ",scope:{paginationInfo:"=",fetchData:"&"},link:function(e,f,d){$(f).on("click","a.pagination-prev-btn",function(h){h.stopPropagation();h.preventDefault();if(e.paginationInfo.pageNo==1){return}e.paginationInfo.pageNo--;e.fetchData()});$(f).on("click","a.pagination-next-btn",function(h){h.stopPropagation();h.preventDefault();e.paginationInfo.pageNo++;e.fetchData()});$(f).on("click","a.pagination-ok-btn",function(j){j.stopPropagation();j.preventDefault();var h=$(f).find(".pagination-nav-group input[type=number]").val();if(!isNaN(h)){e.paginationInfo.pageNo=parseInt(h)}e.fetchData()})}}}])})();var menu_list={amp_menu:[{name:"存量分析",index:"main-0",icon:"ys-icon-asset",links:"noi",target:"#",show_sub_menu:false,re_locate:true,sub_menu:[{name:"实际",index:"sub-0",links:"noi",target:"#page-frame",re_locate:true}]},{name:"投资分析",index:"main-1",icon:"ys-icon-finacial",links:"simulation_calculation_main",target:"#page-frame",show_sub_menu:false,re_locate:true,sub_menu:[{name:"模拟测算",index:"sub-1",links:"../amp/amp_financial_index.html",target:"#page-frame",re_locate:true}]},{name:"管理分析",index:"main-2",icon:"ys-icon-risk",links:"contract_main",target:"#page-frame",show_sub_menu:false,re_locate:true,sub_menu:[{name:"收入分析",index:"sub-1",links:"contract_main",target:"#page-frame",re_locate:true},{name:"支出分析",index:"sub-2",links:"cost_main",target:"#page-frame",re_locate:true},{name:"租赁分析",index:"sub-3",links:"rent_main",target:"#page-frame",re_locate:true},{name:"运营分析",index:"sub-4",links:"passenger_flow_main",target:"#page-frame",re_locate:true}]},{name:"风控分析",index:"main-3",icon:"ys-icon-tool",links:"blank",target:"#page-frame",show_sub_menu:false,re_locate:true,sub_menu:[{name:"租赁分析",index:"sub-3",links:"blank",target:"#page-frame",re_locate:true},{name:"运营分析",index:"sub-3",links:"blank",target:"#page-frame",re_locate:true}]},{name:"数据工具",index:"main-4",icon:"ys-icon-data",links:"rpgindex",target:"#page-frame",show_sub_menu:false,re_locate:true,sub_menu:[{name:"租金包",index:"sub-4",links:"rpgindex",target:"#page-frame",re_locate:true},{name:"沙盒模型",index:"sub-4",links:"datasim",target:"#page-frame",re_locate:true},{name:"回报计划",index:"sub-4",links:"irrplan",target:"#page-frame",re_locate:true}]}]};var amp_main=(function(e,b,f){var c=f;var m=b;var l;if(typeof m==="undefined"){alert("请先配置页面功能目录");return false}c.menu_init=function(p){var q=m[p];var n=e(".nav-bracket");var o=[];e.each(q,function(w,y){var F=y.name;var r=y.target;var D=y.links;var t=y.show_sub_menu;var v=y.re_locate;var C=y.show_page_header;var E=y.sub_menu;var s=E.length;var u=y.index;var B=w;var z=y.icon;if(t==false){var x=["<li>",'<a ui-sref="'+D,'" href="#/'+D,'" class="ys-menu-link"',' id="'+u+'"',' data-show-header="'+C+'"',' data-relocate="'+v+'">','<em class="ys-icon-spirit '+z+'"></em>',"<span>"+F+"</span>","</a></li>"].join("");o.push(x)}else{var A=[];if(s>=1){e.each(E,function(I,J){var G=I;var H=["<li>",'<a ui-sref="'+J.links+'" target="'+J.target+'" data-show-header="'+J.show_page_header+'" data-relocate="'+J.re_locate+'" id="sub-'+B+"-"+G+'">'+J.name+"</a>","</li>"].join("");A.push(H)})}var x=['<li class="nav-parent">','<a ui-sref="#header-tabs-'+w+'" class="ys-menu-link" id="'+u+'">','<em class="ys-icon-spirit '+z+'"></em>',"<span>"+F+"</span>","</a>",'<ul class="children">',A.join(""),"</ul>","</li>"].join("");o.push(x)}});n.empty().append(o.join(""))};c.header_tab_init=function(o){var p=m[o];var q=e(".head-main-menu");var n=[];e.each(p,function(t,y){var w=y.target;var r=y.sub_menu;var v=r.length;var u=t;var s=[];e.each(r,function(z,B){var A=z;var C=['<li role="presentation" id="nav-tabs-item-'+u+"-"+A+'">','<a ui-sref="'+B.links+'" href="#/'+B.links+'" role="tab" data-toggle="tab-temp" data-show-header="'+B.show_page_header+'" data-href="'+B.links+'" data-relocate="'+B.re_locate+'" id="nav-'+u+"-"+A+'">'+B.name+"</a>","</li>"];s.push(C.join(""))});var x=['<ul class="nav nav-tabs animated" role="tablist" id="header-tabs-'+u+'">',s.join(""),"</ul>"];n.push(x.join(""))});q.empty().append(n.join(""))};function k(){e(".nav-parent").each(function(){var n=e(this);if(n.hasClass("nav-active")){n.find("> ul").slideUp(200,function(){n.removeClass("nav-active")})}})}function d(){var n=e(document).height();if(n>e(".mainpanel").height()){e(".mainpanel").height(n)}}c.sideNav_init=function(){e(".nav-bracket > li").hover(function(){e(this).addClass("nav-hover")},function(){e(this).removeClass("nav-hover")});e(".nav-parent > a").click(function(p){var o=e(this).parent();var n=o.find("> ul");if(!e("body").hasClass("leftpanel-collapsed")){if(n.is(":visible")){n.slideUp(200,function(){o.removeClass("nav-active");e(".mainpanel").css({height:""});d()})}else{k();o.addClass("nav-active");n.slideDown(200,function(){d()})}}return false})};function a(o){var n=o.split("-");if(!e("#"+o).hasClass("active")){if(n[0]=="main"){e(".head-main-menu .nav-tabs").removeClass("active fadeIn");e("#header-tabs-"+n[1]).addClass("active fadeIn").find("li").removeClass("active");e("#nav-tabs-item-"+n[1]+"-"+0).addClass("active")}else{if(n[0]=="sub"){if(!e("#"+o).closest(".nav-parent").hasClass("active")){e(".head-main-menu .nav-tabs").removeClass("active fadeIn");e("#header-tabs-"+n[1]).addClass("active fadeIn").find("li").removeClass("active")}else{e("#header-tabs-"+n[1]).find("li").removeClass("active")}e("#nav-tabs-item-"+n[1]+"-"+n[2]).addClass("active")}}}}function j(p,n){var o=e("#"+p).data("relocate");if(o==true){e(".ys-amp").trigger("relocate",[p,n])}else{if(typeof o==="undefined"){e("#id").addClass("active");e(".ys-amp").trigger("relocate",[p,n])}}}c.sideNav_nav=function(){e(".nav-bracket  a").on("click touchend",function(p){if(e(this).hasClass("ys-menu-link")){var o=e(this).parent("li");if(!o.hasClass("active")&&!o.hasClass("nav-parent")){e(".nav-bracket li").removeClass("active");e(this).parent("li").addClass("active");e(".nav-active>ul").slideUp(200,function(){e(this).parent().removeClass("nav-active");e(".mainpanel").css({height:""});d()});var n=e(this).attr("href");var q=e(this).attr("id");a(q);j(q,n)}}else{var n=e(this).attr("href");var q=e(this).attr("id");a(q);j(q,n);if(!e(this).closest("li.nav-parent").hasClass("active")){e(".nav-bracket li").removeClass("active");e(this).parent("li").addClass("active").closest(".nav-parent").addClass("active")}else{if(!e(this).parent("li").hasClass("active")){e("ul.children li").removeClass("active");e(this).parent("li").addClass("active")}}}})};c.subNav_init=function(){e(".head-main-menu").on("click touchend","a",function(o){$this=e(this);if(!$this.parent("li").hasClass("active")){$this.closest("ul").find("li").removeClass("active");$this.parent("li").addClass("active");var p=$this.attr("id");var n=e(this).attr("href");j(p,n)}else{return}})};c.collapse_init=function(){e(".menutoggle").on("click touchend",function(o){o.preventDefault();var n=e("body");var p=n.css("position");if(!n.hasClass("leftpanel-collapsed")){n.addClass("leftpanel-collapsed");e(".nav-bracket ul").attr("style","");e(this).addClass("menu-collapsed")}else{n.removeClass("leftpanel-collapsed");e(".nav-bracket li.active ul").css({display:"block"});e(this).removeClass("menu-collapsed")}})};c.leftPanel_init=function(){var o=parseInt(e(window).height());e(".leftpanelinner").css({height:(o-100)+"px",overflow:"hidden"});l=new IScroll(".leftpanelinner",{mouseWheel:true,scrollbars:false});var p=null;var n=function(){var q=parseInt(e(window).height());e(".leftpanelinner").css({height:(q-100)+"px",overflow:"hidden"});l.refresh()};e(window).resize(function(){if(!p){p=setTimeout(function(){n();p=null},200)}else{clearTimeout(p);p=setTimeout(function(){n();p=null},200)}});setTimeout(n,300)};c.leftPanel_update=function(){var n=parseInt(e(window).height());e(".leftpanelinner").css({height:(n-100)+"px",overflow:"hidden"});l.refresh()};c.rightPanel_open=function(){e("body,html").css("overflow","hidden");e("body").addClass("open open-panel");e(".ys-amp").trigger("right_panel_open")};c.rightPanel_close=function(){e("body,html").css("overflow","auto");e("body").removeClass("open open-panel");e(".ys-amp").trigger("right_panel_close")};c.rightPanel_init=function(){e(".rightpanel").on("click touchend",".closebtn",function(n){n.preventDefault();c.rightPanel_close()})};c.loading_show=function(){e("body,html").css("overflow","hidden");e(".amp-loading").fadeIn()};c.loading_hide=function(){e("body,html").css("overflow","auto");e(".amp-loading").fadeOut()};c.placeholder_init=function(){e("#preloader").delay(350).fadeOut(function(){})};function h(){var n=navigator.userAgent;var p=new Array("Android","iPhone","SymbianOS","Windows Phone","iPad","iPod");var q=true;for(var o=0;o<p.length;o++){if(n.indexOf(p[o])>0){q=false;break}}return q}c.init=function(o){if(!o){o="amp_menu"}c.menu_init(o);c.header_tab_init(o);c.collapse_init();c.sideNav_init();c.sideNav_nav();c.subNav_init();c.leftPanel_init();c.rightPanel_init();var n=h();if(!n){e(".menutoggle").click()}};return c})(jQuery,menu_list,amp_main||{});"use strict";var ampApp=angular.module("amp",["ui.router","noi","ampFilters","ampFilter","commonService","amp-directive-collection","dataTool"]);ampApp.config(["$stateProvider","$urlRouterProvider",function(c,a){var b=[{name:"noi",url:"/noi",views:{toolbar:{templateUrl:"../components/toolbar/noi_filter.html",controller:"monthFilterController",controllerAs:"tCtrl"},content:{templateUrl:"../views/noi_analyse/noi.html",controller:"noiController",controllerAs:"noiCtrl"},right:{templateUrl:"../views/blank_right.html"}},controller:"page",resolve:{noiAllData:function(d){return d.getAllData()},data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}},{name:"rpgindex",url:"/rpgindex",views:{toolbar:{templateUrl:"../components/toolbar/rent_package_filter.html",controller:"dataFilterController",controllerAs:"fCtrl"},content:{templateUrl:"../views/datatools/datatool_rent_package.html",controller:"dataIndexController",controllerAs:"dCtrl"},right:{templateUrl:"../views/datatools/datatool_rent_package_rpanel.html",controller:"dataRightController",controllerAs:"rCtrl"}},resolve:{dataIndexData:function(d){return d.getIndexData()},data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}},{name:"irrplan",url:"/irrplan",views:{toolbar:{templateUrl:"../components/toolbar/blank_filter.html"},content:{templateUrl:"../views/datatools/datatool_irr_plan.html",controller:"irrPlanController",controllerAs:"pCtrl"},right:{templateUrl:"../views/blank_right.html"}},controller:"page",resolve:{irrPlanData:function(d){return d.getIrrData()},data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}},{name:"datasim",url:"/datasim",views:{toolbar:{templateUrl:"../components/toolbar/blank_filter.html"},content:{templateUrl:"../views/datatools/datatool_sim.html",controller:"dataSimController",controllerAs:"sCtrl"},right:{templateUrl:"../views/blank_right.html"}},controller:"page",resolve:{simData:function(d){return d.getIndexData()},simChartData:function(d){return d.getSimChartData()},data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}},{name:"rpgset",url:"/rpgset",views:{toolbar:{templateUrl:"../components/toolbar/blank_filter.html"},content:{templateUrl:"../views/datatools/datatool_rpg_set_index.html",controller:"dataSetController",controllerAs:"sCtrl"},right:{templateUrl:"../views/blank_right.html"}},controller:"page",resolve:{rpgSetData:function(d){return d.getSetData()},data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}}];c.state("simulation_calculation_main",{url:"/simulation_calculation_main",views:{toolbar:{},content:{controller:"simulation-calculation-main-controller",templateUrl:"../investment_analysis/simulation_calculation_main.html"},right:{}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("contract_main",{url:"/contract_main",views:{toolbar:{controller:"contract-main-left-controller",templateUrl:"../mgt_analysis/contract_main_left.html"},content:{controller:"contract-main-controller",templateUrl:"../mgt_analysis/contract_main.html"},enrolment:{controller:"contract-main-right-controller",templateUrl:"../mgt_analysis/contract_main_right.html"}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("business_main",{url:"/business_main",views:{toolbar:{controller:"business-main-left-controller",templateUrl:"../mgt_analysis/business_main_left.html"},content:{controller:"business-main-controller",templateUrl:"../mgt_analysis/business_main.html"},enrolment:{}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("business_merchant_list",{url:"/business_merchant_list",views:{toolbar:{controller:"business-merchant-list-left-controller",templateUrl:"../mgt_analysis/business_merchant_list_left.html"},content:{controller:"business-merchant-list-controller",templateUrl:"../mgt_analysis/business_merchant_list.html"},enrolment:{}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("business_merchant_detail",{url:"/business_merchant_detail",views:{toolbar:{controller:"business-merchant-detail-left-controller",templateUrl:"../mgt_analysis/business_merchant_detail_left.html"},content:{controller:"business-merchant-detail-controller",templateUrl:"../mgt_analysis/business_merchant_detail.html"},enrolment:{controller:"business-merchant-detail-enrolment-controller",templateUrl:"../mgt_analysis/business_merchant_detail_enrolment.html"}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("passenger_flow_main",{url:"/passenger_flow_main",views:{toolbar:{controller:"passenger-flow-main-left-controller",templateUrl:"../mgt_analysis/passenger_flow_main_left.html"},content:{controller:"passenger-flow-main-controller",templateUrl:"../mgt_analysis/passenger_flow_main.html"},enrolment:{}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("passenger_flow_main_enrolment",{url:"/passenger_flow_main_enrolment",views:{toolbar:{controller:"passenger-flow-main-enrolment-left-controller",templateUrl:"../mgt_analysis/passenger_flow_main_enrolment_left.html"},content:{controller:"passenger-flow-main-enrolment-controller",templateUrl:"../mgt_analysis/passenger_flow_main_enrolment.html"},enrolment:{}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("cost_main",{url:"/cost_main",views:{toolbar:{controller:"cost-main-left-controller",templateUrl:"../mgt_analysis/cost_main_left.html"},content:{controller:"cost-main-controller",templateUrl:"../mgt_analysis/cost_main.html"},enrolment:{controller:"cost-enrolment-controller",templateUrl:"../mgt_analysis/cost_enrolment.html"}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("cost_manual_work",{url:"/cost_manual_work",views:{toolbar:{controller:"cost-manual-work-left-controller",templateUrl:"../mgt_analysis/cost_manual_work_left.html"},content:{controller:"cost-manual-work-controller",templateUrl:"../mgt_analysis/cost_manual_work.html"},enrolment:{controller:"cost-manual-work-enrolment-controller",templateUrl:"../mgt_analysis/cost_manual_work_enrolment.html"}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("merchant_sale_main",{url:"/merchant_sale_main",views:{toolbar:{controller:"merchant-sale-main-left-controller",templateUrl:"../mgt_analysis/merchant_sale_main_left.html"},content:{controller:"merchant-sale-main-controller",templateUrl:"../mgt_analysis/merchant_sale_main.html"},enrolment:{}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("arrears_main",{url:"/arrears_main",views:{toolbar:{controller:"arrears-main-left-controller",templateUrl:"../mgt_analysis/arrears_main_left.html"},content:{controller:"arrears-main-controller",templateUrl:"../mgt_analysis/arrears_main.html"},enrolment:{}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("arrears_detail",{url:"/arrears_detail",views:{toolbar:{controller:"arrears-detail-left-controller",templateUrl:"../mgt_analysis/arrears_detail_left.html"},content:{controller:"arrears-detail-controller",templateUrl:"../mgt_analysis/arrears_detail.html"},enrolment:{controller:"arrears-enrolment-controller",templateUrl:"../mgt_analysis/arrears_enrolment.html"}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("arrears_enrolment",{url:"/arrears_enrolment",views:{toolbar:{templateUrl:"../mgt_analysis/arrears_enrolment_left.html"},content:{templateUrl:"../mgt_analysis/arrears_enrolment.html"},enrolment:{}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("shop_sale_type_list",{url:"/shop_sale_type_list",views:{toolbar:{controller:"shop-sale-type-list-left-controller",templateUrl:"../mgt_analysis/shop_sale_type_list_left.html"},content:{controller:"shop-sale-type-list-controller",templateUrl:"../mgt_analysis/shop_sale_type_list.html"},enrolment:{controller:"shop-sale-type-enrolment-controller",templateUrl:"../mgt_analysis/shop_sale_type_enrolment.html"}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("rent_main",{url:"/rent_main",views:{toolbar:{controller:"rent-main-left-controller",templateUrl:"../mgt_analysis/rent_main_left.html"},content:{controller:"rent-main-controller",templateUrl:"../mgt_analysis/rent_main.html"},enrolment:{}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("arrears_merchant_detail",{url:"/arrears_merchant_detail",views:{toolbar:{controller:"arrears-merchant-detail-left-controller",templateUrl:"../mgt_analysis/arrears_merchant_detail_left.html"},content:{controller:"arrears-merchant-detail-controller",templateUrl:"../mgt_analysis/arrears_merchant_detail.html"},enrolment:{controller:"arrears-merchant-detail-receiving-controller",templateUrl:"../mgt_analysis/arrears_merchant_detail_receiving.html"}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("shop_sale_rank",{url:"/shop_sale_rank",views:{toolbar:{},content:{controller:"shop-sale-rank-controller",templateUrl:"../mgt_analysis/shop_sale_rank.html"},enrolment:{}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});c.state("blank",{url:"/blank",views:{toolbar:{},content:{templateUrl:"../views/blank_page.html"},enrolment:{}},controller:"page",resolve:{data:["$q","$timeout",function(d,e){var f=d.defer();e(function(){f.resolve();amp_main.loading_hide()},300);return f.promise}]}});b.forEach(function(d){c.state(d)});a.when("","/noi");a.otherwise(function(d,e){e.path("/noi")})}]);ampApp.controller("MainController",["$rootScope","$scope","$location","$timeout",function(a,b,e,c){var d=window.location.search.slice(1).split("=")[1]||0;console.log(d);a.curProject=d;a.homePageIsShown=true;b.state={};a.$on("$stateChangeStart",function(k,f,h,l){var j=a.prev?a.prev:"";b.state.back=(f.name===j);b.state.toHome=(f.name==="noi");b.state.loading=false;b.state.enter=false;b.state.exit=true});a.$on("$stateChangeSuccess",function(k,f,j,l,h){a.curState=f.name;a.prev=l.name;b.state.enter=true;b.state.exit=false;b.state.loading=false;amp_main.leftPanel_update();ampApp.setNav(f.name)});a.$on("$viewContentLoading",function(h,f){b.state.loading=true});b.$on("$viewContentLoaded",function(f){b.state.loading=false});b.$on("data_filter",function(h,f){b.$broadcast("datatool_filter",f)});b.$on("right_open",function(h,f){b.rightOpened=f.right_open;if(b.rightOpened==true){amp_main.rightPanel_open()}else{amp_main.rightPanel_close()}});b.$on("monthUpdate",function(h,f){b.$broadcast("noiMonthUpdate",f)});b.rightOpened=false;b.goPath=function(f){if(f){var h=f.split("#/")[1]}b.$apply(function(){e.path(h)})};$(".ys-amp").on("relocate",function(h,j,f){b.goPath(f)});amp_main.init()}]);ampApp.nav_list={noi:{sideNav:"#main-0",headerBar:"#header-tabs-0",headerItem:"#nav-tabs-item-0-0"},rpgindex:{sideNav:"#main-4",headerBar:"#header-tabs-4",headerItem:"#nav-tabs-item-4-0"},rpgset:{sideNav:"#main-4",headerBar:"#header-tabs-4",headerItem:"#nav-tabs-item-4-0"},datasim:{sideNav:"#main-4",headerBar:"#header-tabs-4",headerItem:"#nav-tabs-item-4-1"},irrplan:{sideNav:"#main-4",headerBar:"#header-tabs-4",headerItem:"#nav-tabs-item-4-2"},business_merchant_list:{sideNav:"#main-2",headerBar:"#header-tabs-2",headerItem:"#nav-tabs-item-2-0"}};ampApp.setNav=function(b){var a=ampApp.nav_list[b];if(typeof a!=="undefined"){$(".leftpanelinner ul.nav-bracket").find("li").removeClass("active");$(a.sideNav).closest("li").addClass("active");$(".head-main-menu").children(".nav-tabs").removeClass("active");$(a.headerBar).addClass("active").find("li").removeClass("active").end().find(a.headerItem).addClass("active")}};ampApp.collector=(function(b,a){var c=a;c.array_swipers=[];c.array_datepickers=[];c.add_swiper=function(d){c.array_swipers.push(d)};c.add_datepicker=function(e){c.array_datepickers.push(e)};c.destory=function(){b.each(c.array_swipers,function(d,f){f.destroy(true,true)});c.array_swipers=[];b.each(c.array_datepickers,function(d,f){b(f.selector).datetimepicker("remove")});c.array_datepickers=[]};return c})(jQuery,ampApp.collector||{});"use strict";(function(){var a=a||angular.module("ampFilters",[]);a.filter("numberFormatDefault",["$filter",function(b){return function(c,d){if(isNaN(c)){return c}return b("number")(c,d)}}]);a.filter("stringFormat",[function(){return function(d,b,c){if(d==null||d==""){return c}return d+b}}])})();(function(){var a=angular.module("commonService",[]);a.factory("getPaginationResultFactory",[function(){return function(c,b,d){var f=d.length;var e=0;if(f%b>0){e=parseInt(f/b)+1}else{e=parseInt(f/b)}if(c>e){c=e}if(c<1){c=1}var h=d.slice((c-1)*b,c*b);return{recordCount:f,pageCount:e,records:h,pageSize:b,pageNo:c}}}])})();"use strict";var noi=angular.module("noi",[]);noi.controller("noiController",["$rootScope","$scope","noiAllData",function(h,j,b){var k=this;k.allData=b;k.noiData=b.noi[0].values;k.incomeData=b.income;k.feeData=b.fee;k.arrearageData=b.arrearage;k.chartData=b.chart;k.isSplit=function(l){return(l+1)%4==0};var a;var f,d;var e=function(){f=new Swiper("#noi-main-table-head",{direction:"horizontal",slidesPerView:"auto",freeMode:true,scrollbarHide:true});d=new Swiper("#noi-main-table",{scrollbar:".swiper-scrollbar",direction:"horizontal",slidesPerView:"auto",freeMode:true,scrollbarHide:false});f.params.control=d;d.params.control=f;a=$(".ys-table-fixed-top").pin({containerSelector:"#noi-main-table-wrapper",padding:{top:44,bottom:50}})};var c=function(){$(".ys-table-main").on("mouseenter","tr",function(n){var m=$(this).index();var l=$(this).parent().get(0).tagName;$(this).closest(".ys-table-main").find(".amp-table >"+l).each(function(o,p){$(this).find("tr").eq(m).addClass("hover")})});$(".ys-table-main").on("mouseleave","tr",function(n){var m=$(this).index();var l=$(this).parent().get(0).tagName;$(this).closest(".ys-table-main").find(".amp-table >"+l).each(function(o,p){$(this).find("tr").eq(m).removeClass("hover")})});$(".ys-table-main").on("click","tbody>tr",function(m){if($(this).hasClass("tr-main")){var l=$(this).index();$(this).closest(".ys-table-main").find(".amp-table").each(function(n,o){var q=$(this).find("tr").eq(l);q.toggleClass("tr-collapse");if(q.hasClass("tr-collapse")){q.nextUntil(".tr-main","tr").addClass("tr-collapsed")}else{q.nextUntil(".tr-main","tr.tr-sub").removeClass("tr-collapsed");var p=false;q.nextUntil(".tr-main","tr.tr-tri").each(function(r,s){if(r==0){p=$(this).prev(".tr-sub-main").hasClass("tr-collapse")}if(!p){$(this).removeClass("tr-collapsed")}})}});a.refresh()}if($(this).hasClass("tr-sub-main")){var l=$(this).index();$(this).closest(".ys-table-main").find(".amp-table").each(function(n,o){$(this).find("tr").eq(l).toggleClass("tr-collapse").nextUntil(".tr-sub").toggleClass("tr-collapsed")})}});$("#noi-arrearage").on("click","tr.tr-main",function(l){$(this).toggleClass("tr-collapse").nextAll("tr.tr-sub").toggle()});$(".tr-init-collapse").trigger("click")};e();c();j.$on("$destroy",function(){f.destroy(true,true);d.destroy(true,true)});j.$on("noiMonthUpdate",function(m,l){})}]);noi.controller("noiToolController",["$rootScope","$scope",function(a,b){b.$on("$destroy",function(){})}]);angular.module("noi").service("noiService",function(b,c){var a={getAllData:function(){return c.get("../data/data_"+b.curProject+"/noi/noi_all.json",{cache:true}).then(function(d){return d.data})},setChartOption:function(e,j){var d={lineData:{labels:["2015","2016","2017","2018","2019","2020"],datasets:[{type:"line",name:"NOI实际",xAxisIndex:0,yAxisIndex:0,symbol:"emptyCircle",symbolSize:6,showSymbol:true,lineStyle:{show:true,color:"#62cc7a",width:2,type:"solid"},data:[3456,4656,null,null,null,null]},{type:"line",name:"方案1",xAxisIndex:0,yAxisIndex:0,symbol:"emptyCircle",symbolSize:6,showSymbol:true,lineStyle:{show:true,color:"#ffb73a",width:2,type:"solid"},data:[4568.9,5323.4,5689.7,6784.5,8657.2,9922.4]},{type:"line",name:"方案2",xAxisIndex:0,yAxisIndex:0,symbol:"emptyCircle",symbolSize:6,showSymbol:true,lineStyle:{show:true,color:"#fe7171",width:2,type:"solid"},data:[6618.92,7359.42,7865.8,8993.03,9486.32,11029.11]},{type:"line",name:"方案3",xAxisIndex:0,yAxisIndex:0,symbol:"emptyCircle",symbolSize:6,showSymbol:true,lineStyle:{show:true,color:"#5fbaf4",width:2,type:"solid"},data:[6987.78,7892.78,8067.68,8862.5,9242.4,10378.98]}]}};var h={lineOpt:{title:{show:false},legend:{show:false},toolbox:{show:false},grid:{top:30,left:80,right:30,bottom:50},xAxis:{position:"bottom",type:"category",boundaryGap:true,axisLine:{show:true,lineStyle:{color:"#ececec",width:1,type:"solid"}},axisTick:{show:false,inside:true,length:3,lineStyle:{color:"#535861",width:1,type:"solid"}},axisLabel:{show:true,formatter:"{value}年",margin:12,textStyle:{color:"#666",fontStyle:"normal",fontSize:12}},splitLine:{show:false,lineStyle:{color:"#ececec",width:1,type:"solid"}},data:["2015","2016","2017","2018","2019","2020"]},yAxis:{min:0,max:"auto",axisLine:{show:false,lineStyle:{color:"#535861",width:1,type:"solid"}},axisTick:{show:false,inside:false,length:6,linStyle:{color:"#535861",width:1,type:"solid"}},axisLabel:{show:true,formatter:"{value}",margin:15,textStyle:{color:"#666",fontStyle:"normal",fontSize:12}},splitLine:{show:true,lineStyle:{color:"#ececec",width:1,type:"solid"}}},color:["#61cd78","#60bbf4","#fc7270","#feb739","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"],backgroundColor:"transparent",tooltip:{show:true,showContent:true,formatter:"{a}:<br/>{b}年-{c}万",textStyle:{fontSize:12,color:"#fff"}},series:[{type:"line",name:"NOI实际",xAxisIndex:0,yAxisIndex:0,symbol:"emptyCircle",symbolSize:6,showSymbol:true,lineStyle:{show:true,color:"#62cc7a",width:2,type:"solid"},data:[3456,4656,null,null,null,null]}]}};function f(l,m,k){if(k=="line"){d[k+"Data"].datasets[0].data=l[3].values;d[k+"Data"].datasets[1].data=l[0].values;d[k+"Data"].datasets[2].data=l[1].values;d[k+"Data"].datasets[3].data=l[2].values;d[k+"Data"].labels=m.values;h[k+"Opt"].xAxis.data=d[k+"Data"].labels;h[k+"Opt"].series=d[k+"Data"].datasets}return h[k+"Opt"]}return f(e,j,"line")}};return a});angular.module("noi").filter("checkmark",function(){return function(a){return a?"\u2713":"\u2718"}}).filter("numberFormat",function(){Number.prototype.formatMoney=function(m,k,f){var l=this,m=isNaN(m=Math.abs(m))?2:m,k=k==undefined?".":k,f=f==undefined?",":f,h=l<0?"-":"",e=String(parseInt(l=Math.abs(Number(l)||0).toFixed(m))),b=(b=e.length)>3?b%3:0;return h+(b?e.substr(0,b)+f:"")+e.substr(b).replace(/(\d{3})(?=\d)/g,"$1"+f)+(m?k+Math.abs(l-e).toFixed(m).slice(2):"")};function a(b){var c=/^(-?\d+)(\.\d+)?$/g;return c.test(b)}return function(c,b,d){if((b+1)%4==0){if(typeof d==="undefined"){d=2}if(a(c)){return parseFloat(c*100).toFixed(2)+"%"}else{return c}}else{if(typeof d==="undefined"){d=2}if(a(c)){return parseFloat(c).formatMoney(d,".",",")}else{return c}}}}).filter("percentFormat",function(){function a(b){var c=/^(-?\d+)(\.\d+)?$/g;return c.test(b)}return function(b){if(a(b)){return parseFloat(b*100).toFixed(2)+"%"}else{return b}}}).filter("skip",function(){return function(b,a){if(angular.isArray(b)){if(a>b.legend||a<1){return b}else{return b.slice(a)}}else{return b}}}).filter("take",function(a){return function(e,d,b){var c=a("skip")(e,d);return a("limitTo")(c,b)}});angular.module("noi").directive("lineChart",["noiService",function(a){return{restrict:"A",scope:{chartData:"=",chartLabels:"="},link:function(c,b){var e=echarts.init(b[0]);var h=c.chartData[0];var f=c.chartData.slice(1);var d=a.setChartOption(f,h);e.setOption(d);c.$watch("chartData",function(k,j){if(k){var n=c.chartData[0];var m=c.chartData.slice(1);var l=a.setChartOption(m,n);e.setOption(l)}})}}}]);var ampFilter=angular.module("ampFilter",[]);ampFilter.controller("monthFilterController",["$rootScope","$scope","$timeout",function(a,c,d){var b=this;b.selectedMonth=function(e){a.$broadcast("noiMonthUpdate",e)};b.curMonth="2016-11";c.$on("$destroy",function(){})}]);ampFilter.controller("dataSelectorController",["$rootScope","$scope",function(a,c,d){var b=this;c.$on("$destroy",function(){})}]);ampFilter.controller("dataFilterController",["$rootScope","$scope",function(a,c,d){var b=this;b.filters={project:a.projectName,floor:"",form:"",property:"",shopIndex:""};b.form_menu={projects:["商业公司A","商业公司B","商业公司C","商业公司D"],floors:["B1","F1","F2","F3","F4","F5","F6"],form:["超市","影院","服装","餐饮","娱乐","配套","儿童","其他"],property:["自持","销售","销售返租"]};b.addNew=function(){c.$emit("right_open",{right_open:true})};b.setModel=function(e,f){b.filters[e]=f};b.isActive=function(f,e){return f==e};b.reset=function(){b.filters={project:a.projectName,floor:"",form:"",property:"",shopIndex:""};c.$emit("data_filter",{name:"data_tool",filters:b.filters})};b.search=function(){console.dir(b.filters);c.$emit("data_filter",{name:"data_tool",filters:b.filters});console.log(b.filters)};b.addFocus=function(f){$(f.target).closest(".input-group").addClass("out-ring")};b.removeFocus=function(f){$(f.target).closest(".input-group").removeClass("out-ring")};c.$on("$destroy",function(){})}]);angular.module("ampFilter").directive("monthPicker",[function(){return{restrict:"A",scope:{monthSelect:"&"},require:"ngModel",template:'<div class="toolbar-item item-month-filter" style="padding:0;"><label for="month-filter">时间</label><div class="input-group date ys-datepicker" id="monthpicker"><span class="input-group-btn"><button class="btn btn-default" type="button" id="ys-date-pre"><em class="glyphicon glyphicon-arrow-left"></em></button></span><input size="16" type="text" value="" data-provide="datepicker" id="month-filter" name="month-filter" ><span class="input-group-btn"><button class="btn btn-default" type="button" id="ys-date-next"><em class="glyphicon glyphicon-arrow-right"></em></button></span></div></div>',link:function(j,k,h,a){function f(m,n,l){return new Date(m,n,l).getTime()}function b(m,o,l){var n=new Date(l);var p="";switch(m){case"y":n.setFullYear(n.getFullYear()+o);break;case"q":n.setMonth(n.getMonth()+o*3);break;case"m":n.setMonth(n.getMonth()+o);p=n.getFullYear()+"-"+(n.getMonth()<9?("0"+(n.getMonth()+1)):(n.getMonth()+1));break;case"w":n.setDate(n.getDate()+o*7);p=n.getFullYear()+"-"+(n.getMonth()<9?("0"+(n.getMonth()+1)):(n.getMonth()+1))+"-"+(n.getDate()<9?("0"+n.getDate()):n.getDate());break;case"d":n.setDate(n.getDate()+o);break;case"h":n.setHours(n.getHours()+o);break;case"mi":n.setMinutes(n.getMinutes()+o);break;case"s":n.setSeconds(n.getSeconds()+o);break;default:n.setDate(n.getDate()+o);break}if(p!=""){return p}else{return n.getFullYear()+"-"+(n.getMonth()<9?("0"+(n.getMonth()+1)):(n.getMonth()+1))+"-"+(n.getDate()<9?("0"+n.getDate()):n.getDate())}}var c=function(l){j.$apply(function(){a.$setViewValue(l)})};a.$render=function(){k.find("input").val(a.$viewValue)};var e;var d=function(){e=k.find("input").datetimepicker({format:"yyyy-mm",todayBtn:"linked",startView:3,minView:3,autoclose:true,language:"zh-CN"}).on("changeDate",function(m){var l=k.find("input").val();c(l);if(j.monthSelect){j.$apply(function(){j.monthSelect({date:l})})}});k.find("button").on("click",function(r){var q=$(this).attr("id");var s=1;if(q=="ys-date-pre"){s=-1}r.preventDefault();var p=k.find("input").val()||"";if(p==""){var o=new Date();var l=b("m",s,o);k.find("input").val(l);c(l);if(j.monthSelect){j.$apply(function(){j.monthSelect({date:l})})}}else{var n=p.split("-");var m=f(parseInt(n[0]),parseInt(n[1])-1,15);var l=b("m",s,m);k.find("input").val(l);c(l);if(j.monthSelect){j.$apply(function(){j.monthSelect({date:l})})}}})};d();k.find("input").on("focus",function(){$(this).closest(".input-group").addClass("out-ring")});k.find("input").on("blur",function(){$(this).closest(".input-group").removeClass("out-ring")});j.$on("$destroy",function(){k.find("input").datetimepicker("remove")})}}}]);var irr_plan=(function(e,b){var b=b;var d;var a,c;b.swiper_init=function(){a=new Swiper("#irr-plan-table-head",{direction:"horizontal",slidesPerView:"auto",freeMode:true,scrollbarHide:true});c=new Swiper("#irr-plan-main-table",{scrollbar:".swiper-scrollbar",direction:"horizontal",slidesPerView:"auto",freeMode:true,scrollbarHide:false});a.params.control=c;c.params.control=a;d=e(".ys-table-fixed-top").pin({containerSelector:"#irr-plan-table-wrapper",padding:{top:44,bottom:50}});var h=null;function f(){d.refresh()}e(window).resize(function(){if(!h){h=setTimeout(function(){f();h=null},200)}else{clearTimeout(h);h=setTimeout(function(){f();h=null},200)}})};b.irr_plan_swiper_reset=function(){a=new Swiper("#irr-plan-table-head",{direction:"horizontal",slidesPerView:"auto",freeMode:true,scrollbarHide:true});c=new Swiper("#irr-plan-main-table",{scrollbar:".swiper-scrollbar",direction:"horizontal",slidesPerView:"auto",freeMode:true,scrollbarHide:false});a.params.control=c;c.params.control=a};b.swiper_update=function(){b.destroy()};b.table_init=function(){e(".ys-table-main").on("mouseenter","tr",function(j){var h=e(this).index();var f=e(this).parent().get(0).tagName;e(this).closest(".ys-table-main").find(".amp-table >"+f).each(function(k,l){e(this).find("tr").eq(h).addClass("hover")})});e(".ys-table-main").on("mouseleave","tr",function(j){var h=e(this).index();var f=e(this).parent().get(0).tagName;e(this).closest(".ys-table-main").find(".amp-table >"+f).each(function(k,l){e(this).find("tr").eq(h).removeClass("hover")})})};b.destroy=function(){a.destroy(true,true);c.destroy(true,true)};b.init=function(){b.swiper_init();b.table_init()};return b})(jQuery,irr_plan||{});var amp_datePicker=(function(c,b){var b=b;function a(f,h,e){return new Date(f,h,e).getTime()}function d(f,j,e){var h=new Date(e);var k="";switch(f){case"y":h.setFullYear(h.getFullYear()+j);break;case"q":h.setMonth(h.getMonth()+j*3);break;case"m":h.setMonth(h.getMonth()+j);k=h.getFullYear()+"-"+(h.getMonth()<9?("0"+(h.getMonth()+1)):(h.getMonth()+1));break;case"w":h.setDate(h.getDate()+j*7);k=h.getFullYear()+"-"+(h.getMonth()<9?("0"+(h.getMonth()+1)):(h.getMonth()+1))+"-"+(h.getDate()<9?("0"+h.getDate()):h.getDate());break;case"d":h.setDate(h.getDate()+j);break;case"h":h.setHours(h.getHours()+j);break;case"mi":h.setMinutes(h.getMinutes()+j);break;case"s":h.setSeconds(h.getSeconds()+j);break;default:h.setDate(h.getDate()+j);break}if(k!=""){return k}else{return h.getFullYear()+"-"+(h.getMonth()<9?("0"+(h.getMonth()+1)):(h.getMonth()+1))+"-"+(h.getDate()<9?("0"+h.getDate()):h.getDate())}}b.dp_Array=[];b.daterangeSelector=function(){var h=new Date();var f=c("#daterange input#date-range-filter-start").val()||h.getFullYear()+"-"+(h.getMonth()+1)+"-"+(h.getDate());var m=c("#daterange input#date-range-filter-end").val();var e,l;var k=c("#daterange input#date-range-filter-start").datetimepicker({format:"yyyy-mm-dd",todayBtn:"linked",startView:2,minView:2,autoclose:true,language:"zh-CN"}).on("changeDate",function(o){var n=d("d",0,o.date);e=o.timeStamp;if(l){if(e>l){l=null;c("#daterange input#date-range-filter-end").val("")}}c("#daterange input#date-range-filter-end").datetimepicker("setStartDate",n)});var j=c("#daterange input#date-range-filter-end").datetimepicker({format:"yyyy-mm-dd",todayBtn:"linked",startView:2,minView:2,autoclose:true,language:"zh-CN"}).on("changeDate",function(n){l=n.timeStamp});c("#daterange input#date-range-filter-start").val(f);c("#daterange input#date-range-filter-end").val(m);b.dp_Array.push(k);b.dp_Array.push(j)};b.dateSelector=function(){var f=new Date();var e=c("#datepicker input").val()||f.getFullYear()+"-"+(f.getMonth()+1)+"-"+(f.getDate());var h=c("#datepicker input").datetimepicker({format:"yyyy-mm-dd",todayBtn:"linked",startView:2,minView:2,autoclose:true,language:"zh-CN"});c("#datepicker input").val(e);b.dp_Array.push(h)};b.destroy=function(){c.each(b.dp_Array,function(f,h){c(h.selector).datetimepicker("remove")});b.dp_Array=[]};return b})(jQuery,amp_datePicker||{});var dataTool=angular.module("dataTool",[]);dataTool.controller("dataIndexController",["$rootScope","$scope","dataIndexData","paginatorService","$timeout","$location","$filter",function(f,h,j,c,a,b,d){var k=this;var e=j.slice(1);k.indexData=e;k.recordsNum=k.indexData.length;k.pageLimit=10;k.pageNum=Math.ceil(parseFloat(k.recordsNum)/k.pageLimit);k.paginator=c(k.pageLimit,k.pageNum,k.indexData);k.loadPage=function(l){if(l>=k.pageNum){l=k.pageNum}else{if(l<=1){l=1}}k.paginator.setIndex(l)};k.shopEdit=function(l,m){f.$broadcast("shopEdit",{shopData:m,index:l})};k.shopUpdate=function(l,m){e[l]=m};h.$on("shopUpdate",function(m,l){k.shopUpdate(l.index,l.shop)});k.shopAdd=function(l,m){if(l=="add"){e.unshift(m);k.recordsNum=k.indexData.length;k.pageNum=Math.ceil(parseFloat(k.recordsNum)/k.pageLimit);k.paginator=c(k.pageLimit,k.pageNum,k.indexData)}else{if(l=="new"){}}};h.$on("shopAdd",function(m,l){k.shopAdd(l.index,l.shop)});h.$on("shopUpdateAdd",function(m,l){k.shopAdd(l.index,l.shop)});k.filters={};h.$on("datatool_filter",function(n,m){var l={};$.each(m.filters,function(p,o){if(p!=="project"&&o!==""){l[p]=o}});k.indexData=d("filter")(e,l);k.recordsNum=k.indexData.length;k.pageNum=Math.ceil(parseFloat(k.recordsNum)/k.pageLimit);k.paginator=c(k.pageLimit,k.pageNum,k.indexData)})}]);dataTool.controller("dataRightController",["$rootScope","$scope",function(a,c){var b=this;b.form_menu={projects:["商业公司A","商业公司B","商业公司C","商业公司D"],floors:["B1","F1","F2","F3","F4","F5","F6"],positions:["主入口","主立面外墙","次入口","主通道","侧面面街","后街"],form:["超市","影院","服装","餐饮","娱乐","配套","儿童","其他"],property:["自持","销售","销售返租"],type:["MAll","商业街"]};b.index="add";b.shopInfo={};c.$on("shopEdit",function(h,f){$("#rent-package-rpanel").find(".error").find("em.error-msg").remove().end().removeClass("error");c.shopInfoForm.$setPristine();c.shopInfoForm.$setUntouched();amp_main.rightPanel_open();b.index=f.index;b.shopInfo=f.shopData});b.save=function(){if(c.shopInfoForm.$invalid){alert("请输入正确的数据");return}if(typeof b.shopInfo.shopIndex==="undefined"||b.shopInfo.shopIndex==""){return}if(b.index=="add"){a.$broadcast("shopAdd",{index:b.index,shop:b.shopInfo});b.index="new"}else{if(b.index=="new"){a.$broadcast("shopUpdateAdd",{index:b.index,shop:b.shopInfo});b.index="new"}else{a.$broadcast("shopUpdate",{index:b.index,shop:b.shopInfo});amp_main.rightPanel_close();b.shopInfo={};b.index="add"}}};b.next=function(){b.index="add";b.shopInfo={}};b.setModel=function(e,f){b.shopInfo[e]=f};b.isActive=function(f,e){return f==e};b.reset=function(){b.index="add";b.shopInfo={}};function d(e){var f=e;var h="请输入正确的数据格式";if(f.hasClass("ng-invalid")){if((f).hasClass("ng-invalid-number")){h="请输入有效数字"}f.parent(".input-wrapper").addClass("error").append("<em class='error-msg'>"+h+"</em>")}else{f.parent().removeClass("error").find("em.error-msg").remove()}}$("#rent-package-rpanel").on("change","input",function(f){d($(f.target))});amp_main.leftPanel_update();$(".ys-tips").tooltip()}]);dataTool.controller("dataSetController",["$rootScope","$scope","rpgSetData",function(a,c,d){var b=this;b.setData=d[0].values;amp_main.leftPanel_update()}]);dataTool.controller("irrPlanController",["$rootScope","$scope","irrPlanData","$timeout","$location",function(e,j,f,a,b){var k=this;k.irrData=f;k.save=function(){amp_main.loading_show();a(function(){amp_main.loading_hide();b.path("noi")},1000)};var h=2;var d;j.years=["第1年","第2年","第3年","第4年","第5年","第6年","第7年","第8年","第9年","第10年"];k.quitYear=f[31].values[1].value;d=k.quitYear;k.quitRRate=f[32].values[1].value;k.quitFee=k.irrData[33].values[1].value;k.count=function(){var E=2;var D={subEmptyRate:k.irrData[5].values,anchorManageFee:k.irrData[7].values,manageFeeUpdate:k.irrData[10].values,multiIncomeRatio:k.irrData[13].values[1],propertyTaxes:k.irrData[16].values[1],salesTaxes:k.irrData[17].values[1],runCostRate:k.irrData[19].values,quitYear:k.irrData[31].values[1],quitRRate:k.irrData[32].values[1],quitFee:k.irrData[33].values[1],valOfYear:k.irrData[41].values[1],loanYears:k.irrData[42].values[1],loanPP:k.irrData[42].values[1],loanInterest:k.irrData[49].values[1]};var p={rentIncome:k.irrData[5].values.slice(2),manageFeeUpdate:k.irrData[10].values.slice(2),manageFeeIncome:k.irrData[11].values.slice(2),multiIncome:k.irrData[13].values.slice(2),totleRevenue:k.irrData[14].values.slice(2),propertyTaxes:k.irrData[16].values.slice(2),salesTaxes:k.irrData[17].values.slice(2),runCost:k.irrData[20].values.slice(2),expenseRatio:k.irrData[21].values.slice(2),expense:k.irrData[22].values.slice(2),noi:k.irrData[24].values.slice(2),roi:k.irrData[25].values.slice(2),roiRes:k.irrData[26].values.slice(2),quitRRate:k.irrData[32].values.slice(2),quitFee:k.irrData[33].values.slice(2),quitIncome:k.irrData[34].values.slice(2),unleveredCashFlow:k.irrData[35].values.slice(2),unleveredNRR:k.irrData[36].values.slice(2),unleveredIRR:k.irrData[37].values.slice(2),unleveredProfits:k.irrData[38].values.slice(2),unleveredRMBPP:k.irrData[39].values.slice(2),leveredValue:k.irrData[41].values.slice(2),loanPP:k.irrData[43].values.slice(2),loanMoney:k.irrData[45].values.slice(2),mortgageCashFlow:k.irrData[46].values.slice(2),quitPayment:k.irrData[47].values.slice(2),endLoan:k.irrData[48].values.slice(2),loanRate:k.irrData[49].values.slice(2),leveredCashFlow:k.irrData[50].values.slice(2),leveredNRR:k.irrData[51].values.slice(2),leveredIRR:k.irrData[52].values.slice(2),leveredProfits:k.irrData[53].values.slice(2),leveredRMBPP:k.irrData[54].values.slice(2)};if(typeof parseInt(k.irrData[31].values[1].value)!=="number"){alert("请输入正确的退出年");k.irrData[31].values[1].value=10}else{if(parseInt(k.irrData[31].values[1].value)>10||parseInt(k.irrData[31].values[1].value)<=1){alert("请输入2-10年为退出年");k.irrData[31].values[1].value=10}}k.quitYear=Math.abs(parseInt(k.irrData[31].values[1].value));function B(J){d=J;var L=parseInt(J);var K=150*L;var v=$("#irr-year");v.empty();for(i=0;i<L;i++){v.append("<th>第"+(i+1)+"年</th>")}$(".swiper-wrapper table").css("width",K+"px")}if(d!==k.quitYear){B(k.quitYear)}$.each(p.rentIncome,function(v,y){y.value=k.irrData[2].values[v+E].value+k.irrData[3].values[v+E].value*(1-k.irrData[4].values[v+E].value)});$.each(p.manageFeeIncome,function(v,y){y.value=parseFloat(k.irrData[7].values[v+E].value)+k.irrData[8].values[v+E].value*(1-k.irrData[4].values[v+E].value)});$.each(p.manageFeeUpdate,function(v,y){if(v==0){y.value=0}else{y.value=parseFloat(k.irrData[11].values[v+E].value)/parseFloat(k.irrData[11].values[v+E-1].value)-1}});$.each(p.multiIncome,function(v,y){y.value=k.irrData[5].values[v+E].value*k.irrData[13].values[1].value});$.each(p.totleRevenue,function(v,y){y.value=k.irrData[5].values[v+E].value+k.irrData[11].values[v+E].value+k.irrData[13].values[v+E].value});$.each(p.propertyTaxes,function(v,y){y.value=k.irrData[5].values[v+E].value*k.irrData[16].values[1].value});$.each(p.salesTaxes,function(v,y){y.value=k.irrData[14].values[v+E].value*k.irrData[17].values[1].value});$.each(p.runCost,function(v,y){if(v==0){y.value=parseFloat(k.irrData[20].values[1].value)*(parseFloat(k.irrData[2].values[1].value)+parseFloat(k.irrData[3].values[1].value))/10000}else{y.value=parseFloat(k.irrData[20].values[v+E-1].value)*(1+parseFloat(k.irrData[19].values[v+E].value))}});$.each(p.expense,function(v,y){y.value=parseFloat(k.irrData[20].values[v+E].value)+parseFloat(k.irrData[16].values[v+E].value)+parseFloat(k.irrData[17].values[v+E].value)});$.each(p.expenseRatio,function(v,y){y.value=parseFloat(k.irrData[20].values[v+E].value)/parseFloat(k.irrData[11].values[v+E].value)});$.each(p.noi,function(v,y){y.value=parseFloat(k.irrData[14].values[v+E].value)-parseFloat(k.irrData[22].values[v+E].value)});$.each(p.roi,function(v,y){y.value=parseFloat(Math.abs(k.irrData[24].values[v+E].value))/parseFloat(Math.abs(k.irrData[24].values[1].value))});$.each(p.roiRes,function(v,y){if(v==0){y.value=parseFloat(Math.abs(k.irrData[24].values[v+E].value))-parseFloat(Math.abs(k.irrData[24].values[1].value))}else{y.value=parseFloat(Math.abs(k.irrData[24].values[v+E].value))-parseFloat(Math.abs(k.irrData[26].values[v+E-1].value))}});var m=k.quitYear;for(i=0;i<m;i++){if(parseFloat(k.irrData[26].values[i+E].value)>0){var u=i;var F=parseFloat(Math.abs(k.irrData[26].values[u-1+E].value))/(parseFloat(Math.abs(k.irrData[26].values[u-1+E].value))+parseFloat(Math.abs(k.irrData[26].values[u+E].value)));k.irrData[26].values[1].value=u+F;break}else{k.irrData[26].values[1].value="-"}}k.quitRRate=f[32].values[1].value;k.quitFee=k.irrData[33].values[1].value;$.each(p.quitRRate,function(v,y){if(v==(k.quitYear-1)){y.value=parseFloat(Math.abs(k.irrData[24].values[v+E].value))/parseFloat(k.quitRRate)}else{}});$.each(p.quitFee,function(v,y){if(v==(k.quitYear-1)){y.value=parseFloat(Math.abs(k.irrData[32].values[v+E].value))*parseFloat(k.quitFee)}else{}});$.each(p.quitIncome,function(v,y){if(v==(k.quitYear-1)){y.value=parseFloat(Math.abs(k.irrData[32].values[v+E].value))-parseFloat(Math.abs(k.irrData[33].values[v+E].value))}else{y.value=0}});$.each(p.unleveredCashFlow,function(v,y){if(v==(k.quitYear-1)){y.value=parseFloat(Math.abs(k.irrData[24].values[v+E].value))+parseFloat(Math.abs(k.irrData[34].values[v+E].value))}else{y.value=parseFloat(Math.abs(k.irrData[24].values[v+E].value))}});$.each(p.unleveredNRR,function(v,y){y.value=parseFloat(Math.abs(k.irrData[24].values[v+E].value))/parseFloat(Math.abs(k.irrData[35].values[1].value))});var A=0;var H=k.quitYear;for(i=0;i<H;i++){A+=parseFloat(k.irrData[36].values[i+E].value)}k.irrData[36].values[1].value=A/H;var I=new Finance();var w=[];w.push(Math.abs(k.irrData[35].values[1].value)*(-1));for(i=0;i<H;i++){w.push(Math.abs(k.irrData[35].values[i+E].value))}var l=I.IRRAMP(w);k.irrData[37].values[1].value=l/100;var z=k.irrData[35].values.slice(2);var q=0;for(i=0;i<H;i++){q+=parseFloat(z[i].value)}k.irrData[38].values[1].value=q-parseFloat(Math.abs(k.irrData[35].values[1].value));k.irrData[39].values[1].value=parseFloat(k.irrData[38].values[1].value)/parseFloat(Math.abs(k.irrData[35].values[1].value));for(i=0;i<H;i++){if(i==(H-1)){k.irrData[41].values[i+E].value=parseFloat(Math.abs(k.irrData[24].values[i+E].value))/parseFloat(Math.abs(k.irrData[32].values[1].value))}else{k.irrData[41].values[i+E].value=parseFloat(Math.abs(k.irrData[24].values[i+E+1].value))/parseFloat(Math.abs(k.irrData[32].values[1].value))}}k.irrData[43].values[2].value=parseFloat(Math.abs(k.irrData[35].values[1].value))*parseFloat(Math.abs(k.irrData[43].values[1].value));k.irrData[45].values[1].value=k.irrData[43].values[2].value*(-1);$.each(p.loanMoney,function(v,y){y.value=k.irrData[45].values[1].value});$.each(p.quitPayment,function(v,y){if(v==(H-1)){y.value=k.irrData[45].values[1].value}else{y.value=0}});k.irrData[48].values[1].value=k.irrData[45].values[1].value;$.each(p.endLoan,function(v,y){if(v==(H-1)){y.value=0}else{y.value=k.irrData[45].values[1].value}});var o=k.irrData[49].values[1].value;var n=k.irrData[45].values[1].value;$.each(p.loanRate,function(v,y){y.value=o*n});k.irrData[50].values[1].value=parseFloat(Math.abs(k.irrData[24].values[1].value))-parseFloat(Math.abs(k.irrData[43].values[2].value));$.each(p.leveredCashFlow,function(v,y){if(v==(H-1)){y.value=k.irrData[24].values[v+E].value+k.irrData[34].values[v+E].value-Math.abs(k.irrData[49].values[v+E].value)-Math.abs(k.irrData[45].values[1].value)}else{y.value=k.irrData[24].values[v+E].value-Math.abs(k.irrData[49].values[v+E].value)}});var x=parseFloat(Math.abs(k.irrData[24].values[1].value))-parseFloat(Math.abs(k.irrData[43].values[2].value));$.each(p.leveredNRR,function(v,y){y.value=(parseFloat((k.irrData[50].values[v+E].value))+parseFloat(Math.abs(k.irrData[47].values[v+E].value)||0)-parseFloat(Math.abs(k.irrData[34].values[v+E].value))||0)/x});var t=0;for(i=0;i<H;i++){t+=parseFloat(k.irrData[51].values[i+E].value)}k.irrData[51].values[1].value=t/H;var G=[];G.push(Math.abs(k.irrData[50].values[1].value)*(-1));for(i=0;i<H;i++){G.push(Math.abs(k.irrData[50].values[i+E].value))}var s=I.IRRAMP(G);k.irrData[52].values[1].value=s/100;var C=k.irrData[50].values.slice(2);var r=0;for(i=0;i<H;i++){r+=parseFloat(C[i].value)}k.irrData[53].values[1].value=r-parseFloat(Math.abs(k.irrData[50].values[1].value));k.irrData[54].values[1].value=parseFloat(k.irrData[53].values[1].value)/parseFloat(Math.abs(k.irrData[50].values[1].value))};$(".table").on("click","td",function(){$(".table td").removeClass("active");$(this).addClass("active");$(this).find("input").focus()});function c(l){var m=l;var n="请输入正确的数据格式";if(m.hasClass("ng-invalid")){if((m).hasClass("ng-invalid-number")){n="请输入有效数字"}m.parent(".td-input-wrapper").append("<em class='error-msg'>"+n+"</em>")}else{m.parent().find("em.error-msg").remove()}}$(".table").on("change","input",function(l){c($(l.target));j.$apply(function(){k.count()})});irr_plan.init();k.count();amp_main.leftPanel_update();$(".ys-tips").tooltip();j.$on("$destroy",function(){irr_plan.destroy()})}]);dataTool.controller("dataSimController",["$rootScope","$scope","simData","simChartData","$location","$timeout",function(k,l,j,f,d,a){var m=this;if(typeof f==="undefined"){m.shops=[]}else{m.chartData=f.chart;m.shops=j.slice(1);m.index=0}m.form_menu={form:["超市","影院","服装","餐饮","娱乐","配套","儿童","其他"],property:["自持","销售","销售返租"],payRange:["月付","季付"]};m.shopInfo=m.shops[m.index];m.setShopInfo=function(n){l.$apply(function(){m.index+=1;m.shopInfo=m.shops[m.index]})};m.clearShopInfo=function(){l.$apply(function(){m.shopInfo={}})};m.setModel=function(n,o){m.shopInfo[n]=o};m.isActive=function(o,n){return o==n};m.dismiss=function(){var n=window.confirm("确定解约？")};m.checkReturn=function(){if(l.dataSimForm.$invalid){alert("请输入有效的数据");return false}else{amp_main.loading_show();a(function(){amp_main.loading_hide();d.path("irrplan")},1000)}};$("#datatool-sim").on("click",function(n){if(!$(n.target).hasClass("number-format")){$(".table td").removeClass("active")}});$(".table").on("click","td",function(n){$(".table td").removeClass("active");$(this).addClass("active");$(this).find("input").focus()});function e(n){var o=n;var p="请输入正确的数据格式";if(o.hasClass("ng-invalid")){if((o).hasClass("ng-invalid-number")){p="请输入有效数字"}o.parent(".td-input-wrapper").append("<em class='error-msg'>"+p+"</em>")}else{o.parent().find("em.error-msg").remove()}}$(".table").on("change","input",function(n){e($(n.target))});amp_datePicker.daterangeSelector();amp_datePicker.dateSelector();var c=function(){var p=parseInt($(window).height());$(".col-xs-6").css({"overflow-y":"hidden",height:(p-88-54)+"px"});var o=new IScroll("#datatool-sim-floor-table",{mouseWheel:true,scrollbars:true});var q=new IScroll("#datatool-sim-main-table",{mouseWheel:true,scrollbars:true});var r=null;var n=function(){var s=parseInt($(window).height());$(".col-xs-6").css({"overflow-y":"hidden",height:(s-88-54)+"px"});o.refresh();q.refresh()};$(window).resize(function(){if(!r){r=setTimeout(function(){n();r=null},200)}else{clearTimeout(r);r=setTimeout(function(){n();r=null},200)}});setTimeout(n,300)};function h(n){if(typeof n!=="undefined"&&n.shop_id!==""){l.$apply(function(){l.dataSimForm.$setPristine();l.dataSimForm.$setUntouched()});m.setShopInfo(n.shop_id)}else{l.$apply(function(){l.dataSimForm.$setPristine();l.dataSimForm.$setUntouched()});m.clearShopInfo()}}var b=function(){$.get("svg.svg",function(o,n){var p=document.importNode(o.documentElement,true);$("#ys-svg").append(p);svg_editor.refresh();svg_editor.init(h)})};c();b();l.$on("$destroy",function(){amp_datePicker.destroy()});$(".ys-tips").tooltip();amp_main.leftPanel_update()}]);angular.module("dataTool").service("dataIndexService",["$rootScope","$http",function(b,c){var a={getIndexData:function(){return c.get("../data/data_"+b.curProject+"/shopInfo.json",{cache:true}).then(function(d){return d.data})}};return a}]);angular.module("dataTool").service("dataSetService",["$rootScope","$http",function(b,c){var a={getSetData:function(){return c.get("../data/data_"+b.curProject+"/rent_setup_index.json",{cache:true}).then(function(d){return d.data})}};return a}]);angular.module("dataTool").service("irrPlanService",["$rootScope","$http",function(b,c){var a={getIrrData:function(){return c.get("../data/data_"+b.curProject+"/irrplan.json",{cache:true}).then(function(d){return d.data})}};return a}]);angular.module("dataTool").service("dataSimChart",["$rootScope","$http",function(b,c){var a={getSimChartData:function(){return c.get("../data/data_"+b.curProject+"/datasim_chart.json",{cache:true}).then(function(d){return d.data})}};return a}]);angular.module("dataTool").service("chartOptService",["$rootScope","$http",function(b,c){var a={setChartOption:function(e,j){var d={lineData:{labels:["2016","2017","2018"],datasets:[{type:"line",name:"实收",xAxisIndex:0,yAxisIndex:0,symbol:"emptyCircle",symbolSize:6,showSymbol:true,lineStyle:{show:true,color:"#ea7444",width:2,type:"solid"},data:[19470,null,null]},{type:"line",name:"应收",xAxisIndex:0,yAxisIndex:0,symbol:"emptyCircle",symbolSize:6,showSymbol:true,lineStyle:{show:true,color:"#18b0e2",width:2,type:"solid"},data:[36020,116820,80801]},{type:"line",name:"租金包",xAxisIndex:0,yAxisIndex:0,symbol:"emptyCircle",symbolSize:6,showSymbol:true,lineStyle:{show:true,color:"#1abd9d",width:2,type:"solid"},data:[31152,93456,102960]}]}};var h={lineOpt:{title:{show:false},legend:{show:false},toolbox:{show:false},grid:{top:30,left:80,right:30,bottom:50},xAxis:{position:"bottom",type:"category",boundaryGap:true,axisLine:{show:true,lineStyle:{color:"#ececec",width:1,type:"solid"}},axisTick:{show:false,inside:true,length:3,lineStyle:{color:"#535861",width:1,type:"solid"}},axisLabel:{show:true,formatter:"{value}年",margin:12,textStyle:{color:"#666",fontStyle:"normal",fontSize:12}},splitLine:{show:false,lineStyle:{color:"#ececec",width:1,type:"solid"}},data:["2015","2016","2017","2018","2019","2020"]},yAxis:{min:0,max:"auto",axisLine:{show:false,lineStyle:{color:"#535861",width:1,type:"solid"}},axisTick:{show:false,inside:false,length:6,linStyle:{color:"#535861",width:1,type:"solid"}},axisLabel:{show:true,formatter:"{value}",margin:15,textStyle:{color:"#666",fontStyle:"normal",fontSize:12}},splitLine:{show:true,lineStyle:{color:"#ececec",width:1,type:"solid"}}},color:["#ea7444","#18b0e2","#1abd9d","#feb739","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"],backgroundColor:"transparent",tooltip:{show:true,showContent:true,formatter:"{a}:<br/>{b}年-{c}万",textStyle:{fontSize:12,color:"#fff"}},series:[{type:"line",name:"应收",xAxisIndex:0,yAxisIndex:0,symbol:"emptyCircle",symbolSize:6,showSymbol:true,lineStyle:{show:true,color:"#18b0e2",width:2,type:"solid"},data:[36020,116820,80801]}]}};function f(l,m,k){if(k=="line"){d[k+"Data"].datasets[0].data=l[0].values;d[k+"Data"].datasets[1].data=l[1].values;d[k+"Data"].datasets[2].data=l[2].values;d[k+"Data"].labels=m.values;h[k+"Opt"].xAxis.data=d[k+"Data"].labels;h[k+"Opt"].series=d[k+"Data"].datasets}return h[k+"Opt"]}return f(e,j,"line")}};return a}]);angular.module("dataTool").factory("paginatorService",[function(){return function(d,c,b){var a={next:function(){if(this.hasNext()){this.currentOffset+=d;this.curPageIndex+=1;this.pageTarget=this.curPageIndex}},hasNext:function(){return parseInt(this.curPageIndex)<c},prev:function(){if(this.hasPrevious()){this.currentOffset-=d;this.curPageIndex-=1;this.pageTarget=this.curPageIndex}},hasPrevious:function(){return this.currentOffset!==0},_load:function(){var e=this;e.currentPageItems=b.slice(e.currentOffset,d)},setIndex:function(f){var e=this;e.curPageIndex=f;e.currentOffset=(f-1)*d;e.pageTarget=f},currentPageItems:[],currentOffset:0,curPageIndex:1,pageTarget:1};return a}}]);angular.module("dataTool").filter("skip",function(){return function(b,a){if(angular.isArray(b)){if(a>b.legend||a<1){return b}else{return b.slice(a)}}else{return b}}}).filter("take",function(a){return function(e,d,b){var c=a("skip")(e,d);return a("limitTo")(c,b)}}).filter("default",function(){return function(a,b){if(typeof b==="undefined"){return a}else{if(typeof a==="undefined"||a==""){return b}return a}}});angular.module("dataTool").directive("datePicker",[function(){return{restrict:"A",scope:{},require:"ngModel",template:'<div class="td-input-wrapper padding-r-15 date-input" id="datepicker"><input type="text" placeholder="" id="date-rent" readonly></div>',link:function(j,k,h,a){function f(m,n,l){return new Date(m,n,l).getTime()}function b(m,o,l){var n=new Date(l);var p="";switch(m){case"y":n.setFullYear(n.getFullYear()+o);break;case"q":n.setMonth(n.getMonth()+o*3);break;case"m":n.setMonth(n.getMonth()+o);p=n.getFullYear()+"-"+(n.getMonth()<9?("0"+(n.getMonth()+1)):(n.getMonth()+1));break;case"w":n.setDate(n.getDate()+o*7);p=n.getFullYear()+"-"+(n.getMonth()<9?("0"+(n.getMonth()+1)):(n.getMonth()+1))+"-"+(n.getDate()<9?("0"+n.getDate()):n.getDate());break;case"d":n.setDate(n.getDate()+o);break;case"h":n.setHours(n.getHours()+o);break;case"mi":n.setMinutes(n.getMinutes()+o);break;case"s":n.setSeconds(n.getSeconds()+o);break;default:n.setDate(n.getDate()+o);break}if(p!=""){return p}else{return n.getFullYear()+"-"+(n.getMonth()<9?("0"+(n.getMonth()+1)):(n.getMonth()+1))+"-"+(n.getDate()<9?("0"+n.getDate()):n.getDate())}}var c=function(l){j.$apply(function(){a.$setViewValue(new Date(l).getTime());console.log(a.$viewValue)})};console.log("-----------------ngModale");console.log(a.$viewValue);a.$render=function(){if(typeof a.$viewValue!=="undefined"){var l=b("d",0,a.$viewValue);k.find("input").val(l)}};var e;var d=function(){e=k.find("input").datetimepicker({format:"yyyy-mm-dd",todayBtn:"linked",startView:2,minView:2,autoclose:true,language:"zh-CN"}).on("changeDate",function(m){var l=k.find("input").val();c(l)})};d();j.$on("$destroy",function(){k.find("input").datetimepicker("remove")})}}}]);ampApp.controller("simulation-calculation-main-controller",["$scope","$http","$rootScope",function(n,k,l){var f=l.curProject;var c="PROJECT_"+f+"_CASE_INFO_";var d="PROJECT_"+f+"_LAST_CASE_SEQUENCE";var h="PROJECT_"+f+"_CURRENT_CASE_ID";var b="PROJECT_"+f+"_CURRENT_CASE_NAME";n.records=[];n.hideAdd=false;function p(u){var q=[];u.forEach(function(z){var y=z.caseId;var A=globalStorage.getLocalData(c+y);if(A==null){q.push(z)}else{q.push(A)}});var w=1;if(q.length>0){var v=q[q.length-1].caseId;w=parseInt(v.replace("case",""))+1}var s=globalStorage.getLocalData(d);for(var t=w;t<=s;t++){var r="case"+t;var x=globalStorage.getLocalData(c+r);if(x==null){continue}q.push(x)}n.records=q;if(q.length>=3){n.hideAdd=true}}n.$on("$destroy",function(){m()});var a=null;function j(){a=$("#simulation-calculation-main")}function e(){a.on("click",".case-content:not(.case-add-btn)",function(t){t.stopPropagation();t.preventDefault();var r=l.curProject;var q=$(this).attr("data-case-id");var s=$(this).attr("data-case-name");globalStorage.setLocalData(h,q);globalStorage.setLocalData(b,s);window.open("../investment_analysis/simulation_calculation.html?projectId="+r)});a.on("click",".case-content.case-add-btn",function(v){v.stopPropagation();v.preventDefault();var s=l.curProject;var r=n.records.length;if(r>=3){return}var w=1;if(n.records.length>0){var u=n.records[n.records.length-1].caseId;w=parseInt(u.replace("case",""))+1}var q="case"+w;var t="方案"+w;globalStorage.setLocalData(d,w);globalStorage.setLocalData(h,q);globalStorage.setLocalData(b,t);window.open("../investment_analysis/simulation_calculation.html?projectId="+s)})}function m(){}function o(){var q="../static/js/investment_analysis/data/"+f+"/simulation_calculation_main_data.json";k.get(q).success(function(r){p(r);j();e()})}o()}]);(function(m){var h="0.4.2",n="hasOwnProperty",b=/[\.\/]/,o=/\s*,\s*/,a="*",k=function(){},j=function(r,q){return r-q},f,l,p={n:{}},e=function(){for(var q=0,r=this.length;q<r;q++){if(typeof this[q]!="undefined"){return this[q]}}},d=function(){var q=this.length;while(--q){if(typeof this[q]!="undefined"){return this[q]}}},c=function(q,G){q=String(q);var A=p,w=l,B=Array.prototype.slice.call(arguments,2),D=c.listeners(q),C=0,y=false,t,s=[],x={},u=[],r=f,E=[];u.firstDefined=e;u.lastDefined=d;f=q;l=0;for(var v=0,F=D.length;v<F;v++){if("zIndex" in D[v]){s.push(D[v].zIndex);if(D[v].zIndex<0){x[D[v].zIndex]=D[v]}}}s.sort(j);while(s[C]<0){t=x[s[C++]];u.push(t.apply(G,B));if(l){l=w;return u}}for(v=0;v<F;v++){t=D[v];if("zIndex" in t){if(t.zIndex==s[C]){u.push(t.apply(G,B));if(l){break}do{C++;t=x[s[C]];t&&u.push(t.apply(G,B));if(l){break}}while(t)}else{x[t.zIndex]=t}}else{u.push(t.apply(G,B));if(l){break}}}l=w;f=r;return u};c._events=p;c.listeners=function(q){var y=q.split(b),w=p,C,x,r,u,B,t,v,z,A=[w],s=[];for(u=0,B=y.length;u<B;u++){z=[];for(t=0,v=A.length;t<v;t++){w=A[t].n;x=[w[y[u]],w[a]];r=2;while(r--){C=x[r];if(C){z.push(C);s=s.concat(C.f||[])}}}A=z}return s};c.on=function(q,t){q=String(q);if(typeof t!="function"){return function(){}}var u=q.split(o);for(var r=0,s=u.length;r<s;r++){(function(v){var A=v.split(b),z=p,y;for(var w=0,x=A.length;w<x;w++){z=z.n;z=z.hasOwnProperty(A[w])&&z[A[w]]||(z[A[w]]={n:{}})}z.f=z.f||[];for(w=0,x=z.f.length;w<x;w++){if(z.f[w]==t){y=true;break}}!y&&z.f.push(t)}(u[r]))}return function(v){if(+v==+v){t.zIndex=+v}}};c.f=function(r){var q=[].slice.call(arguments,1);return function(){c.apply(null,[r,null].concat(q).concat([].slice.call(arguments,0)))}};c.stop=function(){l=1};c.nt=function(q){if(q){return new RegExp("(?:\\.|\\/|^)"+q+"(?:\\.|\\/|$)").test(f)}return f};c.nts=function(){return f.split(b)};c.off=c.unbind=function(r,w){if(!r){c._events=p={n:{}};return}var y=r.split(o);if(y.length>1){for(var u=0,B=y.length;u<B;u++){c.off(y[u],w)}return}y=r.split(b);var x,A,s,u,B,t,v,z=[p];for(u=0,B=y.length;u<B;u++){for(t=0;t<z.length;t+=s.length-2){s=[t,1];x=z[t].n;if(y[u]!=a){if(x[y[u]]){s.push(x[y[u]])}}else{for(A in x){if(x[n](A)){s.push(x[A])}}}z.splice.apply(z,s)}}for(u=0,B=z.length;u<B;u++){x=z[u];while(x.n){if(w){if(x.f){for(t=0,v=x.f.length;t<v;t++){if(x.f[t]==w){x.f.splice(t,1);break}}!x.f.length&&delete x.f}for(A in x.n){if(x.n[n](A)&&x.n[A].f){var q=x.n[A].f;for(t=0,v=q.length;t<v;t++){if(q[t]==w){q.splice(t,1);break}}!q.length&&delete x.n[A].f}}}else{delete x.f;for(A in x.n){if(x.n[n](A)&&x.n[A].f){delete x.n[A].f}}}x=x.n}}};c.once=function(q,r){var s=function(){c.unbind(q,s);return r.apply(this,arguments)};return c.on(q,s)};c.version=h;c.toString=function(){return"You are running Eve "+h};(typeof module!="undefined"&&module.exports)?(module.exports=c):(typeof define==="function"&&define.amd?(define("eve",[],function(){return c})):(m.eve=c))})(this);(function(c,a){if(typeof define=="function"&&define.amd){define(["eve"],function(d){return a(c,d)})}else{if(typeof exports!="undefined"){var b=require("eve");module.exports=a(c,b)}else{a(c,c.eve)}}}(window||this,function(c,b){var a=(function(x){var n={},j=c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame||c.oRequestAnimationFrame||c.msRequestAnimationFrame||function(y){setTimeout(y,16)},p=Array.isArray||function(y){return y instanceof Array||Object.prototype.toString.call(y)=="[object Array]"},u=0,v="M"+(+new Date).toString(36),m=function(){return v+(u++).toString(36)},r=function(C,z,y,G){if(p(C)){res=[];for(var E=0,F=C.length;E<F;E++){res[E]=r(C[E],z,y[E],G)}return res}var D=(y-C)/(G-z);return function(A){return C+D*(A-z)}},q=Date.now||function(){return +new Date},f=function(A){var y=this;if(A==null){return y.s}var z=y.s-A;y.b+=y.dur*z;y.B+=y.dur*z;y.s=A},w=function(z){var y=this;if(z==null){return y.spd}y.spd=z},e=function(z){var y=this;if(z==null){return y.dur}y.s=y.s*z/y.dur;y.dur=z},o=function(){var y=this;delete n[y.id];y.update();x("mina.stop."+y.id,y)},k=function(){var y=this;if(y.pdif){return}delete n[y.id];y.update();y.pdif=y.get()-y.b},h=function(){var y=this;if(!y.pdif){return}y.b=y.get()-y.pdif;delete y.pdif;n[y.id]=y},l=function(){var y=this,A;if(p(y.start)){A=[];for(var z=0,B=y.start.length;z<B;z++){A[z]=+y.start[z]+(y.end[z]-y.start[z])*y.easing(y.s)}}else{A=+y.start+(y.end-y.start)*y.easing(y.s)}y.set(A)},s=function(){var z=0;for(var C in n){if(n.hasOwnProperty(C)){var A=n[C],y=A.get(),B;z++;A.s=(y-A.b)/(A.dur/A.spd);if(A.s>=1){delete n[C];A.s=1;z--;(function(D){setTimeout(function(){x("mina.finish."+D.id,D)})}(A))}A.update()}}z&&j(s)},t=function(I,z,H,y,C,J,G){var D={id:m(),start:I,end:z,b:H,s:0,dur:y-H,spd:1,get:C,set:J,easing:G||t.linear,status:f,speed:w,duration:e,stop:o,pause:k,resume:h,update:l};n[D.id]=D;var F=0,E;for(E in n){if(n.hasOwnProperty(E)){F++;if(F==2){break}}}F==1&&j(s);return D};t.time=q;t.getById=function(y){return n[y]||null};t.linear=function(y){return y};t.easeout=function(y){return Math.pow(y,1.7)};t.easein=function(y){return Math.pow(y,0.48)};t.easeinout=function(G){if(G==1){return 1}if(G==0){return 0}var C=0.48-G/1.04,B=Math.sqrt(0.1734+C*C),z=B-C,F=Math.pow(Math.abs(z),1/3)*(z<0?-1:1),E=-B-C,D=Math.pow(Math.abs(E),1/3)*(E<0?-1:1),A=F+D+0.5;return(1-A)*3*A*A+A*A*A};t.backin=function(z){if(z==1){return 1}var y=1.70158;return z*z*((y+1)*z-y)};t.backout=function(z){if(z==0){return 0}z=z-1;var y=1.70158;return z*z*((y+1)*z+y)+1};t.elastic=function(y){if(y==!!y){return y}return Math.pow(2,-10*y)*Math.sin((y-0.075)*(2*Math.PI)/0.3)+1};t.bounce=function(B){var z=7.5625,A=2.75,y;if(B<(1/A)){y=z*B*B}else{if(B<(2/A)){B-=(1.5/A);y=z*B*B+0.75}else{if(B<(2.5/A)){B-=(2.25/A);y=z*B*B+0.9375}else{B-=(2.625/A);y=z*B*B+0.984375}}}return y};c.mina=t;return t})(typeof b=="undefined"?function(){}:b);var d=(function(U){T.version="0.4.0";function T(E,S){if(E){if(E.nodeType){return aq(E)}if(V(E,"array")&&T.set){return T.set.apply(T,E)}if(E instanceof u){return E}if(S==null){E=W.doc.querySelector(String(E));return aq(E)}}E=E==null?"100%":E;S=S==null?"100%":S;return new ao(E,S)}T.toString=function(){return"Snap v"+this.version};T._={};var W={win:U.window,doc:U.window.document};T._.glob=W;var l="hasOwnProperty",I=String,f=parseFloat,v=parseInt,aa=Math,s=aa.max,am=aa.min,ad=aa.abs,Y=aa.pow,n=aa.PI,au=aa.round,z="",o=" ",P=Object.prototype.toString,al=/^url\(['"]?([^\)]+?)['"]?\)$/i,ag=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\))\s*$/i,m=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,C=/^url\(#?([^)]+)\)$/,ay=T._.separator=/[,\s]+/,Z=/[\s]/g,at=/[\s]*,[\s]*/,k={hs:1,rg:1},ap=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?[\s]*)+)/ig,y=/([rstm])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?[\s]*)+)/ig,L=/(-?\d*\.?\d*(?:e[\-+]?\\d+)?)[\s]*,?[\s]*/ig,x=0,t="S"+(+new Date).toString(36),Q=function(E){return(E&&E.type?E.type:z)+t+(x++).toString(36)},D="http://www.w3.org/1999/xlink",A="http://www.w3.org/2000/svg",an={},aj=T.url=function(E){return"url('#"+E+"')"};function ak(az,E){if(E){if(az=="#text"){az=W.doc.createTextNode(E.text||E["#text"]||"")}if(az=="#comment"){az=W.doc.createComment(E.text||E["#text"]||"")}if(typeof az=="string"){az=ak(az)}if(typeof E=="string"){if(az.nodeType==1){if(E.substring(0,6)=="xlink:"){return az.getAttributeNS(D,E.substring(6))}if(E.substring(0,4)=="xml:"){return az.getAttributeNS(A,E.substring(4))}return az.getAttribute(E)}else{if(E=="text"){return az.nodeValue}else{return null}}}if(az.nodeType==1){for(var S in E){if(E[l](S)){var aA=I(E[S]);if(aA){if(S.substring(0,6)=="xlink:"){az.setAttributeNS(D,S.substring(6),aA)}else{if(S.substring(0,4)=="xml:"){az.setAttributeNS(A,S.substring(4),aA)}else{az.setAttribute(S,aA)}}}else{az.removeAttribute(S)}}}}else{if("text" in E){az.nodeValue=E.text}}}else{az=W.doc.createElementNS(A,az)}return az}T._.$=ak;T._.id=Q;function p(aB){var az=aB.attributes,S,E={};for(var aA=0;aA<az.length;aA++){if(az[aA].namespaceURI==D){S="xlink:"}else{S=""}S+=az[aA].name;E[S]=az[aA].textContent}return E}function V(S,E){E=I.prototype.toLowerCase.call(E);if(E=="finite"){return isFinite(S)}if(E=="array"&&(S instanceof Array||Array.isArray&&Array.isArray(S))){return true}return(E=="null"&&S===null)||(E==typeof S&&S!==null)||(E=="object"&&S===Object(S))||P.call(S).slice(8,-1).toLowerCase()==E}T.format=(function(){var az=/\{([^\}]+)\}/g,E=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,S=function(aC,aB,aD){var aA=aD;aB.replace(E,function(aG,aF,aE,aI,aH){aF=aF||aI;if(aA){if(aF in aA){aA=aA[aF]}typeof aA=="function"&&aH&&(aA=aA())}});aA=(aA==null||aA==aD?aC:aA)+"";return aA};return function(aB,aA){return I(aB).replace(az,function(aD,aC){return S(aD,aC,aA)})}})();function O(az){if(typeof az=="function"||Object(az)!==az){return az}var S=new az.constructor;for(var E in az){if(az[l](E)){S[E]=O(az[E])}}return S}T._.clone=O;function ax(aA,az){for(var E=0,S=aA.length;E<S;E++){if(aA[E]===az){return aA.push(aA.splice(E,1)[0])}}}function aw(aA,S,E){function az(){var aB=Array.prototype.slice.call(arguments,0),aD=aB.join("\u2400"),aC=az.cache=az.cache||{},aE=az.count=az.count||[];if(aC[l](aD)){ax(aE,aD);return E?E(aC[aD]):aC[aD]}aE.length>=1000&&delete aC[aE.shift()];aE.push(aD);aC[aD]=aA.apply(S,aB);return E?E(aC[aD]):aC[aD]}return az}T._.cacher=aw;function K(aB,aD,az,aC,S,aA){if(S==null){var E=aB-az,aE=aD-aC;if(!E&&!aE){return 0}return(180+aa.atan2(-aE,-E)*180/n+360)%360}else{return K(aB,aD,S,aA)-K(az,aC,S,aA)}}function j(E){return E%360*n/180}function J(E){return E*180/n%360}function ar(){return this.x+o+this.y}function G(){return this.x+o+this.y+o+this.width+" \xd7 "+this.height}T.rad=j;T.deg=J;T.sin=function(E){return aa.sin(T.rad(E))};T.tan=function(E){return aa.tan(T.rad(E))};T.cos=function(E){return aa.cos(T.rad(E))};T.asin=function(E){return T.deg(aa.asin(E))};T.acos=function(E){return T.deg(aa.acos(E))};T.atan=function(E){return T.deg(aa.atan(E))};T.atan2=function(E){return T.deg(aa.atan2(E))};T.angle=K;T.len=function(S,aA,E,az){return Math.sqrt(T.len2(S,aA,E,az))};T.len2=function(S,aA,E,az){return(S-E)*(S-E)+(aA-az)*(aA-az)};T.closestPoint=function(aI,aD,aC){function aK(aS){var aR=aS.x-aD,aQ=aS.y-aC;return aR*aR+aQ*aQ}var aF=aI.node,aL=aF.getTotalLength(),aM=aL/aF.pathSegList.numberOfItems*0.125,S,aA,aO=Infinity;for(var aH,E=0,aJ;E<=aL;E+=aM){if((aJ=aK(aH=aF.getPointAtLength(E)))<aO){S=aH,aA=E,aO=aJ}}aM*=0.5;while(aM>0.5){var aG,az,aE,aP,aB,aN;if((aE=aA-aM)>=0&&(aB=aK(aG=aF.getPointAtLength(aE)))<aO){S=aG,aA=aE,aO=aB}else{if((aP=aA+aM)<=aL&&(aN=aK(az=aF.getPointAtLength(aP)))<aO){S=az,aA=aP,aO=aN}else{aM*=0.5}}}S={x:S.x,y:S.y,length:aA,distance:Math.sqrt(aO)};return S};T.is=V;T.snapTo=function(S,aA,E){E=V(E,"finite")?E:10;if(V(S,"array")){var az=S.length;while(az--){if(ad(S[az]-aA)<=E){return S[az]}}}else{S=+S;var aB=aA%S;if(aB<E){return aA-aB}if(aB>S-E){return aA-aB+S}}return aA};T.getRGB=aw(function(E){if(!E||!!((E=I(E)).indexOf("-")+1)){return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:e}}if(E=="none"){return{r:-1,g:-1,b:-1,hex:"none",toString:e}}!(k[l](E.toLowerCase().substring(0,2))||E.charAt()=="#")&&(E=w(E));if(!E){return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:e}}var aB,S,az,aD,aA,aF,aE,aC=E.match(ag);if(aC){if(aC[2]){aD=v(aC[2].substring(5),16);az=v(aC[2].substring(3,5),16);S=v(aC[2].substring(1,3),16)}if(aC[3]){aD=v((aF=aC[3].charAt(3))+aF,16);az=v((aF=aC[3].charAt(2))+aF,16);S=v((aF=aC[3].charAt(1))+aF,16)}if(aC[4]){aE=aC[4].split(at);S=f(aE[0]);aE[0].slice(-1)=="%"&&(S*=2.55);az=f(aE[1]);aE[1].slice(-1)=="%"&&(az*=2.55);aD=f(aE[2]);aE[2].slice(-1)=="%"&&(aD*=2.55);aC[1].toLowerCase().slice(0,4)=="rgba"&&(aA=f(aE[3]));aE[3]&&aE[3].slice(-1)=="%"&&(aA/=100)}if(aC[5]){aE=aC[5].split(at);S=f(aE[0]);aE[0].slice(-1)=="%"&&(S/=100);az=f(aE[1]);aE[1].slice(-1)=="%"&&(az/=100);aD=f(aE[2]);aE[2].slice(-1)=="%"&&(aD/=100);(aE[0].slice(-3)=="deg"||aE[0].slice(-1)=="\xb0")&&(S/=360);aC[1].toLowerCase().slice(0,4)=="hsba"&&(aA=f(aE[3]));aE[3]&&aE[3].slice(-1)=="%"&&(aA/=100);return T.hsb2rgb(S,az,aD,aA)}if(aC[6]){aE=aC[6].split(at);S=f(aE[0]);aE[0].slice(-1)=="%"&&(S/=100);az=f(aE[1]);aE[1].slice(-1)=="%"&&(az/=100);aD=f(aE[2]);aE[2].slice(-1)=="%"&&(aD/=100);(aE[0].slice(-3)=="deg"||aE[0].slice(-1)=="\xb0")&&(S/=360);aC[1].toLowerCase().slice(0,4)=="hsla"&&(aA=f(aE[3]));aE[3]&&aE[3].slice(-1)=="%"&&(aA/=100);return T.hsl2rgb(S,az,aD,aA)}S=am(aa.round(S),255);az=am(aa.round(az),255);aD=am(aa.round(aD),255);aA=am(s(aA,0),1);aC={r:S,g:az,b:aD,toString:e};aC.hex="#"+(16777216|aD|(az<<8)|(S<<16)).toString(16).slice(1);aC.opacity=V(aA,"finite")?aA:1;return aC}return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:e}},T);T.hsb=aw(function(az,S,E){return T.hsb2rgb(az,S,E).hex});T.hsl=aw(function(az,S,E){return T.hsl2rgb(az,S,E).hex});T.rgb=aw(function(aA,az,E,aB){if(V(aB,"finite")){var S=aa.round;return"rgba("+[S(aA),S(az),S(E),+aB.toFixed(2)]+")"}return"#"+(16777216|E|(az<<8)|(aA<<16)).toString(16).slice(1)});var w=function(E){var S=W.doc.getElementsByTagName("head")[0]||W.doc.getElementsByTagName("svg")[0],az="rgb(255, 0, 0)";w=aw(function(aA){if(aA.toLowerCase()=="red"){return az}S.style.color=az;S.style.color=aA;var aB=W.doc.defaultView.getComputedStyle(S,z).getPropertyValue("color");return aB==az?null:aB});return w(E)},q=function(){return"hsb("+[this.h,this.s,this.b]+")"},M=function(){return"hsl("+[this.h,this.s,this.l]+")"},e=function(){return this.opacity==1||this.opacity==null?this.hex:"rgba("+[this.r,this.g,this.b,this.opacity]+")"},av=function(aA,az,E){if(az==null&&V(aA,"object")&&"r" in aA&&"g" in aA&&"b" in aA){E=aA.b;az=aA.g;aA=aA.r}if(az==null&&V(aA,string)){var S=T.getRGB(aA);aA=S.r;az=S.g;E=S.b}if(aA>1||az>1||E>1){aA/=255;az/=255;E/=255}return[aA,az,E]},af=function(aA,az,E,aB){aA=aa.round(aA*255);az=aa.round(az*255);E=aa.round(E*255);var S={r:aA,g:az,b:E,opacity:V(aB,"finite")?aB:1,hex:T.rgb(aA,az,E),toString:e};V(aB,"finite")&&(S.opacity=aB);return S};T.color=function(E){var S;if(V(E,"object")&&"h" in E&&"s" in E&&"b" in E){S=T.hsb2rgb(E);E.r=S.r;E.g=S.g;E.b=S.b;E.opacity=1;E.hex=S.hex}else{if(V(E,"object")&&"h" in E&&"s" in E&&"l" in E){S=T.hsl2rgb(E);E.r=S.r;E.g=S.g;E.b=S.b;E.opacity=1;E.hex=S.hex}else{if(V(E,"string")){E=T.getRGB(E)}if(V(E,"object")&&"r" in E&&"g" in E&&"b" in E&&!("error" in E)){S=T.rgb2hsl(E);E.h=S.h;E.s=S.s;E.l=S.l;S=T.rgb2hsb(E);E.v=S.b}else{E={hex:"none"};E.r=E.g=E.b=E.h=E.s=E.v=E.l=-1;E.error=1}}}E.toString=e;return E};T.hsb2rgb=function(aC,aF,aD,aA){if(V(aC,"object")&&"h" in aC&&"s" in aC&&"b" in aC){aD=aC.b;aF=aC.s;aA=aC.o;aC=aC.h}aC*=360;var aB,aE,S,az,E;aC=(aC%360)/60;E=aD*aF;az=E*(1-ad(aC%2-1));aB=aE=S=aD-E;aC=~~aC;aB+=[E,az,0,0,az,E][aC];aE+=[az,E,E,az,0,0][aC];S+=[0,0,az,E,E,az][aC];return af(aB,aE,S,aA)};T.hsl2rgb=function(aD,aF,aB,aA){if(V(aD,"object")&&"h" in aD&&"s" in aD&&"l" in aD){aB=aD.l;aF=aD.s;aD=aD.h}if(aD>1||aF>1||aB>1){aD/=360;aF/=100;aB/=100}aD*=360;var aC,aE,S,az,E;aD=(aD%360)/60;E=2*aF*(aB<0.5?aB:1-aB);az=E*(1-ad(aD%2-1));aC=aE=S=aB-E/2;aD=~~aD;aC+=[E,az,0,0,az,E][aD];aE+=[az,E,E,az,0,0][aD];S+=[0,0,az,E,E,az][aD];return af(aC,aE,S,aA)};T.rgb2hsb=function(aD,aC,E){E=av(aD,aC,E);aD=E[0];aC=E[1];E=E[2];var aB,aA,az,aE;az=s(aD,aC,E);aE=az-am(aD,aC,E);aB=(aE==0?null:az==aD?(aC-E)/aE:az==aC?(E-aD)/aE+2:(aD-aC)/aE+4);aB=((aB+360)%6)*60/360;aA=aE==0?0:aE/az;return{h:aB,s:aA,b:az,toString:q}};T.rgb2hsl=function(E,aC,aF){aF=av(E,aC,aF);E=aF[0];aC=aF[1];aF=aF[2];var aG,aB,aE,aD,aA,az;aD=s(E,aC,aF);aA=am(E,aC,aF);az=aD-aA;aG=(az==0?null:aD==E?(aC-aF)/az:aD==aC?(aF-E)/az+2:(E-aC)/az+4);aG=((aG+360)%6)*60/360;aE=(aD+aA)/2;aB=(az==0?0:aE<0.5?az/(2*aE):az/(2-2*aE));return{h:aG,s:aB,l:aE,toString:M}};T.parsePathString=function(E){if(!E){return null}var az=T.path(E);if(az.arr){return T.path.clone(az.arr)}var aA={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},S=[];if(V(E,"array")&&V(E[0],"array")){S=T.path.clone(E)}if(!S.length){I(E).replace(ap,function(aC,aB,aF){var aE=[],aD=aB.toLowerCase();aF.replace(L,function(aH,aG){aG&&aE.push(+aG)});if(aD=="m"&&aE.length>2){S.push([aB].concat(aE.splice(0,2)));aD="l";aB=aB=="m"?"l":"L"}if(aD=="o"&&aE.length==1){S.push([aB,aE[0]])}if(aD=="r"){S.push([aB].concat(aE))}else{while(aE.length>=aA[aD]){S.push([aB].concat(aE.splice(0,aA[aD])));if(!aA[aD]){break}}}})}S.toString=T.path.toString;az.arr=T.path.clone(S);return S};var ac=T.parseTransformString=function(S){if(!S){return null}var az={r:3,s:4,t:2,m:6},E=[];if(V(S,"array")&&V(S[0],"array")){E=T.path.clone(S)}if(!E.length){I(S).replace(y,function(aB,aA,aE){var aD=[],aC=aA.toLowerCase();aE.replace(L,function(aG,aF){aF&&aD.push(+aF)});E.push([aA].concat(aD))})}E.toString=T.path.toString;return E};function ae(E){var S=[];E=E.replace(/(?:^|\s)(\w+)\(([^)]+)\)/g,function(aA,az,aB){aB=aB.split(/\s*,\s*|\s+/);if(az=="rotate"&&aB.length==1){aB.push(0,0)}if(az=="scale"){if(aB.length>2){aB=aB.slice(0,2)}else{if(aB.length==2){aB.push(0,0)}}if(aB.length==1){aB.push(aB[0],0,0)}}if(az=="skewX"){S.push(["m",1,0,aa.tan(j(aB[0])),1,0,0])}else{if(az=="skewY"){S.push(["m",1,aa.tan(j(aB[0])),0,1,0,0])}else{S.push([az.charAt(0)].concat(aB))}}return aA});return S}T._.svgTransform2string=ae;T._.rgTransform=/^[a-z][\s]*-?\.?\d/i;function N(aE,aK){var aC=ac(aE),az=new T.Matrix;if(aC){for(var aD=0,aL=aC.length;aD<aL;aD++){var aM=aC[aD],aA=aM.length,aB=I(aM[0]).toLowerCase(),aJ=aM[0]!=aB,aH=aJ?az.invert():0,S,aI,E,aG,aF;if(aB=="t"&&aA==2){az.translate(aM[1],0)}else{if(aB=="t"&&aA==3){if(aJ){S=aH.x(0,0);aI=aH.y(0,0);E=aH.x(aM[1],aM[2]);aG=aH.y(aM[1],aM[2]);az.translate(E-S,aG-aI)}else{az.translate(aM[1],aM[2])}}else{if(aB=="r"){if(aA==2){aF=aF||aK;az.rotate(aM[1],aF.x+aF.width/2,aF.y+aF.height/2)}else{if(aA==4){if(aJ){E=aH.x(aM[2],aM[3]);aG=aH.y(aM[2],aM[3]);az.rotate(aM[1],E,aG)}else{az.rotate(aM[1],aM[2],aM[3])}}}}else{if(aB=="s"){if(aA==2||aA==3){aF=aF||aK;az.scale(aM[1],aM[aA-1],aF.x+aF.width/2,aF.y+aF.height/2)}else{if(aA==4){if(aJ){E=aH.x(aM[2],aM[3]);aG=aH.y(aM[2],aM[3]);az.scale(aM[1],aM[1],E,aG)}else{az.scale(aM[1],aM[1],aM[2],aM[3])}}else{if(aA==5){if(aJ){E=aH.x(aM[3],aM[4]);aG=aH.y(aM[3],aM[4]);az.scale(aM[1],aM[2],E,aG)}else{az.scale(aM[1],aM[2],aM[3],aM[4])}}}}}else{if(aB=="m"&&aA==7){az.add(aM[1],aM[2],aM[3],aM[4],aM[5],aM[6])}}}}}}}return az}T._.transform2matrix=N;T._unit2px=H;var ai=W.doc.contains||W.doc.compareDocumentPosition?function(S,E){var aA=S.nodeType==9?S.documentElement:S,az=E&&E.parentNode;return S==az||!!(az&&az.nodeType==1&&(aA.contains?aA.contains(az):S.compareDocumentPosition&&S.compareDocumentPosition(az)&16))}:function(S,E){if(E){while(E){E=E.parentNode;if(E==S){return true}}}return false};function R(az){var aA=(az.node.ownerSVGElement&&aq(az.node.ownerSVGElement))||(az.node.parentNode&&aq(az.node.parentNode))||T.select("svg")||T(0,0),S=aA.select("defs"),E=S==null?false:S.node;if(!E){E=X("defs",aA.node).node}return E}function r(E){return E.node.ownerSVGElement&&aq(E.node.ownerSVGElement)||T.select("svg")}T._.getSomeDefs=R;T._.getSomeSVG=r;function H(S,E,aD){var aA=r(S).node,az={},aE=aA.querySelector(".svg---mgr");if(!aE){aE=ak("rect");ak(aE,{x:-9000000000,y:-9000000000,width:10,height:10,"class":"svg---mgr",fill:"none"});aA.appendChild(aE)}function aF(aH){if(aH==null){return z}if(aH==+aH){return aH}ak(aE,{width:aH});try{return aE.getBBox().width}catch(aG){return 0}}function aB(aH){if(aH==null){return z}if(aH==+aH){return aH}ak(aE,{height:aH});try{return aE.getBBox().height}catch(aG){return 0}}function aC(aH,aG){if(E==null){az[aH]=aG(S.attr(aH)||0)}else{if(aH==E){az=aG(aD==null?S.attr(aH)||0:aD)}}}switch(S.type){case"rect":aC("rx",aF);aC("ry",aB);case"image":aC("width",aF);aC("height",aB);case"text":aC("x",aF);aC("y",aB);break;case"circle":aC("cx",aF);aC("cy",aB);aC("r",aF);break;case"ellipse":aC("cx",aF);aC("cy",aB);aC("rx",aF);aC("ry",aB);break;case"line":aC("x1",aF);aC("x2",aF);aC("y1",aB);aC("y2",aB);break;case"marker":aC("refX",aF);aC("markerWidth",aF);aC("refY",aB);aC("markerHeight",aB);break;case"radialGradient":aC("fx",aF);aC("fy",aB);break;case"tspan":aC("dx",aF);aC("dy",aB);break;default:aC(E,aF)}aA.removeChild(aE);return az}T.select=function(E){E=I(E).replace(/([^\\]):/g,"$1\\:");return aq(W.doc.querySelector(E))};T.selectAll=function(az){var S=W.doc.querySelectorAll(az),aA=(T.set||Array)();for(var E=0;E<S.length;E++){aA.push(aq(S[E]))}return aA};function ah(aB){if(!V(aB,"array")){aB=Array.prototype.slice.call(arguments,0)}var az=0,E=0,aA=this.node;while(this[az]){delete this[az++]}for(az=0;az<aB.length;az++){if(aB[az].type=="set"){aB[az].forEach(function(aC){aA.appendChild(aC.node)})}else{aA.appendChild(aB[az].node)}}var S=aA.childNodes;for(az=0;az<S.length;az++){this[E++]=aq(S[az])}return this}setInterval(function(){for(var E in an){if(an[l](E)){var S=an[E],az=S.node;if(S.type!="svg"&&!az.ownerSVGElement||S.type=="svg"&&(!az.parentNode||"ownerSVGElement" in az.parentNode&&!az.ownerSVGElement)){delete an[E]}}}},10000);function u(S){if(S.snap in an){return an[S.snap]}var E;try{E=S.ownerSVGElement}catch(az){}this.node=S;if(E){this.paper=new ao(E)}this.type=S.tagName||S.nodeName;var aB=this.id=Q(this);this.anims={};this._={transform:[]};S.snap=aB;an[aB]=this;if(this.type=="g"){this.add=ah}if(this.type in {g:1,mask:1,pattern:1,symbol:1}){for(var aA in ao.prototype){if(ao.prototype[l](aA)){this[aA]=ao.prototype[aA]}}}}u.prototype.attr=function(az,aE){var E=this,S=E.node;if(!az){if(S.nodeType!=1){return{text:S.nodeValue}}var aC=S.attributes,aA={};for(var aB=0,aF=aC.length;aB<aF;aB++){aA[aC[aB].nodeName]=aC[aB].nodeValue}return aA}if(V(az,"string")){if(arguments.length>1){var aG={};aG[az]=aE;az=aG}else{return b("snap.util.getattr."+az,E).firstDefined()}}for(var aD in az){if(az[l](aD)){b("snap.util.attr."+aD,E,az[aD])}}return E};T.parse=function(E){var az=W.doc.createDocumentFragment(),S=true,aA=W.doc.createElement("div");E=I(E);if(!E.match(/^\s*<\s*svg(?:\s|>)/)){E="<svg>"+E+"</svg>";S=false}aA.innerHTML=E;E=aA.getElementsByTagName("svg")[0];if(E){if(S){az=E}else{while(E.firstChild){az.appendChild(E.firstChild)}}}return new ab(az)};function ab(E){this.node=E}T.fragment=function(){var E=Array.prototype.slice.call(arguments,0),aB=W.doc.createDocumentFragment();for(var S=0,az=E.length;S<az;S++){var aA=E[S];if(aA.node&&aA.node.nodeType){aB.appendChild(aA.node)}if(aA.nodeType){aB.appendChild(aA)}if(typeof aA=="string"){aB.appendChild(T.parse(aA).node)}}return new ab(aB)};function X(E,aA){var S=ak(E);aA.appendChild(S);var az=aq(S);return az}function ao(S,aB){var aA,aE,E,aC=ao.prototype;if(S&&S.tagName=="svg"){if(S.snap in an){return an[S.snap]}var aD=S.ownerDocument;aA=new u(S);aE=S.getElementsByTagName("desc")[0];E=S.getElementsByTagName("defs")[0];if(!aE){aE=ak("desc");aE.appendChild(aD.createTextNode("Created with Snap"));aA.node.appendChild(aE)}if(!E){E=ak("defs");aA.node.appendChild(E)}aA.defs=E;for(var az in aC){if(aC[l](az)){aA[az]=aC[az]}}aA.paper=aA.root=aA}else{aA=X("svg",W.doc.body);ak(aA.node,{height:aB,version:1.1,width:S,xmlns:A})}return aA}function aq(E){if(!E){return E}if(E instanceof u||E instanceof ab){return E}if(E.tagName&&E.tagName.toLowerCase()=="svg"){return new ao(E)}if(E.tagName&&E.tagName.toLowerCase()=="object"&&E.type=="image/svg+xml"){return new ao(E.contentDocument.getElementsByTagName("svg")[0])}return new u(E)}T._.make=X;T._.wrap=aq;ao.prototype.el=function(S,E){var az=X(S,this.node);E&&az.attr(E);return az};u.prototype.children=function(){var E=[],aA=this.node.childNodes;for(var S=0,az=aA.length;S<az;S++){E[S]=T(aA[S])}return E};function h(E,aC){for(var az=0,aA=E.length;az<aA;az++){var aB={type:E[az].type,attr:E[az].attr()},S=E[az].children();aC.push(aB);if(S.length){h(S,aB.childNodes=[])}}}u.prototype.toJSON=function(){var E=[];h([this],E);return E[0]};b.on("snap.util.getattr",function(){var E=b.nt();E=E.substring(E.lastIndexOf(".")+1);var S=E.replace(/[A-Z]/g,function(az){return"-"+az.toLowerCase()});if(F[l](S)){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,null).getPropertyValue(S)}else{return ak(this.node,E)}});var F={"alignment-baseline":0,"baseline-shift":0,clip:0,"clip-path":0,"clip-rule":0,color:0,"color-interpolation":0,"color-interpolation-filters":0,"color-profile":0,"color-rendering":0,cursor:0,direction:0,display:0,"dominant-baseline":0,"enable-background":0,fill:0,"fill-opacity":0,"fill-rule":0,filter:0,"flood-color":0,"flood-opacity":0,font:0,"font-family":0,"font-size":0,"font-size-adjust":0,"font-stretch":0,"font-style":0,"font-variant":0,"font-weight":0,"glyph-orientation-horizontal":0,"glyph-orientation-vertical":0,"image-rendering":0,kerning:0,"letter-spacing":0,"lighting-color":0,marker:0,"marker-end":0,"marker-mid":0,"marker-start":0,mask:0,opacity:0,overflow:0,"pointer-events":0,"shape-rendering":0,"stop-color":0,"stop-opacity":0,stroke:0,"stroke-dasharray":0,"stroke-dashoffset":0,"stroke-linecap":0,"stroke-linejoin":0,"stroke-miterlimit":0,"stroke-opacity":0,"stroke-width":0,"text-anchor":0,"text-decoration":0,"text-rendering":0,"unicode-bidi":0,visibility:0,"word-spacing":0,"writing-mode":0};b.on("snap.util.attr",function(aB){var S=b.nt(),E={};S=S.substring(S.lastIndexOf(".")+1);E[S]=aB;var aA=S.replace(/-(\w)/gi,function(aC,aD){return aD.toUpperCase()}),az=S.replace(/[A-Z]/g,function(aC){return"-"+aC.toLowerCase()});if(F[l](az)){this.node.style[aA]=aB==null?z:aB}else{ak(this.node,E)}});(function(E){}(ao.prototype));T.ajax=function(az,E,aE,aB){var aC=new XMLHttpRequest,aD=Q();if(aC){if(V(E,"function")){aB=aE;aE=E;E=null}else{if(V(E,"object")){var S=[];for(var aA in E){if(E.hasOwnProperty(aA)){S.push(encodeURIComponent(aA)+"="+encodeURIComponent(E[aA]))}}E=S.join("&")}}aC.open((E?"POST":"GET"),az,true);if(E){aC.setRequestHeader("X-Requested-With","XMLHttpRequest");aC.setRequestHeader("Content-type","application/x-www-form-urlencoded")}if(aE){b.once("snap.ajax."+aD+".0",aE);b.once("snap.ajax."+aD+".200",aE);b.once("snap.ajax."+aD+".304",aE)}aC.onreadystatechange=function(){if(aC.readyState!=4){return}b("snap.ajax."+aD+"."+aC.status,aB,aC)};if(aC.readyState==4){return aC}aC.send(E);return aC}};T.load=function(E,az,S){T.ajax(E,function(aA){var aB=T.parse(aA.responseText);S?az.call(S,aB):az(aB)})};var B=function(az){var aB=az.getBoundingClientRect(),aF=az.ownerDocument,aC=aF.body,E=aF.documentElement,aA=E.clientTop||aC.clientTop||0,aD=E.clientLeft||aC.clientLeft||0,aE=aB.top+(g.win.pageYOffset||E.scrollTop||aC.scrollTop)-aA,S=aB.left+(g.win.pageXOffset||E.scrollLeft||aC.scrollLeft)-aD;return{y:aE,x:S}};T.getElementByPoint=function(S,aE){var aD=this,az=aD.canvas,aC=W.doc.elementFromPoint(S,aE);if(W.win.opera&&aC.tagName=="svg"){var aB=B(aC),aA=aC.createSVGRect();aA.x=S-aB.x;aA.y=aE-aB.y;aA.width=aA.height=1;var E=aC.getIntersectionList(aA,null);if(E.length){aC=E[E.length-1]}}if(!aC){return null}return aq(aC)};T.plugin=function(E){E(T,u,ao,W,ab)};W.win.Snap=T;return T}(c||this));d.plugin(function(x,r,u,v,e){var o=r.prototype,n=x.is,A=String,l=x._unit2px,k=x._.$,h=x._.make,j=x._.getSomeDefs,f="hasOwnProperty",p=x._.wrap;o.getBBox=function(F){if(!x.Matrix||!x.path){return this.node.getBBox()}var E=this,B=new x.Matrix;if(E.removed){return x._.box()}while(E.type=="use"){if(!F){B=B.add(E.transform().localMatrix.translate(E.attr("x")||0,E.attr("y")||0))}if(E.original){E=E.original}else{var C=E.attr("xlink:href");E=E.original=E.node.ownerDocument.getElementById(C.substring(C.indexOf("#")+1))}}var D=E._,H=x.path.get[E.type]||x.path.get.deflt;try{if(F){D.bboxwt=H?x.path.getBBox(E.realPath=H(E)):x._.box(E.node.getBBox());return x._.box(D.bboxwt)}else{E.realPath=H(E);E.matrix=E.transform().localMatrix;D.bbox=x.path.getBBox(x.path.map(E.realPath,B.add(E.matrix)));return x._.box(D.bbox)}}catch(G){return x._.box()}};var m=function(){return this.string};function q(E,C){if(C==null){var D=true;if(E.type=="linearGradient"||E.type=="radialGradient"){C=E.node.getAttribute("gradientTransform")}else{if(E.type=="pattern"){C=E.node.getAttribute("patternTransform")}else{C=E.node.getAttribute("transform")}}if(!C){return new x.Matrix}C=x._.svgTransform2string(C)}else{if(!x._.rgTransform.test(C)){C=x._.svgTransform2string(C)}else{C=A(C).replace(/\.{3}|\u2026/g,E._.transform||"")}if(n(C,"array")){C=x.path?x.path.toString.call(C):A(C)}E._.transform=C}var B=x._.transform2matrix(C,E.getBBox(1));if(D){return B}else{E.matrix=B}}o.transform=function(F){var J=this._;if(F==null){var H=this,C=new x.Matrix(this.node.getCTM()),I=q(this),B=[I],D=new x.Matrix,E,K=I.toTransformString(),G=A(I)==A(this.matrix)?A(J.transform):K;while(H.type!="svg"&&(H=H.parent())){B.push(q(H))}E=B.length;while(E--){D.add(B[E])}return{string:G,globalMatrix:C,totalMatrix:D,localMatrix:I,diffMatrix:C.clone().add(I.invert()),global:C.toTransformString(),total:D.toTransformString(),local:K,toString:m}}if(F instanceof x.Matrix){this.matrix=F;this._.transform=F.toTransformString()}else{q(this,F)}if(this.node){if(this.type=="linearGradient"||this.type=="radialGradient"){k(this.node,{gradientTransform:this.matrix})}else{if(this.type=="pattern"){k(this.node,{patternTransform:this.matrix})}else{k(this.node,{transform:this.matrix})}}}return this};o.parent=function(){return p(this.node.parentNode)};o.append=o.add=function(C){if(C){if(C.type=="set"){var B=this;C.forEach(function(D){B.add(D)});return this}C=p(C);this.node.appendChild(C.node);C.paper=this.paper}return this};o.appendTo=function(B){if(B){B=p(B);B.append(this)}return this};o.prepend=function(D){if(D){if(D.type=="set"){var C=this,E;D.forEach(function(F){if(E){E.after(F)}else{C.prepend(F)}E=F});return this}D=p(D);var B=D.parent();this.node.insertBefore(D.node,this.node.firstChild);this.add&&this.add();D.paper=this.paper;this.parent()&&this.parent().add();B&&B.add()}return this};o.prependTo=function(B){B=p(B);B.prepend(this);return this};o.before=function(D){if(D.type=="set"){var C=this;D.forEach(function(F){var E=F.parent();C.node.parentNode.insertBefore(F.node,C.node);E&&E.add()});this.parent().add();return this}D=p(D);var B=D.parent();this.node.parentNode.insertBefore(D.node,this.node);this.parent()&&this.parent().add();B&&B.add();D.paper=this.paper;return this};o.after=function(C){C=p(C);var B=C.parent();if(this.node.nextSibling){this.node.parentNode.insertBefore(C.node,this.node.nextSibling)}else{this.node.parentNode.appendChild(C.node)}this.parent()&&this.parent().add();B&&B.add();C.paper=this.paper;return this};o.insertBefore=function(C){C=p(C);var B=this.parent();C.node.parentNode.insertBefore(this.node,C.node);this.paper=C.paper;B&&B.add();C.parent()&&C.parent().add();return this};o.insertAfter=function(C){C=p(C);var B=this.parent();C.node.parentNode.insertBefore(this.node,C.node.nextSibling);this.paper=C.paper;B&&B.add();C.parent()&&C.parent().add();return this};o.remove=function(){var B=this.parent();this.node.parentNode&&this.node.parentNode.removeChild(this.node);delete this.paper;this.removed=true;B&&B.add();return this};o.select=function(B){return p(this.node.querySelector(B))};o.selectAll=function(D){var C=this.node.querySelectorAll(D),E=(x.set||Array)();for(var B=0;B<C.length;B++){E.push(p(C[B]))}return E};o.asPX=function(B,C){if(C==null){C=this.attr(B)}return +l(this,B,C)};o.use=function(){var B,C=this.node.id;if(!C){C=this.id;k(this.node,{id:C})}if(this.type=="linearGradient"||this.type=="radialGradient"||this.type=="pattern"){B=h(this.type,this.node.parentNode)}else{B=h("use",this.node.parentNode)}k(B.node,{"xlink:href":"#"+C});B.original=this;return B};function w(E){var H=E.selectAll("*"),J,D=/^\s*url\(("|'|)(.*)\1\)\s*$/,C=[],F={};function M(Q,P){var R=k(Q.node,P);R=R&&R.match(D);R=R&&R[2];if(R&&R.charAt()=="#"){R=R.substring(1)}else{return}if(R){F[R]=(F[R]||[]).concat(function(T){var S={};S[P]=URL(T);k(Q.node,S)})}}function N(P){var Q=k(P.node,"xlink:href");if(Q&&Q.charAt()=="#"){Q=Q.substring(1)}else{return}if(Q){F[Q]=(F[Q]||[]).concat(function(R){P.attr("xlink:href","#"+R)})}}for(var I=0,O=H.length;I<O;I++){J=H[I];M(J,"fill");M(J,"stroke");M(J,"filter");M(J,"mask");M(J,"clip-path");N(J);var B=k(J.node,"id");if(B){k(J.node,{id:J.id});C.push({old:B,id:J.id})}}for(I=0,O=C.length;I<O;I++){var L=F[C[I].old];if(L){for(var G=0,K=L.length;G<K;G++){L[G](C[I].id)}}}}o.clone=function(){var B=p(this.node.cloneNode(true));if(k(B.node,"id")){k(B.node,{id:B.id})}w(B);B.insertAfter(this);return B};o.toDefs=function(){var B=j(this);B.appendChild(this.node);return this};o.pattern=o.toPattern=function(C,F,D,B){var E=h("pattern",j(this));if(C==null){C=this.getBBox()}if(n(C,"object")&&"x" in C){F=C.y;D=C.width;B=C.height;C=C.x}k(E.node,{x:C,y:F,width:D,height:B,patternUnits:"userSpaceOnUse",id:E.id,viewBox:[C,F,D,B].join(" ")});E.node.appendChild(this.node);return E};o.marker=function(C,H,D,B,F,E){var G=h("marker",j(this));if(C==null){C=this.getBBox()}if(n(C,"object")&&"x" in C){H=C.y;D=C.width;B=C.height;F=C.refX||C.cx;E=C.refY||C.cy;C=C.x}k(G.node,{viewBox:[C,H,D,B].join(" "),markerWidth:D,markerHeight:B,orient:"auto",refX:F||0,refY:E||0,id:G.id});G.node.appendChild(this.node);return G};function s(D,C,B){return function(E){var F=E.slice(D,C);if(F.length==1){F=F[0]}return B?B(F):F}}var y=function(B,C,E,D){if(typeof E=="function"&&!E.length){D=E;E=a.linear}this.attr=B;this.dur=C;E&&(this.easing=E);D&&(this.callback=D)};x._.Animation=y;x.animation=function(B,C,E,D){return new y(B,C,E,D)};o.inAnim=function(){var C=this,B=[];for(var D in C.anims){if(C.anims[f](D)){(function(E){B.push({anim:new y(E._attrs,E.dur,E.easing,E._callback),mina:E,curStatus:E.status(),status:function(F){return E.status(F)},stop:function(){E.stop()}})}(C.anims[D]))}}return B};x.animate=function(I,H,G,C,F,E){if(typeof F=="function"&&!F.length){E=F;F=a.linear}var B=a.time(),D=a(I,H,B,B+C,a.time,G,F);E&&b.once("mina.finish."+D.id,E);return D};o.stop=function(){var B=this.inAnim();for(var C=0,D=B.length;C<D;C++){B[C].stop()}return this};o.animate=function(N,B,I,O){if(typeof I=="function"&&!I.length){O=I;I=a.linear}if(N instanceof y){O=N.callback;I=N.easing;B=N.dur;N=N.attr}var C=[],M=[],Q={},K,J,H,P,E=this;for(var L in N){if(N[f](L)){if(E.equal){P=E.equal(L,A(N[L]));K=P.from;J=P.to;H=P.f}else{K=+E.attr(L);J=+N[L]}var G=n(K,"array")?K.length:1;Q[L]=s(C.length,C.length+G,H);C=C.concat(K);M=M.concat(J)}}var D=a.time(),F=a(C,M,D,D+B,a.time,function(T){var R={};for(var S in Q){if(Q[f](S)){R[S]=Q[S](T)}}E.attr(R)},I);E.anims[F.id]=F;F._attrs=N;F._callback=O;b("snap.animcreated."+E.id,F);b.once("mina.finish."+F.id,function(){delete E.anims[F.id];O&&O.call(E)});b.once("mina.stop."+F.id,function(){delete E.anims[F.id]});return E};var z={};o.data=function(C,E){var D=z[this.id]=z[this.id]||{};if(arguments.length==0){b("snap.data.get."+this.id,this,D,null);return D}if(arguments.length==1){if(x.is(C,"object")){for(var B in C){if(C[f](B)){this.data(B,C[B])}}return this}b("snap.data.get."+this.id,this,D[C],C);return D[C]}D[C]=E;b("snap.data.set."+this.id,this,E,C);return this};o.removeData=function(B){if(B==null){z[this.id]={}}else{z[this.id]&&delete z[this.id][B]}return this};o.outerSVG=o.toString=t(1);o.innerSVG=t();function t(B){return function(){var E=B?"<"+this.type:"",C=this.node.attributes,G=this.node.childNodes;if(B){for(var D=0,F=C.length;D<F;D++){E+=" "+C[D].name+'="'+C[D].value.replace(/"/g,'\\"')+'"'}}if(G.length){B&&(E+=">");for(D=0,F=G.length;D<F;D++){if(G[D].nodeType==3){E+=G[D].nodeValue}else{if(G[D].nodeType==1){E+=p(G[D]).toString()}}}B&&(E+="</"+this.type+">")}else{B&&(E+="/>")}return E}}o.toDataURL=function(){if(c&&c.btoa){var C=this.getBBox(),B=x.format('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="{width}" height="{height}" viewBox="{x} {y} {width} {height}">{contents}</svg>',{x:+C.x.toFixed(3),y:+C.y.toFixed(3),width:+C.width.toFixed(3),height:+C.height.toFixed(3),contents:this.outerSVG()});return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(B)))}};e.prototype.select=o.select;e.prototype.selectAll=o.selectAll});d.plugin(function(k,f,p,l,h){var j=Object.prototype.toString,m=String,n=Math,o="";function e(r,q,v,u,t,s){if(q==null&&j.call(r)=="[object SVGMatrix]"){this.a=r.a;this.b=r.b;this.c=r.c;this.d=r.d;this.e=r.e;this.f=r.f;return}if(r!=null){this.a=+r;this.b=+q;this.c=+v;this.d=+u;this.e=+t;this.f=+s}else{this.a=1;this.b=0;this.c=0;this.d=1;this.e=0;this.f=0}}(function(s){s.add=function(I,F,D,B,w,v){var u=[[],[],[]],t=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],H=[[I,D,w],[F,B,v],[0,0,1]],G,E,C,A;if(I&&I instanceof e){H=[[I.a,I.c,I.e],[I.b,I.d,I.f],[0,0,1]]}for(G=0;G<3;G++){for(E=0;E<3;E++){A=0;for(C=0;C<3;C++){A+=t[G][C]*H[C][E]}u[G][E]=A}}this.a=u[0][0];this.b=u[1][0];this.c=u[0][1];this.d=u[1][1];this.e=u[0][2];this.f=u[1][2];return this};s.invert=function(){var u=this,t=u.a*u.d-u.b*u.c;return new e(u.d/t,-u.b/t,-u.c/t,u.a/t,(u.c*u.f-u.d*u.e)/t,(u.b*u.e-u.a*u.f)/t)};s.clone=function(){return new e(this.a,this.b,this.c,this.d,this.e,this.f)};s.translate=function(t,u){return this.add(1,0,0,1,t,u)};s.scale=function(u,w,t,v){w==null&&(w=u);(t||v)&&this.add(1,0,0,1,t,v);this.add(u,0,0,w,0,0);(t||v)&&this.add(1,0,0,1,-t,-v);return this};s.rotate=function(u,t,z){u=k.rad(u);t=t||0;z=z||0;var w=+n.cos(u).toFixed(9),v=+n.sin(u).toFixed(9);this.add(w,v,-v,w,t,z);return this.add(1,0,0,1,-t,-z)};s.x=function(t,u){return t*this.a+u*this.c+this.e};s.y=function(t,u){return t*this.b+u*this.d+this.f};s.get=function(t){return +this[m.fromCharCode(97+t)].toFixed(4)};s.toString=function(){return"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")"};s.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]};function r(t){return t[0]*t[0]+t[1]*t[1]}function q(t){var u=n.sqrt(r(t));t[0]&&(t[0]/=u);t[1]&&(t[1]/=u)}s.determinant=function(){return this.a*this.d-this.b*this.c};s.split=function(){var u={};u.dx=this.e;u.dy=this.f;var w=[[this.a,this.c],[this.b,this.d]];u.scalex=n.sqrt(r(w[0]));q(w[0]);u.shear=w[0][0]*w[1][0]+w[0][1]*w[1][1];w[1]=[w[1][0]-w[0][0]*u.shear,w[1][1]-w[0][1]*u.shear];u.scaley=n.sqrt(r(w[1]));q(w[1]);u.shear/=u.scaley;if(this.determinant()<0){u.scalex=-u.scalex}var t=-w[0][1],v=w[1][1];if(v<0){u.rotate=k.deg(n.acos(v));if(t<0){u.rotate=360-u.rotate}}else{u.rotate=k.deg(n.asin(t))}u.isSimple=!+u.shear.toFixed(9)&&(u.scalex.toFixed(9)==u.scaley.toFixed(9)||!u.rotate);u.isSuperSimple=!+u.shear.toFixed(9)&&u.scalex.toFixed(9)==u.scaley.toFixed(9)&&!u.rotate;u.noRotation=!+u.shear.toFixed(9)&&!u.rotate;return u};s.toTransformString=function(t){var u=t||this.split();if(!+u.shear.toFixed(9)){u.scalex=+u.scalex.toFixed(4);u.scaley=+u.scaley.toFixed(4);u.rotate=+u.rotate.toFixed(4);return(u.dx||u.dy?"t"+[+u.dx.toFixed(4),+u.dy.toFixed(4)]:o)+(u.scalex!=1||u.scaley!=1?"s"+[u.scalex,u.scaley,0,0]:o)+(u.rotate?"r"+[+u.rotate.toFixed(4),0,0]:o)}else{return"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}})(e.prototype);k.Matrix=e;k.matrix=function(r,q,v,u,t,s){return new e(r,q,v,u,t,s)}});d.plugin(function(x,u,v,w,e){var h="hasOwnProperty",j=x._.make,s=x._.wrap,o=x.is,l=x._.getSomeDefs,A=/^url\(#?([^)]+)\)$/,m=x._.$,q=x.url,z=String,k=x._.separator,t="";b.on("snap.util.attr.mask",function(D){if(D instanceof u||D instanceof e){b.stop();if(D instanceof e&&D.node.childNodes.length==1){D=D.node.firstChild;l(this).appendChild(D);D=s(D)}if(D.type=="mask"){var C=D}else{C=j("mask",l(this));C.node.appendChild(D.node)}!C.node.id&&m(C.node,{id:C.id});m(this.node,{mask:q(C.id)})}});(function(C){b.on("snap.util.attr.clip",C);b.on("snap.util.attr.clip-path",C);b.on("snap.util.attr.clipPath",C)}(function(D){if(D instanceof u||D instanceof e){b.stop();if(D.type=="clipPath"){var C=D}else{C=j("clipPath",l(this));C.node.appendChild(D.node);!C.node.id&&m(C.node,{id:C.id})}m(this.node,{"clip-path":q(C.node.id||C.id)})}}));function B(C){return function(E){b.stop();if(E instanceof e&&E.node.childNodes.length==1&&(E.node.firstChild.tagName=="radialGradient"||E.node.firstChild.tagName=="linearGradient"||E.node.firstChild.tagName=="pattern")){E=E.node.firstChild;l(this).appendChild(E);E=s(E)}if(E instanceof u){if(E.type=="radialGradient"||E.type=="linearGradient"||E.type=="pattern"){if(!E.node.id){m(E.node,{id:E.id})}var F=q(E.node.id)}else{F=E.attr(C)}}else{F=x.color(E);if(F.error){var G=x(l(this).ownerSVGElement).gradient(E);if(G){if(!G.node.id){m(G.node,{id:G.id})}F=q(G.node.id)}else{F=E}}else{F=z(F)}}var D={};D[C]=F;m(this.node,D);this.node.style[C]=t}}b.on("snap.util.attr.fill",B("fill"));b.on("snap.util.attr.stroke",B("stroke"));var p=/^([lr])(?:\(([^)]*)\))?(.*)$/i;b.on("snap.util.grad.parse",function r(C){C=z(C);var F=C.match(p);if(!F){return null}var D=F[1],G=F[2],E=F[3];G=G.split(/\s*,\s*/).map(function(H){return +H==H?+H:H});if(G.length==1&&G[0]==0){G=[]}E=E.split("-");E=E.map(function(I){I=I.split(":");var H={color:I[0]};if(I[1]){H.offset=parseFloat(I[1])}return H});return{type:D,params:G,stops:E}});b.on("snap.util.attr.d",function(C){b.stop();if(o(C,"array")&&o(C[0],"array")){C=x.path.toString.call(C)}C=z(C);if(C.match(/[ruo]/i)){C=x.path.toAbsolute(C)}m(this.node,{d:C})})(-1);b.on("snap.util.attr.#text",function(D){b.stop();D=z(D);var C=w.doc.createTextNode(D);while(this.node.firstChild){this.node.removeChild(this.node.firstChild)}this.node.appendChild(C)})(-1);b.on("snap.util.attr.path",function(C){b.stop();this.attr({d:C})})(-1);b.on("snap.util.attr.class",function(C){b.stop();this.node.className.baseVal=C})(-1);b.on("snap.util.attr.viewBox",function(D){var C;if(o(D,"object")&&"x" in D){C=[D.x,D.y,D.width,D.height].join(" ")}else{if(o(D,"array")){C=D.join(" ")}else{C=D}}m(this.node,{viewBox:C});b.stop()})(-1);b.on("snap.util.attr.transform",function(C){this.transform(C);b.stop()})(-1);b.on("snap.util.attr.r",function(C){if(this.type=="rect"){b.stop();m(this.node,{rx:C,ry:C})}})(-1);b.on("snap.util.attr.textpath",function(E){b.stop();if(this.type=="text"){var H,G,D;if(!E&&this.textPath){G=this.textPath;while(G.node.firstChild){this.node.appendChild(G.node.firstChild)}G.remove();delete this.textPath;return}if(o(E,"string")){var C=l(this),F=s(C.parentNode).path(E);C.appendChild(F.node);H=F.id;F.attr({id:H})}else{E=s(E);if(E instanceof u){H=E.attr("id");if(!H){H=E.id;E.attr({id:H})}}}if(H){G=this.textPath;D=this.node;if(G){G.attr({"xlink:href":"#"+H})}else{G=m("textPath",{"xlink:href":"#"+H});while(D.firstChild){G.appendChild(D.firstChild)}D.appendChild(G);this.textPath=s(G)}}}})(-1);b.on("snap.util.attr.text",function(G){if(this.type=="text"){var D=0,F=this.node,C=function(I){var H=m("tspan");if(o(I,"array")){for(var J=0;J<I.length;J++){H.appendChild(C(I[J]))}}else{H.appendChild(w.doc.createTextNode(I))}H.normalize&&H.normalize();return H};while(F.firstChild){F.removeChild(F.firstChild)}var E=C(G);while(E.firstChild){F.appendChild(E.firstChild)}}b.stop()})(-1);function n(C){b.stop();if(C==+C){C+="px"}this.node.style.fontSize=C}b.on("snap.util.attr.fontSize",n)(-1);b.on("snap.util.attr.font-size",n)(-1);b.on("snap.util.getattr.transform",function(){b.stop();return this.transform()})(-1);b.on("snap.util.getattr.textpath",function(){b.stop();return this.textPath})(-1);(function(){function C(E){return function(){b.stop();var F=w.doc.defaultView.getComputedStyle(this.node,null).getPropertyValue("marker-"+E);if(F=="none"){return F}else{return x(w.doc.getElementById(F.match(A)[1]))}}}function D(E){return function(G){b.stop();var F="marker"+E.charAt(0).toUpperCase()+E.substring(1);if(G==""||!G){this.node.style[F]="none";return}if(G.type=="marker"){var H=G.node.id;if(!H){m(G.node,{id:G.id})}this.node.style[F]=q(H);return}}}b.on("snap.util.getattr.marker-end",C("end"))(-1);b.on("snap.util.getattr.markerEnd",C("end"))(-1);b.on("snap.util.getattr.marker-start",C("start"))(-1);b.on("snap.util.getattr.markerStart",C("start"))(-1);b.on("snap.util.getattr.marker-mid",C("mid"))(-1);b.on("snap.util.getattr.markerMid",C("mid"))(-1);b.on("snap.util.attr.marker-end",D("end"))(-1);b.on("snap.util.attr.markerEnd",D("end"))(-1);b.on("snap.util.attr.marker-start",D("start"))(-1);b.on("snap.util.attr.markerStart",D("start"))(-1);b.on("snap.util.attr.marker-mid",D("mid"))(-1);b.on("snap.util.attr.markerMid",D("mid"))(-1)}());b.on("snap.util.getattr.r",function(){if(this.type=="rect"&&m(this.node,"rx")==m(this.node,"ry")){b.stop();return m(this.node,"rx")}})(-1);function y(H){var D=[];var F=H.childNodes;for(var E=0,G=F.length;E<G;E++){var C=F[E];if(C.nodeType==3){D.push(C.nodeValue)}if(C.tagName=="tspan"){if(C.childNodes.length==1&&C.firstChild.nodeType==3){D.push(C.firstChild.nodeValue)}else{D.push(y(C))}}}return D}b.on("snap.util.getattr.text",function(){if(this.type=="text"||this.type=="tspan"){b.stop();var C=y(this.node);return C.length==1?C[0]:C}})(-1);b.on("snap.util.getattr.#text",function(){return this.node.textContent})(-1);b.on("snap.util.getattr.viewBox",function(){b.stop();var C=m(this.node,"viewBox");if(C){C=C.split(k);return x._.box(+C[0],+C[1],+C[2],+C[3])}else{return}})(-1);b.on("snap.util.getattr.points",function(){var C=m(this.node,"points");b.stop();if(C){return C.split(k)}else{return}})(-1);b.on("snap.util.getattr.path",function(){var C=m(this.node,"d");b.stop();return C})(-1);b.on("snap.util.getattr.class",function(){return this.node.className.baseVal})(-1);function f(){b.stop();return this.node.style.fontSize}b.on("snap.util.getattr.fontSize",f)(-1);b.on("snap.util.getattr.font-size",f)(-1)});d.plugin(function(l,e,p,n,f){var o=/\S+/g,j=/[\t\r\n\f]/g,k=/(^\s+|\s+$)/g,m=String,h=e.prototype;h.addClass=function(x){var s=m(x||"").match(o)||[],r=this.node,v=r.className.baseVal,y=v.match(o)||[],t,w,u,q;if(s.length){t=0;while((u=s[t++])){w=y.indexOf(u);if(!~w){y.push(u)}}q=y.join(" ");if(v!=q){r.className.baseVal=q}}return this};h.removeClass=function(x){var s=m(x||"").match(o)||[],r=this.node,v=r.className.baseVal,y=v.match(o)||[],t,w,u,q;if(y.length){t=0;while((u=s[t++])){w=y.indexOf(u);if(~w){y.splice(w,1)}}q=y.join(" ");if(v!=q){r.className.baseVal=q}}return this};h.hasClass=function(t){var s=this.node,r=s.className.baseVal,q=r.match(o)||[];return !!~q.indexOf(t)};h.toggleClass=function(y,w){if(w!=null){if(w){return this.addClass(y)}else{return this.removeClass(y)}}var s=(y||"").match(o)||[],r=this.node,v=r.className.baseVal,z=v.match(o)||[],t,x,u,q;t=0;while((u=s[t++])){x=z.indexOf(u);if(~x){z.splice(x,1)}else{z.push(u)}}q=z.join(" ");if(v!=q){r.className.baseVal=q}return this}});d.plugin(function(l,e,q,m,f){var j={"+":function(r,s){return r+s},"-":function(r,s){return r-s},"/":function(r,s){return r/s},"*":function(r,s){return r*s}},n=String,h=/[a-z]+$/i,k=/^\s*([+\-\/*])\s*=\s*([\d.eE+\-]+)\s*([^\d\s]+)?\s*$/;function p(r){return r}function o(r){return function(s){return +s.toFixed(3)+r}}b.on("snap.util.attr",function(s){var u=n(s).match(k);if(u){var z=b.nt(),r=z.substring(z.lastIndexOf(".")+1),x=this.attr(r),w={};b.stop();var y=u[3]||"",v=x.match(h),t=j[u[1]];if(v&&v==y){s=t(parseFloat(x),+u[2])}else{x=this.asPX(r);s=t(this.asPX(r),this.asPX(r,u[2]+y))}if(isNaN(x)||isNaN(s)){return}w[r]=s;this.attr(w)}})(-10);b.on("snap.util.equal",function(s,y){var v,t,z=n(this.attr(s)||""),u=this,r=n(y).match(k);if(r){b.stop();var C=r[3]||"",x=z.match(h),w=j[r[1]];if(x&&x==C){return{from:parseFloat(z),to:w(parseFloat(z),+r[2]),f:o(x)}}else{z=this.asPX(s);return{from:z,to:w(z,this.asPX(s,r[2]+C)),f:p}}}})(-10)});d.plugin(function(m,e,j,n,h){var l=j.prototype,k=m.is;l.rect=function(p,u,q,r,t,s){var o;if(s==null){s=t}if(k(p,"object")&&p=="[object Object]"){o=p}else{if(p!=null){o={x:p,y:u,width:q,height:r};if(t!=null){o.rx=t;o.ry=s}}}return this.el("rect",o)};l.circle=function(p,s,q){var o;if(k(p,"object")&&p=="[object Object]"){o=p}else{if(p!=null){o={cx:p,cy:s,r:q}}}return this.el("circle",o)};var f=(function(){function o(){this.parentNode.removeChild(this)}return function(s,r){var q=n.doc.createElement("img"),p=n.doc.body;q.style.cssText="position:absolute;left:-9999em;top:-9999em";q.onload=function(){r.call(q);q.onload=q.onerror=null;p.removeChild(q)};q.onerror=o;p.appendChild(q);q.src=s}}());l.image=function(s,p,u,r,o){var q=this.el("image");if(k(s,"object")&&"src" in s){q.attr(s)}else{if(s!=null){var t={"xlink:href":s,preserveAspectRatio:"none"};if(p!=null&&u!=null){t.x=p;t.y=u}if(r!=null&&o!=null){t.width=r;t.height=o}else{f(s,function(){m._.$(q.node,{width:this.offsetWidth,height:this.offsetHeight})})}m._.$(q.node,t)}}return q};l.ellipse=function(p,s,r,q){var o;if(k(p,"object")&&p=="[object Object]"){o=p}else{if(p!=null){o={cx:p,cy:s,rx:r,ry:q}}}return this.el("ellipse",o)};l.path=function(p){var o;if(k(p,"object")&&!k(p,"array")){o=p}else{if(p){o={d:p}}}return this.el("path",o)};l.group=l.g=function(q){var o,p=this.el("g");if(arguments.length==1&&q&&!q.type){p.attr(q)}else{if(arguments.length){p.add(Array.prototype.slice.call(arguments,0))}}return p};l.svg=function(u,t,p,w,r,q,s,o){var v={};if(k(u,"object")&&t==null){v=u}else{if(u!=null){v.x=u}if(t!=null){v.y=t}if(p!=null){v.width=p}if(w!=null){v.height=w}if(r!=null&&q!=null&&s!=null&&o!=null){v.viewBox=[r,q,s,o]}}return this.el("svg",v)};l.mask=function(q){var o,p=this.el("mask");if(arguments.length==1&&q&&!q.type){p.attr(q)}else{if(arguments.length){p.add(Array.prototype.slice.call(arguments,0))}}return p};l.ptrn=function(v,s,o,w,t,r,u,p){if(k(v,"object")){var q=v}else{q={patternUnits:"userSpaceOnUse"};if(v){q.x=v}if(s){q.y=s}if(o!=null){q.width=o}if(w!=null){q.height=w}if(t!=null&&r!=null&&u!=null&&p!=null){q.viewBox=[t,r,u,p]}else{q.viewBox=[v||0,s||0,o||0,w||0]}}return this.el("pattern",q)};l.use=function(o){if(o!=null){if(o instanceof e){if(!o.attr("id")){o.attr({id:m._.id(o)})}o=o.attr("id")}if(String(o).charAt()=="#"){o=o.substring(1)}return this.el("use",{"xlink:href":"#"+o})}else{return e.prototype.use.call(this)}};l.symbol=function(q,p,r,s){var o={};if(q!=null&&p!=null&&r!=null&&s!=null){o.viewBox=[q,p,r,s]}return this.el("symbol",o)};l.text=function(p,r,q){var o={};if(k(p,"object")){o=p}else{if(p!=null){o={x:p,y:r,text:q||""}}}return this.el("text",o)};l.line=function(q,s,p,r){var o={};if(k(q,"object")){o=q}else{if(q!=null){o={x1:q,x2:p,y1:s,y2:r}}}return this.el("line",o)};l.polyline=function(p){if(arguments.length>1){p=Array.prototype.slice.call(arguments,0)}var o={};if(k(p,"object")&&!k(p,"array")){o=p}else{if(p!=null){o={points:p}}}return this.el("polyline",o)};l.polygon=function(p){if(arguments.length>1){p=Array.prototype.slice.call(arguments,0)}var o={};if(k(p,"object")&&!k(p,"array")){o=p}else{if(p!=null){o={points:p}}}return this.el("polygon",o)};(function(){var t=m._.$;function o(){return this.selectAll("stop")}function q(w,y){var x=t("stop"),v={offset:+y+"%"};w=m.color(w);v["stop-color"]=w.hex;if(w.opacity<1){v["stop-opacity"]=w.opacity}t(x,v);this.node.appendChild(x);return this}function s(){if(this.type=="linearGradient"){var x=t(this.node,"x1")||0,w=t(this.node,"x2")||1,z=t(this.node,"y1")||0,y=t(this.node,"y2")||0;return m._.box(x,z,math.abs(w-x),math.abs(y-z))}else{var v=this.node.cx||0.5,B=this.node.cy||0.5,A=this.node.r||0;return m._.box(v-A,B-A,A*2,A*2)}}function u(y,C){var E=b("snap.util.grad.parse",null,C).firstDefined(),w;if(!E){return null}E.params.unshift(y);if(E.type.toLowerCase()=="l"){w=p.apply(0,E.params)}else{w=r.apply(0,E.params)}if(E.type!=E.type.toLowerCase()){t(w.node,{gradientUnits:"userSpaceOnUse"})}var F=E.stops,B=F.length,v=0,x=0;function A(I,G){var J=(G-v)/(I-x);for(var H=x;H<I;H++){F[H].offset=+(+v+J*(H-x)).toFixed(2)}x=I;v=G}B--;for(var z=0;z<B;z++){if("offset" in F[z]){A(z,F[z].offset)}}F[B].offset=F[B].offset||100;A(B,F[B].offset);for(z=0;z<=B;z++){var D=F[z];w.addStop(D.color,D.offset)}return w}function p(v,x,A,w,y){var z=m._.make("linearGradient",v);z.stops=o;z.addStop=q;z.getBBox=s;if(x!=null){t(z.node,{x1:x,y1:A,x2:w,y2:y})}return z}function r(w,v,B,A,z,y){var x=m._.make("radialGradient",w);x.stops=o;x.addStop=q;x.getBBox=s;if(v!=null){t(x.node,{cx:v,cy:B,r:A})}if(z!=null&&y!=null){t(x.node,{fx:z,fy:y})}return x}l.gradient=function(v){return u(this.defs,v)};l.gradientLinear=function(w,y,v,x){return p(this.defs,w,y,v,x)};l.gradientRadial=function(v,z,y,x,w){return r(this.defs,v,z,y,x,w)};l.toString=function(){var y=this.node.ownerDocument,x=y.createDocumentFragment(),z=y.createElement("div"),v=this.node.cloneNode(true),w;x.appendChild(z);z.appendChild(v);m._.$(v,{xmlns:"http://www.w3.org/2000/svg"});w=z.innerHTML;x.removeChild(x.firstChild);return w};l.toDataURL=function(){if(c&&c.btoa){return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(this)))}};l.clear=function(){var w=this.node.firstChild,v;while(w){v=w.nextSibling;if(w.tagName!="defs"){w.parentNode.removeChild(w)}else{l.clear.call({node:w})}w=v}}}())});d.plugin(function(L,t,ad,O){var v=t.prototype,P=L.is,I=L._.clone,k="hasOwnProperty",M=/,?([a-z]),?/gi,f=parseFloat,T=Math,m=T.PI,Z=T.min,s=T.max,S=T.pow,U=T.abs;function V(ak){var aj=V.ps=V.ps||{};if(aj[ak]){aj[ak].sleep=100}else{aj[ak]={sleep:100}}setTimeout(function(){for(var al in aj){if(aj[k](al)&&al!=ak){aj[al].sleep--;!aj[al].sleep&&delete aj[al]}}});return aj[ak]}function p(ak,am,al,aj){if(ak==null){ak=am=al=aj=0}if(am==null){am=ak.y;al=ak.width;aj=ak.height;ak=ak.x}return{x:ak,y:am,width:al,w:al,height:aj,h:aj,x2:ak+al,y2:am+aj,cx:ak+al/2,cy:am+aj/2,r1:T.min(al,aj)/2,r2:T.max(al,aj)/2,r0:T.sqrt(al*al+aj*aj)/2,path:q(ak,am,al,aj),vb:[ak,am,al,aj].join(" ")}}function l(){return this.join(",").replace(M,"$1")}function J(ak){var aj=I(ak);aj.toString=l;return aj}function ag(ak,aj,an,am,ar,aq,ap,ao,al){if(al==null){return E(ak,aj,an,am,ar,aq,ap,ao)}else{return C(ak,aj,an,am,ar,aq,ap,ao,ab(ak,aj,an,am,ar,aq,ap,ao,al))}}function K(aj,ak){function al(am){return +(+am).toFixed(3)}return L._.cacher(function(az,ao,ap){if(az instanceof t){az=az.attr("d")}az=af(az);var av,au,am,aq,an="",ay={},aw,at=0;for(var ar=0,ax=az.length;ar<ax;ar++){am=az[ar];if(am[0]=="M"){av=+am[1];au=+am[2]}else{aq=ag(av,au,am[1],am[2],am[3],am[4],am[5],am[6]);if(at+aq>ao){if(ak&&!ay.start){aw=ag(av,au,am[1],am[2],am[3],am[4],am[5],am[6],ao-at);an+=["C"+al(aw.start.x),al(aw.start.y),al(aw.m.x),al(aw.m.y),al(aw.x),al(aw.y)];if(ap){return an}ay.start=an;an=["M"+al(aw.x),al(aw.y)+"C"+al(aw.n.x),al(aw.n.y),al(aw.end.x),al(aw.end.y),al(am[5]),al(am[6])].join();at+=aq;av=+am[5];au=+am[6];continue}if(!aj&&!ak){aw=ag(av,au,am[1],am[2],am[3],am[4],am[5],am[6],ao-at);return aw}}at+=aq;av=+am[5];au=+am[6]}an+=am.shift()+am}ay.end=an;aw=aj?at:ak?ay:C(av,au,am[0],am[1],am[2],am[3],am[4],am[5],1);return aw},null,L._.clone)}var y=K(1),Y=K(),o=K(0,1);function C(ak,aj,aK,aI,ap,an,at,aq,aD){var aA=1-aD,aF=S(aA,3),aG=S(aA,2),av=aD*aD,ar=av*aD,az=aF*ak+aG*3*aD*aK+aA*3*aD*aD*ap+ar*at,au=aF*aj+aG*3*aD*aI+aA*3*aD*aD*an+ar*aq,aE=ak+2*aD*(aK-ak)+av*(ap-2*aK+ak),aC=aj+2*aD*(aI-aj)+av*(an-2*aI+aj),aJ=aK+2*aD*(ap-aK)+av*(at-2*ap+aK),aH=aI+2*aD*(an-aI)+av*(aq-2*an+aI),aB=aA*ak+aD*aK,aw=aA*aj+aD*aI,am=aA*ap+aD*at,al=aA*an+aD*aq,ao=(90-T.atan2(aE-aJ,aC-aH)*180/m);return{x:az,y:au,m:{x:aE,y:aC},n:{x:aJ,y:aH},start:{x:aB,y:aw},end:{x:am,y:al},alpha:ao}}function j(ak,aj,am,al,ar,ap,ao,an){if(!L.is(ak,"array")){ak=[ak,aj,am,al,ar,ap,ao,an]}var aq=ac.apply(null,ak);return p(aq.min.x,aq.min.y,aq.max.x-aq.min.x,aq.max.y-aq.min.y)}function ah(ak,aj,al){return aj>=ak.x&&aj<=ak.x+ak.width&&al>=ak.y&&al<=ak.y+ak.height}function u(ak,aj){ak=p(ak);aj=p(aj);return ah(aj,ak.x,ak.y)||ah(aj,ak.x2,ak.y)||ah(aj,ak.x,ak.y2)||ah(aj,ak.x2,ak.y2)||ah(ak,aj.x,aj.y)||ah(ak,aj.x2,aj.y)||ah(ak,aj.x,aj.y2)||ah(ak,aj.x2,aj.y2)||(ak.x<aj.x2&&ak.x>aj.x||aj.x<ak.x2&&aj.x>ak.x)&&(ak.y<aj.y2&&ak.y>aj.y||aj.y<ak.y2&&aj.y>ak.y)}function r(aj,ap,ao,an,am){var al=-3*ap+9*ao-9*an+3*am,ak=aj*al+6*ap-12*ao+6*an;return aj*ak-3*ap+3*ao}function E(aB,an,aA,al,az,ak,aw,aj,at){if(at==null){at=1}at=at>1?1:at<0?0:at;var au=at/2,av=12,ap=[-0.1252,0.1252,-0.3678,0.3678,-0.5873,0.5873,-0.7699,0.7699,-0.9041,0.9041,-0.9816,0.9816],ay=[0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],am=0;for(var ax=0;ax<av;ax++){var aq=au*ap[ax]+au,ar=r(aq,aB,aA,az,aw),aC=r(aq,an,al,ak,aj),ao=ar*ar+aC*aC;am+=ay[ax]*T.sqrt(ao)}return au*am}function ab(al,av,ak,au,aj,ar,ax,aq,at){if(at<0||E(al,av,ak,au,aj,ar,ax,aq)<at){return}var aw=1,am=aw/2,ao=aw-am,an,ap=0.01;an=E(al,av,ak,au,aj,ar,ax,aq,ao);while(U(an-at)>ap){am/=2;ao+=(an<at?1:-1)*am;an=E(al,av,ak,au,aj,ar,ax,aq,ao)}return ao}function R(am,aw,al,au,aj,at,ay,ar){if(s(am,al)<Z(aj,ay)||Z(am,al)>s(aj,ay)||s(aw,au)<Z(at,ar)||Z(aw,au)>s(at,ar)){return}var aq=(am*au-aw*al)*(aj-ay)-(am-al)*(aj*ar-at*ay),ap=(am*au-aw*al)*(at-ar)-(aw-au)*(aj*ar-at*ay),an=(am-al)*(at-ar)-(aw-au)*(aj-ay);if(!an){return}var ax=aq/an,av=ap/an,ao=+ax.toFixed(2),ak=+av.toFixed(2);if(ao<+Z(am,al).toFixed(2)||ao>+s(am,al).toFixed(2)||ao<+Z(aj,ay).toFixed(2)||ao>+s(aj,ay).toFixed(2)||ak<+Z(aw,au).toFixed(2)||ak>+s(aw,au).toFixed(2)||ak<+Z(at,ar).toFixed(2)||ak>+s(at,ar).toFixed(2)){return}return{x:ax,y:av}}function ae(ak,aj){return e(ak,aj)}function H(ak,aj){return e(ak,aj,1)}function e(aH,aG,aF){var am=j(aH),ak=j(aG);if(!u(am,ak)){return aF?0:[]}var aA=E.apply(0,aH),az=E.apply(0,aG),aq=~~(aA/8),ap=~~(az/8),ax=[],aw=[],al={},aI=aF?0:[];for(var aC=0;aC<aq+1;aC++){var ay=C.apply(0,aH.concat(aC/aq));ax.push({x:ay.x,y:ay.y,t:aC/aq})}for(aC=0;aC<ap+1;aC++){ay=C.apply(0,aG.concat(aC/ap));aw.push({x:ay.x,y:ay.y,t:aC/ap})}for(aC=0;aC<aq;aC++){for(var aB=0;aB<ap;aB++){var aE=ax[aC],aj=ax[aC+1],aD=aw[aB],ao=aw[aB+1],av=U(aj.x-aE.x)<0.001?"y":"x",au=U(ao.x-aD.x)<0.001?"y":"x",an=R(aE.x,aE.y,aj.x,aj.y,aD.x,aD.y,ao.x,ao.y);if(an){if(al[an.x.toFixed(4)]==an.y.toFixed(4)){continue}al[an.x.toFixed(4)]=an.y.toFixed(4);var at=aE.t+U((an[av]-aE[av])/(aj[av]-aE[av]))*(aj.t-aE.t),ar=aD.t+U((an[au]-aD[au])/(ao[au]-aD[au]))*(ao.t-aD.t);if(at>=0&&at<=1&&ar>=0&&ar<=1){if(aF){aI++}else{aI.push({x:an.x,y:an.y,t1:at,t2:ar})}}}}}return aI}function x(ak,aj){return ai(ak,aj)}function B(ak,aj){return ai(ak,aj,1)}function ai(al,aj,aB){al=af(al);aj=af(aj);var az,ao,ay,am,aw,ap,ak,at,aF,aE,aG=aB?0:[];for(var ax=0,aq=al.length;ax<aq;ax++){var aD=al[ax];if(aD[0]=="M"){az=aw=aD[1];ao=ap=aD[2]}else{if(aD[0]=="C"){aF=[az,ao].concat(aD.slice(1));az=aF[6];ao=aF[7]}else{aF=[az,ao,az,ao,aw,ap,aw,ap];az=aw;ao=ap}for(var av=0,aA=aj.length;av<aA;av++){var aC=aj[av];if(aC[0]=="M"){ay=ak=aC[1];am=at=aC[2]}else{if(aC[0]=="C"){aE=[ay,am].concat(aC.slice(1));ay=aE[6];am=aE[7]}else{aE=[ay,am,ay,am,ak,at,ak,at];ay=ak;am=at}var ar=e(aF,aE,aB);if(aB){aG+=ar}else{for(var au=0,an=ar.length;au<an;au++){ar[au].segment1=ax;ar[au].segment2=av;ar[au].bez1=aF;ar[au].bez2=aE}aG=aG.concat(ar)}}}}}return aG}function W(ak,aj,am){var al=D(ak);return ah(al,aj,am)&&ai(ak,[["M",aj,am],["H",al.x2+10]],1)%2==1}function D(ay){var ar=V(ay);if(ar.bbox){return I(ar.bbox)}if(!ay){return p()}ay=af(ay);var av=0,au=0,an=[],ak=[],al;for(var ap=0,ax=ay.length;ap<ax;ap++){al=ay[ap];if(al[0]=="M"){av=al[1];au=al[2];an.push(av);ak.push(au)}else{var aq=ac(av,au,al[1],al[2],al[3],al[4],al[5],al[6]);an=an.concat(aq.min.x,aq.max.x);ak=ak.concat(aq.min.y,aq.max.y);av=al[5];au=al[6]}}var aj=Z.apply(0,an),aw=Z.apply(0,ak),ao=s.apply(0,an),am=s.apply(0,ak),at=p(aj,aw,ao-aj,am-aw);ar.bbox=I(at);return at}function q(aj,ao,ak,am,an){if(an){return[["M",+aj+(+an),ao],["l",ak-an*2,0],["a",an,an,0,0,1,an,an],["l",0,am-an*2],["a",an,an,0,0,1,-an,an],["l",an*2-ak,0],["a",an,an,0,0,1,-an,-an],["l",0,an*2-am],["a",an,an,0,0,1,an,-an],["z"]]}var al=[["M",aj,ao],["l",ak,0],["l",0,am],["l",-ak,0],["z"]];al.toString=l;return al}function G(au,aq,al,aj,at){if(at==null&&aj==null){aj=al}au=+au;aq=+aq;al=+al;aj=+aj;if(at!=null){var ao=Math.PI/180,am=au+al*Math.cos(-aj*ao),ak=au+al*Math.cos(-at*ao),ar=aq+al*Math.sin(-aj*ao),ap=aq+al*Math.sin(-at*ao),an=[["M",am,ar],["A",al,al,0,+(at-aj>180),0,ak,ap]]}else{an=[["M",au,aq],["m",0,-aj],["a",al,aj,0,1,1,0,2*aj],["a",al,aj,0,1,1,0,-2*aj],["z"]]}an.toString=l;return an}var z=L._unit2px,w={path:function(aj){return aj.attr("path")},circle:function(ak){var aj=z(ak);return G(aj.cx,aj.cy,aj.r)},ellipse:function(ak){var aj=z(ak);return G(aj.cx||0,aj.cy||0,aj.rx,aj.ry)},rect:function(ak){var aj=z(ak);return q(aj.x||0,aj.y||0,aj.width,aj.height,aj.rx,aj.ry)},image:function(ak){var aj=z(ak);return q(aj.x||0,aj.y||0,aj.width,aj.height)},line:function(aj){return"M"+[aj.attr("x1")||0,aj.attr("y1")||0,aj.attr("x2"),aj.attr("y2")]},polyline:function(aj){return"M"+aj.attr("points")},polygon:function(aj){return"M"+aj.attr("points")+"z"},deflt:function(aj){var ak=aj.node.getBBox();return q(ak.x,ak.y,ak.width,ak.height)}};function h(av){var al=V(av),ar=String.prototype.toLowerCase;if(al.rel){return J(al.rel)}if(!L.is(av,"array")||!L.is(av&&av[0],"array")){av=L.parsePathString(av)}var aB=[],ao=0,an=0,at=0,aq=0,am=0;if(av[0][0]=="M"){ao=av[0][1];an=av[0][2];at=ao;aq=an;am++;aB.push(["M",ao,an])}for(var ay=am,ap=av.length;ay<ap;ay++){var au=aB[ay]=[],aj=av[ay];if(aj[0]!=ar.call(aj[0])){au[0]=ar.call(aj[0]);switch(au[0]){case"a":au[1]=aj[1];au[2]=aj[2];au[3]=aj[3];au[4]=aj[4];au[5]=aj[5];au[6]=+(aj[6]-ao).toFixed(3);au[7]=+(aj[7]-an).toFixed(3);break;case"v":au[1]=+(aj[1]-an).toFixed(3);break;case"m":at=aj[1];aq=aj[2];default:for(var ax=1,aA=aj.length;ax<aA;ax++){au[ax]=+(aj[ax]-((ax%2)?ao:an)).toFixed(3)}}}else{au=aB[ay]=[];if(aj[0]=="m"){at=aj[1]+ao;aq=aj[2]+an}for(var aw=0,ak=aj.length;aw<ak;aw++){aB[ay][aw]=aj[aw]}}var az=aB[ay].length;switch(aB[ay][0]){case"z":ao=at;an=aq;break;case"h":ao+=+aB[ay][az-1];break;case"v":an+=+aB[ay][az-1];break;default:ao+=+aB[ay][az-2];an+=+aB[ay][az-1]}}aB.toString=l;al.rel=J(aB);return aB}function N(av){var al=V(av);if(al.abs){return J(al.abs)}if(!P(av,"array")||!P(av&&av[0],"array")){av=L.parsePathString(av)}if(!av||!av.length){return[["M",0,0]]}var aC=[],ap=0,ao=0,at=0,ar=0,am=0,aA;if(av[0][0]=="M"){ap=+av[0][1];ao=+av[0][2];at=ap;ar=ao;am++;aC[0]=["M",ap,ao]}var aB=av.length==3&&av[0][0]=="M"&&av[1][0].toUpperCase()=="R"&&av[2][0].toUpperCase()=="Z";for(var au,aj,ay=am,aq=av.length;ay<aq;ay++){aC.push(au=[]);aj=av[ay];aA=aj[0];if(aA!=aA.toUpperCase()){au[0]=aA.toUpperCase();switch(au[0]){case"A":au[1]=aj[1];au[2]=aj[2];au[3]=aj[3];au[4]=aj[4];au[5]=aj[5];au[6]=+aj[6]+ap;au[7]=+aj[7]+ao;break;case"V":au[1]=+aj[1]+ao;break;case"H":au[1]=+aj[1]+ap;break;case"R":var an=[ap,ao].concat(aj.slice(1));for(var ax=2,az=an.length;ax<az;ax++){an[ax]=+an[ax]+ap;an[++ax]=+an[ax]+ao}aC.pop();aC=aC.concat(aa(an,aB));break;case"O":aC.pop();an=G(ap,ao,aj[1],aj[2]);an.push(an[0]);aC=aC.concat(an);break;case"U":aC.pop();aC=aC.concat(G(ap,ao,aj[1],aj[2],aj[3]));au=["U"].concat(aC[aC.length-1].slice(-2));break;case"M":at=+aj[1]+ap;ar=+aj[2]+ao;default:for(ax=1,az=aj.length;ax<az;ax++){au[ax]=+aj[ax]+((ax%2)?ap:ao)}}}else{if(aA=="R"){an=[ap,ao].concat(aj.slice(1));aC.pop();aC=aC.concat(aa(an,aB));au=["R"].concat(aj.slice(-2))}else{if(aA=="O"){aC.pop();an=G(ap,ao,aj[1],aj[2]);an.push(an[0]);aC=aC.concat(an)}else{if(aA=="U"){aC.pop();aC=aC.concat(G(ap,ao,aj[1],aj[2],aj[3]));au=["U"].concat(aC[aC.length-1].slice(-2))}else{for(var aw=0,ak=aj.length;aw<ak;aw++){au[aw]=aj[aw]}}}}}aA=aA.toUpperCase();if(aA!="O"){switch(au[0]){case"Z":ap=+at;ao=+ar;break;case"H":ap=au[1];break;case"V":ao=au[1];break;case"M":at=au[au.length-2];ar=au[au.length-1];default:ap=au[au.length-2];ao=au[au.length-1]}}}aC.toString=l;al.abs=J(aC);return aC}function n(ak,am,aj,al){return[ak,am,aj,al,aj,al]}function Q(ak,am,ap,an,aj,al){var ao=1/3,aq=2/3;return[ao*ak+aq*ap,ao*am+aq*an,ao*aj+aq*ap,ao*al+aq*an,aj,al]}function F(ax,a2,aG,aE,ay,ar,am,aw,a1,az){var aD=m*120/180,aj=m/180*(+ay||0),aK=[],aH,aY=L._.cacher(function(a4,a7,a3){var a6=a4*T.cos(a3)-a7*T.sin(a3),a5=a4*T.sin(a3)+a7*T.cos(a3);return{x:a6,y:a5}});if(!az){aH=aY(ax,a2,-aj);ax=aH.x;a2=aH.y;aH=aY(aw,a1,-aj);aw=aH.x;a1=aH.y;var ak=T.cos(m/180*ay),au=T.sin(m/180*ay),aM=(ax-aw)/2,aL=(a2-a1)/2;var aW=(aM*aM)/(aG*aG)+(aL*aL)/(aE*aE);if(aW>1){aW=T.sqrt(aW);aG=aW*aG;aE=aW*aE}var al=aG*aG,aP=aE*aE,aR=(ar==am?-1:1)*T.sqrt(U((al*aP-al*aL*aL-aP*aM*aM)/(al*aL*aL+aP*aM*aM))),aB=aR*aG*aL/aE+(ax+aw)/2,aA=aR*-aE*aM/aG+(a2+a1)/2,aq=T.asin(((a2-aA)/aE).toFixed(9)),ap=T.asin(((a1-aA)/aE).toFixed(9));aq=ax<aB?m-aq:aq;ap=aw<aB?m-ap:ap;aq<0&&(aq=m*2+aq);ap<0&&(ap=m*2+ap);if(am&&aq>ap){aq=aq-m*2}if(!am&&ap>aq){ap=ap-m*2}}else{aq=az[0];ap=az[1];aB=az[2];aA=az[3]}var av=ap-aq;if(U(av)>aD){var aC=ap,aF=aw,at=a1;ap=aq+aD*(am&&ap>aq?1:-1);aw=aB+aG*T.cos(ap);a1=aA+aE*T.sin(ap);aK=F(aw,a1,aG,aE,ay,0,am,aF,at,[ap,aC,aB,aA])}av=ap-aq;var ao=T.cos(aq),a0=T.sin(aq),an=T.cos(ap),aZ=T.sin(ap),aN=T.tan(av/4),aQ=4/3*aG*aN,aO=4/3*aE*aN,aX=[ax,a2],aV=[ax+aQ*a0,a2-aO*ao],aU=[aw+aQ*aZ,a1-aO*an],aS=[aw,a1];aV[0]=2*aX[0]-aV[0];aV[1]=2*aX[1]-aV[1];if(az){return[aV,aU,aS].concat(aK)}else{aK=[aV,aU,aS].concat(aK).join().split(",");var aI=[];for(var aT=0,aJ=aK.length;aT<aJ;aT++){aI[aT]=aT%2?aY(aK[aT-1],aK[aT],aj).y:aY(aK[aT],aK[aT+1],aj).x}return aI}}function X(ak,aj,am,al,ar,aq,ap,ao,at){var an=1-at;return{x:S(an,3)*ak+S(an,2)*3*at*am+an*3*at*at*ar+S(at,3)*ap,y:S(an,3)*aj+S(an,2)*3*at*al+an*3*at*at*aq+S(at,3)*ao}}function ac(aE,am,aD,al,aC,ak,aB,aj){var ax=[],ao=[[],[]],aH,aG,aF,av,au,ar,an,ap;for(var aA=0;aA<2;++aA){if(aA==0){aG=6*aE-12*aD+6*aC;aH=-3*aE+9*aD-9*aC+3*aB;aF=3*aD-3*aE}else{aG=6*am-12*al+6*ak;aH=-3*am+9*al-9*ak+3*aj;aF=3*al-3*am}if(U(aH)<1e-12){if(U(aG)<1e-12){continue}av=-aF/aG;if(0<av&&av<1){ax.push(av)}continue}an=aG*aG-4*aF*aH;ap=T.sqrt(an);if(an<0){continue}au=(-aG+ap)/(2*aH);if(0<au&&au<1){ax.push(au)}ar=(-aG-ap)/(2*aH);if(0<ar&&ar<1){ax.push(ar)}}var at,aq,az=ax.length,aw=az,ay;while(az--){av=ax[az];ay=1-av;ao[0][az]=(ay*ay*ay*aE)+(3*ay*ay*av*aD)+(3*ay*av*av*aC)+(av*av*av*aB);ao[1][az]=(ay*ay*ay*am)+(3*ay*ay*av*al)+(3*ay*av*av*ak)+(av*av*av*aj)}ao[0][aw]=aE;ao[1][aw]=am;ao[0][aw+1]=aB;ao[1][aw+1]=aj;ao[0].length=ao[1].length=aw+2;return{min:{x:Z.apply(0,ao[0]),y:Z.apply(0,ao[1])},max:{x:s.apply(0,ao[0]),y:s.apply(0,ao[1])}}}function af(ar,ak){var an=!ak&&V(ar);if(!ak&&an.curve){return J(an.curve)}var at=N(ar),aj=ak&&N(ak),au={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},aB={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},aA=function(aG,aH,aF){var aE,aI;if(!aG){return["C",aH.x,aH.y,aH.x,aH.y,aH.x,aH.y]}!(aG[0] in {T:1,Q:1})&&(aH.qx=aH.qy=null);switch(aG[0]){case"M":aH.X=aG[1];aH.Y=aG[2];break;case"A":aG=["C"].concat(F.apply(0,[aH.x,aH.y].concat(aG.slice(1))));break;case"S":if(aF=="C"||aF=="S"){aE=aH.x*2-aH.bx;aI=aH.y*2-aH.by}else{aE=aH.x;aI=aH.y}aG=["C",aE,aI].concat(aG.slice(1));break;case"T":if(aF=="Q"||aF=="T"){aH.qx=aH.x*2-aH.qx;aH.qy=aH.y*2-aH.qy}else{aH.qx=aH.x;aH.qy=aH.y}aG=["C"].concat(Q(aH.x,aH.y,aH.qx,aH.qy,aG[1],aG[2]));break;case"Q":aH.qx=aG[1];aH.qy=aG[2];aG=["C"].concat(Q(aH.x,aH.y,aG[1],aG[2],aG[3],aG[4]));break;case"L":aG=["C"].concat(n(aH.x,aH.y,aG[1],aG[2]));break;case"H":aG=["C"].concat(n(aH.x,aH.y,aG[1],aH.y));break;case"V":aG=["C"].concat(n(aH.x,aH.y,aH.x,aG[1]));break;case"Z":aG=["C"].concat(n(aH.x,aH.y,aH.X,aH.Y));break}return aG},ay=function(aE,aF){if(aE[aF].length>7){aE[aF].shift();var aG=aE[aF];while(aG.length){ax[aF]="A";aj&&(av[aF]="A");aE.splice(aF++,0,["C"].concat(aG.splice(0,6)))}aE.splice(aF,1);ap=s(at.length,aj&&aj.length||0)}},ao=function(aI,aH,aF,aE,aG){if(aI&&aH&&aI[aG][0]=="M"&&aH[aG][0]!="M"){aH.splice(aG,0,["M",aE.x,aE.y]);aF.bx=0;aF.by=0;aF.x=aI[aG][1];aF.y=aI[aG][2];ap=s(at.length,aj&&aj.length||0)}},ax=[],av=[],al="",aC="";for(var aw=0,ap=s(at.length,aj&&aj.length||0);aw<ap;aw++){at[aw]&&(al=at[aw][0]);if(al!="C"){ax[aw]=al;aw&&(aC=ax[aw-1])}at[aw]=aA(at[aw],au,aC);if(ax[aw]!="A"&&al=="C"){ax[aw]="C"}ay(at,aw);if(aj){aj[aw]&&(al=aj[aw][0]);if(al!="C"){av[aw]=al;aw&&(aC=av[aw-1])}aj[aw]=aA(aj[aw],aB,aC);if(av[aw]!="A"&&al=="C"){av[aw]="C"}ay(aj,aw)}ao(at,aj,au,aB,aw);ao(aj,at,aB,au,aw);var az=at[aw],aD=aj&&aj[aw],aq=az.length,am=aj&&aD.length;au.x=az[aq-2];au.y=az[aq-1];au.bx=f(az[aq-4])||au.x;au.by=f(az[aq-3])||au.y;aB.bx=aj&&(f(aD[am-4])||aB.x);aB.by=aj&&(f(aD[am-3])||aB.y);aB.x=aj&&aD[am-2];aB.y=aj&&aD[am-1]}if(!aj){an.curve=J(at)}return aj?[at,aj]:at}function A(ar,ao){if(!ao){return ar}var ap,an,al,aj,aq,am,ak;ar=af(ar);for(al=0,aq=ar.length;al<aq;al++){ak=ar[al];for(aj=1,am=ak.length;aj<am;aj+=2){ap=ao.x(ak[aj],ak[aj+1]);an=ao.y(ak[aj],ak[aj+1]);ak[aj]=ap;ak[aj+1]=an}}return ar}function aa(al,ao){var an=[];for(var ak=0,aj=al.length;aj-2*!ao>ak;ak+=2){var am=[{x:+al[ak-2],y:+al[ak-1]},{x:+al[ak],y:+al[ak+1]},{x:+al[ak+2],y:+al[ak+3]},{x:+al[ak+4],y:+al[ak+5]}];if(ao){if(!ak){am[0]={x:+al[aj-2],y:+al[aj-1]}}else{if(aj-4==ak){am[3]={x:+al[0],y:+al[1]}}else{if(aj-2==ak){am[2]={x:+al[0],y:+al[1]};am[3]={x:+al[2],y:+al[3]}}}}}else{if(aj-4==ak){am[3]=am[2]}else{if(!ak){am[0]={x:+al[ak],y:+al[ak+1]}}}}an.push(["C",(-am[0].x+6*am[1].x+am[2].x)/6,(-am[0].y+6*am[1].y+am[2].y)/6,(am[1].x+6*am[2].x-am[3].x)/6,(am[1].y+6*am[2].y-am[3].y)/6,am[2].x,am[2].y])}return an}L.path=V;L.path.getTotalLength=y;L.path.getPointAtLength=Y;L.path.getSubpath=function(ak,am,al){if(this.getTotalLength(ak)-al<0.000001){return o(ak,am).end}var aj=o(ak,al,1);return am?o(aj,am).end:aj};v.getTotalLength=function(){if(this.node.getTotalLength){return this.node.getTotalLength()}};v.getPointAtLength=function(aj){return Y(this.attr("d"),aj)};v.getSubpath=function(ak,aj){return L.path.getSubpath(this.attr("d"),ak,aj)};L._.box=p;L.path.findDotsAtSegment=C;L.path.bezierBBox=j;L.path.isPointInsideBBox=ah;L.closest=function(av,at,al,ak){var aj=100,au=p(av-aj/2,at-aj/2,aj,aj),an=[],ar=al[0].hasOwnProperty("x")?function(az){return{x:al[az].x,y:al[az].y}}:function(az){return{x:al[az],y:ak[az]}},ay=0;while(aj<=1000000&&!ay){for(var ao=0,aw=al.length;ao<aw;ao++){var ax=ar(ao);if(ah(au,ax.x,ax.y)){ay++;an.push(ax);break}}if(!ay){aj*=2;au=p(av-aj/2,at-aj/2,aj,aj)}}if(aj==1000000){return}var ap=Infinity,aq;for(ao=0,aw=an.length;ao<aw;ao++){var am=L.len(av,at,an[ao].x,an[ao].y);if(ap>am){ap=am;an[ao].len=am;aq=an[ao]}}return aq};L.path.isBBoxIntersect=u;L.path.intersection=x;L.path.intersectionNumber=B;L.path.isPointInside=W;L.path.getBBox=D;L.path.get=w;L.path.toRelative=h;L.path.toAbsolute=N;L.path.toCubic=af;L.path.map=A;L.path.toString=l;L.path.clone=J});d.plugin(function(m,f,j,n){var h=Math.max,l=Math.min;var k=function(o){this.items=[];this.bindings={};this.length=0;this.type="set";if(o){for(var p=0,q=o.length;p<q;p++){if(o[p]){this[this.items.length]=this.items[this.items.length]=o[p];this.length++}}}},e=k.prototype;e.push=function(){var r,o;for(var p=0,q=arguments.length;p<q;p++){r=arguments[p];if(r){o=this.items.length;this[o]=this.items[o]=r;this.length++}}return this};e.pop=function(){this.length&&delete this[this.length--];return this.items.pop()};e.forEach=function(r,o){for(var p=0,q=this.items.length;p<q;p++){if(r.call(o,this.items[p],p)===false){return this}}return this};e.animate=function(w,o,r,x){if(typeof r=="function"&&!r.length){x=r;r=a.linear}if(w instanceof m._.Animation){x=w.callback;r=w.easing;o=r.dur;w=w.attr}var s=arguments;if(m.is(w,"array")&&m.is(s[s.length-1],"array")){var u=true}var p,y=function(){if(p){this.b=p}else{p=this.b}},q=0,v=this,t=x&&function(){if(++q==v.length){x.call(this)}};return this.forEach(function(A,z){b.once("snap.animcreated."+A.id,y);if(u){s[z]&&A.animate.apply(A,s[z])}else{A.animate(w,o,r,t)}})};e.remove=function(){while(this.length){this.pop().remove()}return this};e.bind=function(p,q,o){var s={};if(typeof q=="function"){this.bindings[p]=q}else{var r=o||p;this.bindings[p]=function(t){s[r]=t;q.attr(s)}}return this};e.attr=function(s){var r={};for(var o in s){if(this.bindings[o]){this.bindings[o](s[o])}else{r[o]=s[o]}}for(var p=0,q=this.items.length;p<q;p++){this.items[p].attr(r)}return this};e.clear=function(){while(this.length){this.pop()}};e.splice=function(r,u,v){r=r<0?h(this.length+r,0):r;u=h(0,l(this.length-r,u));var q=[],o=[],p=[],s;for(s=2;s<arguments.length;s++){p.push(arguments[s])}for(s=0;s<u;s++){o.push(this[r+s])}for(;s<this.length-r;s++){q.push(this[r+s])}var t=p.length;for(s=0;s<t+q.length;s++){this.items[r+s]=this[r+s]=s<t?p[s]:q[s-t]}s=this.items.length=this.length-=u-t;while(this[s]){delete this[s++]}return new k(o)};e.exclude=function(q){for(var o=0,p=this.length;o<p;o++){if(this[o]==q){this.splice(o,1);return true}}return false};e.insertAfter=function(p){var o=this.items.length;while(o--){this.items[o].insertAfter(p)}return this};e.getBBox=function(){var o=[],t=[],p=[],r=[];for(var q=this.items.length;q--;){if(!this.items[q].removed){var s=this.items[q].getBBox();o.push(s.x);t.push(s.y);p.push(s.x+s.width);r.push(s.y+s.height)}}o=l.apply(0,o);t=l.apply(0,t);p=h.apply(0,p);r=h.apply(0,r);return{x:o,y:t,x2:p,y2:r,width:p-o,height:r-t,cx:o+(p-o)/2,cy:t+(r-t)/2}};e.clone=function(q){q=new k;for(var o=0,p=this.items.length;o<p;o++){q.push(this.items[o].clone())}return q};e.toString=function(){return"Snap\u2018s set"};e.type="set";m.Set=k;m.set=function(){var o=new k;if(arguments.length){o.push.apply(o,Array.prototype.slice.call(arguments,0))}return o}});d.plugin(function(n,h,w,q){var p={},l=/[a-z]+$/i,r=String;p.stroke=p.fill="colour";function f(y){var x=y[0];switch(x.toLowerCase()){case"t":return[x,0,0];case"m":return[x,1,0,0,1,0,0];case"r":if(y.length==4){return[x,0,y[2],y[3]]}else{return[x,0]}case"s":if(y.length==5){return[x,1,1,y[3],y[4]]}else{if(y.length==3){return[x,1,1]}else{return[x,1]}}}}function j(C,A,H){A=r(A).replace(/\.{3}|\u2026/g,C);C=n.parseTransformString(C)||[];A=n.parseTransformString(A)||[];var x=Math.max(C.length,A.length),F=[],G=[],z=0,y,B,E,D;for(;z<x;z++){E=C[z]||f(A[z]);D=A[z]||f(E);if((E[0]!=D[0])||(E[0].toLowerCase()=="r"&&(E[2]!=D[2]||E[3]!=D[3]))||(E[0].toLowerCase()=="s"&&(E[3]!=D[3]||E[4]!=D[4]))){C=n._.transform2matrix(C,H());A=n._.transform2matrix(A,H());F=[["m",C.a,C.b,C.c,C.d,C.e,C.f]];G=[["m",A.a,A.b,A.c,A.d,A.e,A.f]];break}F[z]=[];G[z]=[];for(y=0,B=Math.max(E.length,D.length);y<B;y++){y in E&&(F[z][y]=E[y]);y in D&&(G[z][y]=D[y])}}return{from:k(F),to:k(G),f:v(F)}}function t(x){return x}function s(x){return function(y){return +y.toFixed(3)+x}}function o(x){return x.join(" ")}function m(x){return n.rgb(x[0],x[1],x[2])}function v(F){var x=0,A,E,y,B,z,D,C=[];for(A=0,E=F.length;A<E;A++){z="[";D=['"'+F[A][0]+'"'];for(y=1,B=F[A].length;y<B;y++){D[y]="val["+(x++)+"]"}z+=D+"]";C[A]=z}return Function("val","return Snap.path.toString.call(["+C+"])")}function k(C){var y=[];for(var z=0,A=C.length;z<A;z++){for(var x=1,B=C[z].length;x<B;x++){y.push(C[z][x])}}return y}function e(x){return isFinite(parseFloat(x))}function u(y,x){if(!n.is(y,"array")||!n.is(x,"array")){return false}return y.toString()==x.toString()}h.prototype.equal=function(y,x){return b("snap.util.equal",this,y,x).firstDefined()};b.on("snap.util.equal",function(D,y){var x,G,z=r(this.attr(D)||""),E=this;if(e(z)&&e(y)){return{from:parseFloat(z),to:parseFloat(y),f:t}}if(p[D]=="colour"){x=n.color(z);G=n.color(y);return{from:[x.r,x.g,x.b,x.opacity],to:[G.r,G.g,G.b,G.opacity],f:m}}if(D=="viewBox"){x=this.attr(D).vb.split(" ").map(Number);G=y.split(" ").map(Number);return{from:x,to:G,f:o}}if(D=="transform"||D=="gradientTransform"||D=="patternTransform"){if(y instanceof n.Matrix){y=y.toTransformString()}if(!n._.rgTransform.test(y)){y=n._.svgTransform2string(y)}return j(z,y,function(){return E.getBBox(1)})}if(D=="d"||D=="path"){x=n.path.toCubic(z,y);return{from:k(x[0]),to:k(x[1]),f:v(x[0])}}if(D=="points"){x=r(z).split(n._.separator);G=r(y).split(n._.separator);return{from:x,to:G,f:function(A){return A}}}var C=z.match(l),F=r(y).match(l);if(C&&u(C,F)){return{from:parseFloat(z),to:parseFloat(y),f:s(C)}}else{return{from:this.asPX(D),to:this.asPX(D,y),f:t}}})});d.plugin(function(w,q,s,u){var l=q.prototype,f="hasOwnProperty",k="createTouch" in u.doc,e=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","touchstart","touchmove","touchend","touchcancel"],y={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},z=function(D,B){var A=D=="y"?"scrollTop":"scrollLeft",C=B&&B.node?B.node.ownerDocument:u.doc;return C[A in C.documentElement?"documentElement":"body"][A]},m=function(){this.returnValue=false},j=function(){return this.originalEvent.preventDefault()},o=function(){this.cancelBubble=true},n=function(){return this.originalEvent.stopPropagation()},r=function(F,D,C,B){var A=k&&y[D]?y[D]:D,E=function(L){var K=z("y",B),M=z("x",B);if(k&&y[f](D)){for(var I=0,J=L.targetTouches&&L.targetTouches.length;I<J;I++){if(L.targetTouches[I].target==F||F.contains(L.targetTouches[I].target)){var H=L;L=L.targetTouches[I];L.originalEvent=H;L.preventDefault=j;L.stopPropagation=n;break}}}var G=L.clientX+M,N=L.clientY+K;return C.call(B,L,G,N)};if(D!==A){F.addEventListener(D,E,false)}F.addEventListener(A,E,false);return function(){if(D!==A){F.removeEventListener(D,E,false)}F.removeEventListener(A,E,false);return true}},v=[],x=function(H){var K=H.clientX,J=H.clientY,M=z("y"),N=z("x"),C,D=v.length;while(D--){C=v[D];if(k){var F=H.touches&&H.touches.length,E;while(F--){E=H.touches[F];if(E.identifier==C.el._drag.id||C.el.node.contains(E.target)){K=E.clientX;J=E.clientY;(H.originalEvent?H.originalEvent:H).preventDefault();break}}}else{H.preventDefault()}var B=C.el.node,A,G=B.nextSibling,L=B.parentNode,I=B.style.display;K+=N;J+=M;b("snap.drag.move."+C.el.id,C.move_scope||C.el,K-C.el._drag.x,J-C.el._drag.y,K,J,H)}},p=function(C){w.unmousemove(x).unmouseup(p);var B=v.length,A;while(B--){A=v[B];A.el._drag={};b("snap.drag.end."+A.el.id,A.end_scope||A.start_scope||A.move_scope||A.el,C);b.off("snap.drag.*."+A.el.id)}v=[]};for(var t=e.length;t--;){(function(A){w[A]=l[A]=function(E,D){if(w.is(E,"function")){this.events=this.events||[];this.events.push({name:A,f:E,unbind:r(this.node||document,A,E,D||this)})}else{for(var B=0,C=this.events.length;B<C;B++){if(this.events[B].name==A){try{this.events[B].f.call(this)}catch(F){}}}}return this};w["un"+A]=l["un"+A]=function(D){var C=this.events||[],B=C.length;while(B--){if(C[B].name==A&&(C[B].f==D||!D)){C[B].unbind();C.splice(B,1);!C.length&&delete this.events;return this}}return this}})(e[t])}l.hover=function(D,A,C,B){return this.mouseover(D,C).mouseout(A,B||C)};l.unhover=function(B,A){return this.unmouseover(B).unmouseout(A)};var h=[];l.drag=function(H,B,J,G,C,D){var E=this;if(!arguments.length){var F;return E.drag(function(L,K){this.attr({transform:F+(F?"T":"t")+[L,K]})},function(){F=this.transform().local})}function A(L,K,M){(L.originalEvent||L).preventDefault();E._drag.x=K;E._drag.y=M;E._drag.id=L.identifier;!v.length&&w.mousemove(x).mouseup(p);v.push({el:E,move_scope:G,start_scope:C,end_scope:D});B&&b.on("snap.drag.start."+E.id,B);H&&b.on("snap.drag.move."+E.id,H);J&&b.on("snap.drag.end."+E.id,J);b("snap.drag.start."+E.id,C||G||E,K,M,L)}function I(L,K,M){b("snap.draginit."+E.id,E,L,K,M)}b.on("snap.draginit."+E.id,A);E._drag={};h.push({el:E,start:A,init:I});E.mousedown(I);return E};l.undrag=function(){var A=h.length;while(A--){if(h[A].el==this){this.unmousedown(h[A].init);h.splice(A,1);b.unbind("snap.drag.*."+this.id);b.unbind("snap.draginit."+this.id)}}!h.length&&w.unmousemove(x).unmouseup(p);return this}});d.plugin(function(k,e,o,l){var j=e.prototype,n=o.prototype,f=/^\s*url\((.+)\)/,m=String,h=k._.$;k.filter={};n.filter=function(s){var u=this;if(u.type!="svg"){u=u.paper}var t=k.parse(m(s)),v=k._.id(),r=u.node.offsetWidth,p=u.node.offsetHeight,q=h("filter");h(q,{id:v,filterUnits:"userSpaceOnUse"});q.appendChild(t.node);u.defs.appendChild(q);return new e(q)};b.on("snap.util.getattr.filter",function(){b.stop();var r=h(this.node,"filter");if(r){var q=m(r).match(f);return q&&k.select(q[1])}});b.on("snap.util.attr.filter",function(p){if(p instanceof e&&p.type=="filter"){b.stop();var q=p.node.id;if(!q){h(p.node,{id:p.id});q=p.id}h(this.node,{filter:k.url(q)})}if(!p||p=="none"){b.stop();this.node.removeAttribute("filter")}});k.filter.blur=function(p,r){if(p==null){p=2}var q=r==null?p:[p,r];return k.format('<feGaussianBlur stdDeviation="{def}"/>',{def:q})};k.filter.blur.toString=function(){return this()};k.filter.shadow=function(r,p,t,q,s){if(typeof t=="string"){q=t;s=q;t=4}if(typeof q!="string"){s=q;q="#000"}q=q||"#000";if(t==null){t=4}if(s==null){s=1}if(r==null){r=0;p=2}if(p==null){p=r}q=k.color(q);return k.format('<feGaussianBlur in="SourceAlpha" stdDeviation="{blur}"/><feOffset dx="{dx}" dy="{dy}" result="offsetblur"/><feFlood flood-color="{color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="{opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>',{color:q,dx:r,dy:p,blur:t,opacity:s})};k.filter.shadow.toString=function(){return this()};k.filter.grayscale=function(p){if(p==null){p=1}return k.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {b} {h} 0 0 0 0 0 1 0"/>',{a:0.2126+0.7874*(1-p),b:0.7152-0.7152*(1-p),c:0.0722-0.0722*(1-p),d:0.2126-0.2126*(1-p),e:0.7152+0.2848*(1-p),f:0.0722-0.0722*(1-p),g:0.2126-0.2126*(1-p),h:0.0722+0.9278*(1-p)})};k.filter.grayscale.toString=function(){return this()};k.filter.sepia=function(p){if(p==null){p=1}return k.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {h} {i} 0 0 0 0 0 1 0"/>',{a:0.393+0.607*(1-p),b:0.769-0.769*(1-p),c:0.189-0.189*(1-p),d:0.349-0.349*(1-p),e:0.686+0.314*(1-p),f:0.168-0.168*(1-p),g:0.272-0.272*(1-p),h:0.534-0.534*(1-p),i:0.131+0.869*(1-p)})};k.filter.sepia.toString=function(){return this()};k.filter.saturate=function(p){if(p==null){p=1}return k.format('<feColorMatrix type="saturate" values="{amount}"/>',{amount:1-p})};k.filter.saturate.toString=function(){return this()};k.filter.hueRotate=function(p){p=p||0;return k.format('<feColorMatrix type="hueRotate" values="{angle}"/>',{angle:p})};k.filter.hueRotate.toString=function(){return this()};k.filter.invert=function(p){if(p==null){p=1}return k.format('<feComponentTransfer><feFuncR type="table" tableValues="{amount} {amount2}"/><feFuncG type="table" tableValues="{amount} {amount2}"/><feFuncB type="table" tableValues="{amount} {amount2}"/></feComponentTransfer>',{amount:p,amount2:1-p})};k.filter.invert.toString=function(){return this()};k.filter.brightness=function(p){if(p==null){p=1}return k.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}"/><feFuncG type="linear" slope="{amount}"/><feFuncB type="linear" slope="{amount}"/></feComponentTransfer>',{amount:p})};k.filter.brightness.toString=function(){return this()};k.filter.contrast=function(p){if(p==null){p=1}return k.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}" intercept="{amount2}"/><feFuncG type="linear" slope="{amount}" intercept="{amount2}"/><feFuncB type="linear" slope="{amount}" intercept="{amount2}"/></feComponentTransfer>',{amount:p,amount2:0.5-p/2})};k.filter.contrast.toString=function(){return this()}});d.plugin(function(m,e,o,n,h){var k=m._.box,l=m.is,j=/^[^a-z]*([tbmlrc])/i,f=function(){return"T"+this.dx+","+this.dy};e.prototype.getAlign=function(r,q){if(q==null&&l(r,"string")){q=r;r=null}r=r||this.paper;var t=r.getBBox?r.getBBox():k(r),s=this.getBBox(),p={};q=q&&q.match(j);q=q?q[1].toLowerCase():"c";switch(q){case"t":p.dx=0;p.dy=t.y-s.y;break;case"b":p.dx=0;p.dy=t.y2-s.y2;break;case"m":p.dx=0;p.dy=t.cy-s.cy;break;case"l":p.dx=t.x-s.x;p.dy=0;break;case"r":p.dx=t.x2-s.x2;p.dy=0;break;default:p.dx=t.cx-s.cx;p.dy=0;break}p.toString=f;return p};e.prototype.align=function(q,p){return this.transform("..."+this.getAlign(q,p))}});return d}));ampApp.controller("contract-main-controller",["$scope","$filter","$http","$rootScope","getPaginationResultFactory",function(o,n,t,j,e){o.records=[];o.filteredRecords=o.records;o.paginationInfo={pageNo:null,pageCount:null,recordCount:null,pageSize:null,records:[]};o.fetchData=function(){o.paginationInfo=e(o.paginationInfo.pageNo,o.paginationInfo.pageSize,o.filteredRecords);$(m).find(".amp-datetimepicker input").datetimepicker("remove");o.$apply()};function d(v){o.records=v;o.filteredRecords=o.records;var w=1;var u=10;o.paginationInfo=e(w,u,o.filteredRecords)}var l="";var b="";var a=null;var c=null;function k(v,u){if(v==null||u==null){return 0}if(v.getTime()==u.getTime()){return 0}else{if(v.getTime()<u.getTime()){return -1}else{if(v.getTime()>u.getTime()){return 1}}}}function r(v){if(v.contractId.indexOf(l)<0){return}if(v.rentType.indexOf(b)<0){return}var u=null;if(v.contractStartTime!=null){u=new Date(v.contractStartTime)}if(k(a,u)>0||k(c,u)<0){return}return v}o.$on("contract-main.query",function(u,v){$(m).find(".amp-datetimepicker input").datetimepicker("remove");l=v.contractId;b=v.rentType;if(b=="全部"){b=""}a=v.startDate;c=v.endDate;o.filteredRecords=n("filter")(o.records,r);o.paginationInfo=e(o.paginationInfo.pageNo,o.paginationInfo.pageSize,o.filteredRecords);o.$apply();$(m).find(".amp-datetimepicker input").datetimepicker("remove")});o.$on("contract-main.save-record",function(u,v){o.records.unshift(v);o.filteredRecords=n("filter")(o.records,r);o.paginationInfo=e(o.paginationInfo.pageNo,o.paginationInfo.pageSize,o.filteredRecords);o.$apply()});o.$on("$destroy",function(){s()});var m=null;var h=null;function p(){m=$("#contract-main");if(isPC()){h=$(m).find(".amp-thead").pin({containerSelector:$(m).find(".amp-collapse-table"),padding:{top:44,bottom:50}})}}function f(){$(m).on("click",".amp-collapse-table .amp-tbody .amp-table-row-content",function(u){if($(this).parent().find(".amp-table-row-collapse").length==0){return}if(!$(this).next().hasClass("amp-table-row-collapse-initialized")){$(this).next().addClass("amp-table-row-collapse-initialized");$(this).next().find(".amp-datetimepicker input").datetimepicker({language:"zh-CN",format:"yyyy-mm-dd",todayBtn:"linked",startView:2,minView:2,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0});$(this).next().find(".amp-datetimepicker").on("click",function(v){v.stopPropagation();v.preventDefault();$(this).closest(".amp-datetimepicker").find("input").datetimepicker({language:"zh-CN",format:"yyyy-mm-dd",todayBtn:"linked",startView:2,minView:2,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0});$(this).closest(".amp-datetimepicker").find("input").datetimepicker("show")})}if(isPC()){setTimeout(function(){h.refresh()},1000)}});m.on("click","a.cancel-btn,a.ok-btn",function(u){u.stopPropagation();u.preventDefault();$(this).closest(".amp-table-row").find(".amp-table-row-content").click()});m.on("focus","[data-type=number]",function(u){u.stopPropagation();u.preventDefault();var v=$(this).val().replace(/,/g,"");$(this).val(v)});m.on("blur","[data-type=number]",function(u){u.stopPropagation();u.preventDefault();var v=n("number")($(this).val());$(this).val(v)})}function s(){$(m).find(".amp-datetimepicker input").datetimepicker("remove")}function q(){var u=j.curProject;var v="../static/js/mgt_analysis/data/"+u+"/contract_main_data.json";t.get(v).success(function(w){d(w);p();f()})}q()}]);ampApp.controller("contract-main-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#contract-main-left");f();amp_main.leftPanel_update();$(c).find(".amp-datetimepicker input").datetimepicker({language:"zh-CN",format:"yy-mm-dd",todayBtn:"linked",startView:2,minView:2,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0})}function j(){c.on("click touchend","a.enrolment-btn",function(k){k.stopPropagation();k.preventDefault();a.$broadcast("contract-main.enrolment");d.$apply();console.log("broadcast enrolment")});c.on("click touchend","a.reset-btn",function(k){k.stopPropagation();k.preventDefault();f();$(c).find(".amp-datetimepicker input").datetimepicker("update")});c.on("click touchend","a.query-btn",function(q){q.stopPropagation();q.preventDefault();var p=$(this).closest(".amp-form-group-container");var k=p.find("[data-name=startDate]").val();k="20"+k;k=new Date(k);var o=p.find("[data-name=endDate]").val();if(o==""){o=null}else{o="20"+o;o=new Date(o)}var n=p.find("[data-name=rentType]").val();var m=p.find("[data-name=contractId]").val();var l={startDate:k,endDate:o,rentType:n,contractId:m};a.$broadcast("contract-main.query",l);d.$apply()})}function e(){$(c).find(".amp-datetimepicker input").datetimepicker("remove")}function f(){var k=new Date();var m=k.getFullYear();var o=k.getMonth()+1;var l=k.getDate();m=m%2000;if(o<10){o="0"+o}if(l<10){l="0"+l}var n=m+"-"+o+"-"+l;c.find("[data-name=startDate]").val(n);c.find("[data-name=endDate]").val("");c.find("[data-name=rentType]").val("全部");c.find("[data-name=contractId]").val("");c.find(".amp-select li").removeClass("active")}function h(){b();j()}h()}]);ampApp.controller("contract-main-right-controller",["$scope","$rootScope",function(j,f){j.$on("$destroy",function(){h()});j.$on("contract-main.enrolment",function(){b.removeClass("amp-display-hide");b.find(".contract-enrolment").addClass("amp-animated").addClass("amp-slide-left-in");a()});j.source=[];j.loadSource=function(l){j.source=[{id:"001",name:"value1"},{id:"002",name:"value2"},{id:"003",name:"value3"}]};var b=null;function e(){b=$("#contract-main-right")}function c(){$(b).find(".amp-datetimepicker input").datetimepicker({language:"zh-CN",format:"yyyy-mm-dd",todayBtn:"linked",startView:2,minView:2,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0});$(b).find(".amp-datetimepicker").on("click",function(l){l.stopPropagation();l.preventDefault();$(this).closest(".amp-datetimepicker").find("input").datetimepicker("show")});b.find(".contract-enrolment").on("webkitAnimationEnd animationend",function(){if($(this).hasClass("amp-slide-right-out")){b.addClass("amp-display-hide");d()}$(this).removeClass("amp-slide-right-out");$(this).removeClass("amp-slide-left-in")});b.on("click","a.close-panel-btn",function(l){l.stopPropagation();l.preventDefault();b.find(".contract-enrolment").addClass("amp-slide-right-out");a()});b.on("click","a.save-btn",function(m){m.stopPropagation();m.preventDefault();if(!validateAmpInputCollection($(b).find("[amp-input-validate]"))){return}var l={};b.find("[data-name]").each(function(){var n=$(this).attr("data-name");var o=$(this).val();l[n]=o});f.$broadcast("contract-main.save-record",l);j.$apply();b.find(".contract-enrolment").addClass("amp-slide-right-out")});b.on("click","a.continue-save-btn",function(m){m.stopPropagation();m.preventDefault();if(!validateAmpInputCollection($(b).find("[amp-input-validate]"))){return}var l={};b.find("[data-name]").each(function(){var n=$(this).attr("data-name");var o=$(this).val();l[n]=o});f.$broadcast("contract-main.save-record",l);j.$apply();d()});b.on("change",".amp-input[amp-input-validate] input",function(l){l.stopPropagation();l.preventDefault();validateAmpInputCollection($(this).parent())})}function a(){setTimeout(function(){if(b.find(".contract-enrolment").hasClass("amp-slide-right-out")){b.addClass("amp-display-hide");d()}b.find(".contract-enrolment").removeClass("amp-slide-right-out");b.find(".contract-enrolment").removeClass("amp-slide-left-in")},500)}function h(){$(b).find(".amp-datetimepicker input").datetimepicker("remove")}function d(){$(b).find("[data-name]").val("");$(b).find(".amp-input-error").removeClass("amp-input-error")}function k(){e();c()}k()}]);ampApp.controller("cost-main-controller",["$scope","$http","$rootScope",function(n,k,l){n.records=[];function p(q){n.records=q}n.$on("$destroy",function(){m()});var c=null;var a=null;function h(){c=$("#cost-main");if(isPC()){a=$(c).find(".amp-thead").pin({containerSelector:$(c).find(".amp-collapse-table"),padding:{top:44,bottom:50}})}f()}function e(){c.on("click",".amp-table-row-content",function(q){q.stopPropagation();q.preventDefault();window.location="#/cost_manual_work"})}function m(){}function j(){return[8,9,10]}function b(){var q=[];j().forEach(function(r){q.push(r+"月")});return q}function d(s){var r=j();var t=r.shift();var u=r.pop();var q=[];n.records.forEach(function(v){var x=parseInt(v.month);if(x<t||x>u){return}var w=parseFloat(v[s]);q.push(w)});return q}function f(){var x="cost-stack-bar-chart";var r=echarts.init(document.getElementById(x));var q=d("businessReal");console.log(q);var w=d("manualWorkReal");var u=d("mgtFeeReal");var t=d("projecteal");var v=b();console.log(v);var s={color:["#2bd9dd","#038bd8","#a5ee67","#00b2ef"],grid:{top:"20",left:"0",right:"0",bottom:"0",containLabel:true},tooltip:{padding:[5,12],position:"top",formatter:function(E){var D=E.value;var z=E.seriesName;var B=E.dataIndex;var A=q[B]+w[B]+u[B]+t[B];var C=parseInt(D/A*100);if(isNaN(C)){C="-"}else{C+="%"}var y=z+"<br/>金额 : "+D+"<br/>占比 : "+C;return y}},xAxis:[{type:"category",data:v,axisLine:{show:false},axisTick:{show:false},splitLine:{show:false}}],yAxis:[{type:"value",axisTick:{show:false},axisLine:{show:false},minInterval:30,splitLine:{show:true,lineStyle:{color:["#f2f5f7"]}}}],series:[{stack:"总量",name:"营销",type:"bar",barWidth:30,data:q},{stack:"总量",name:"人工",type:"bar",barWidth:30,data:w},{stack:"总量",name:"管理",type:"bar",barWidth:30,data:u},{stack:"总量",name:"工程",type:"bar",barWidth:30,data:t}]};r.setOption(s)}function o(){var q=l.curProject;var r="../static/js/mgt_analysis/data/"+q+"/cost_main_data.json";k.get(r).success(function(s){p(s);h();e()})}setTimeout(function(){o()},300)}]);ampApp.controller("cost-main-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#cost-main-left");amp_main.leftPanel_update();$(c).find(".amp-date-selector input").datetimepicker({language:"zh-CN",format:"yyyy",todayBtn:"linked",startView:4,minView:4,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0});$(c).on("click touchend",".amp-date-selector .amp-date-selector-prev",function(k){k.stopPropagation();k.preventDefault();var j=$(this).closest(".amp-date-selector").find("input").val();j=parseInt(j);j--;$(this).closest(".amp-date-selector").find("input").val(j);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")});$(c).on("click touchend",".amp-date-selector .amp-date-selector-next",function(k){k.stopPropagation();k.preventDefault();var j=$(this).closest(".amp-date-selector").find("input").val();j=parseInt(j);j++;$(this).closest(".amp-date-selector").find("input").val(j);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")})}function h(){c.on("click touchend","a.enrolment-btn",function(j){j.stopPropagation();j.preventDefault();a.$broadcast("cost-main.enrolment")})}function e(){$(c).find(".amp-datetimepicker input").datetimepicker("remove")}function f(){b();h()}f()}]);ampApp.controller("cost-enrolment-controller",["$scope","$rootScope",function(j,f){j.$on("$destroy",function(){h()});j.$on("cost-main.enrolment",function(){b.removeClass("amp-display-hide");b.find(".contract-enrolment").addClass("amp-animated").addClass("amp-slide-left-in");a()});var b=null;function e(){b=$("#cost-enrolment")}function c(){b.find(".contract-enrolment").on("webkitAnimationEnd animationend",function(){if($(this).hasClass("amp-slide-right-out")){b.addClass("amp-display-hide");d()}$(this).removeClass("amp-slide-right-out");$(this).removeClass("amp-slide-left-in")});b.on("click","a.close-panel-btn",function(l){l.stopPropagation();l.preventDefault();b.find(".contract-enrolment").addClass("amp-slide-right-out");a()});b.on("click","a.save-btn",function(l){l.stopPropagation();l.preventDefault();if(!validateAmpInputCollection($(b).find("[amp-input-validate]"))){return}b.find(".contract-enrolment").addClass("amp-slide-right-out")});b.on("change",".amp-input[amp-input-validate] input",function(l){l.stopPropagation();l.preventDefault();validateAmpInputCollection($(this).parent())})}function h(){}function a(){setTimeout(function(){if(b.find(".contract-enrolment").hasClass("amp-slide-right-out")){b.addClass("amp-display-hide");d()}b.find(".contract-enrolment").removeClass("amp-slide-right-out");b.find(".contract-enrolment").removeClass("amp-slide-left-in")},500)}function d(){$(b).find(".amp-input input,.amp-select input").val("");$(b).find(".amp-input-error").removeClass("amp-input-error")}function k(){e();c()}k()}]);ampApp.controller("cost-manual-work-controller",["$scope","$http","$rootScope",function(j,e,f){j.data={};function l(m){j.data=m}j.$on("$destroy",function(){h()});var b=null;var a=null;function d(){b=$("#cost-manual-work");if(isPC()){a=$(b).find(".dept-table-head").pin({containerSelector:$(b).find(".cost-manual-work-pin-wrapper"),padding:{top:44,bottom:50}})}}function c(){b.on("click","a.collapse-btn",function(m){m.stopPropagation();m.preventDefault();$(this).toggleClass("collapsed");$(this).closest("table").find(".sub-record").toggleClass("amp-display-hide");if(isPC()){a.refresh()}})}function h(){}function k(){var m=f.curProject;var n="../static/js/mgt_analysis/data/"+m+"/cost_manual_work_data.json";e.get(n).success(function(o){l(o);d();c()})}k()}]);ampApp.controller("cost-manual-work-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#cost-manual-work-left");amp_main.leftPanel_update();$(c).find(".amp-date-selector input").datetimepicker({language:"zh-CN",format:"yyyy",todayBtn:"linked",startView:4,minView:4,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0});$(c).on("click touchend",".amp-date-selector .amp-date-selector-prev",function(k){k.stopPropagation();k.preventDefault();var j=$(this).closest(".amp-date-selector").find("input").val();j=parseInt(j);j--;$(this).closest(".amp-date-selector").find("input").val(j);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")});$(c).on("click touchend",".amp-date-selector .amp-date-selector-next",function(k){k.stopPropagation();k.preventDefault();var j=$(this).closest(".amp-date-selector").find("input").val();j=parseInt(j);j++;$(this).closest(".amp-date-selector").find("input").val(j);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")})}function h(){c.on("click touchend","a.enrolment-btn",function(j){j.stopPropagation();j.preventDefault();a.$broadcast("cost-manual-work.enrolment")})}function e(){$(c).find(".amp-datetimepicker input").datetimepicker("remove")}function f(){b();h()}f()}]);ampApp.controller("cost-manual-work-enrolment-controller",["$scope",function(c){c.records=null;c.$on("$destroy",function(){d()});c.$on("cost-manual-work.enrolment",function(){b.removeClass("amp-display-hide");b.find(".contract-enrolment").addClass("amp-animated").addClass("amp-slide-left-in");h()});var b=null;function a(){b=$("#cost-manual-work-enrolment")}function j(){b.find(".contract-enrolment").on("webkitAnimationEnd animationend",function(){if($(this).hasClass("amp-slide-right-out")){b.addClass("amp-display-hide");e()}$(this).removeClass("amp-slide-right-out");$(this).removeClass("amp-slide-left-in")});b.on("click","a.close-panel-btn",function(k){k.stopPropagation();k.preventDefault();b.find(".contract-enrolment").addClass("amp-slide-right-out");h()});b.on("click","a.save-btn",function(k){k.stopPropagation();k.preventDefault();if(!validateAmpInputCollection($(b).find("[amp-input-validate]"))){return}b.find(".contract-enrolment").addClass("amp-slide-right-out");h()});b.on("click","a.nav-back-btn",function(k){k.stopPropagation();k.preventDefault();b.find(".contract-enrolment").addClass("amp-slide-right-out");h()});b.on("change",".amp-input[amp-input-validate] input",function(k){k.stopPropagation();k.preventDefault();validateAmpInputCollection($(this).parent())})}function d(){}function e(){$(b).find(".amp-input input").val("");$(b).find(".amp-input-error").removeClass("amp-input-error")}function h(){setTimeout(function(){if(b.find(".contract-enrolment").hasClass("amp-slide-right-out")){b.addClass("amp-display-hide");e()}b.find(".contract-enrolment").removeClass("amp-slide-right-out");b.find(".contract-enrolment").removeClass("amp-slide-left-in")},500)}function f(){a();j()}f()}]);ampApp.controller("passenger-flow-main-controller",["$scope","$filter","$http","$rootScope",function(m,j,v,f){m.info={};m.chart={};var k=new Date().getMonth();var t=new Date();t.setDate(0);function u(){var w=0;for(var x=0;x<=k;x++){w+=m.chart.real[x]}return w}function b(){var w=u();for(var x=11;x>k;x--){w+=m.chart.budget[x]}return w}function a(){var w=0;for(var x=0;x<=11;x++){w+=m.chart.budget[x]}return w}function d(w){m.info.currentMonthDayRate=parseInt(c()/q(new Date())*100);m.info.currentYearDayRate=parseInt(s(new Date())/l(new Date())*100);m.info.currentMonthDayTooltip=c()+"/"+q(new Date());m.info.currentYearDayTooltip=s(new Date())+"/"+l(new Date());m.chart=w.chart;m.info.currentMonthIndexTooltip=m.chart.real[k];m.info.currentMonthIndexRate=parseInt(m.chart.real[k]/m.chart.budget[k]*100);if(isNaN(m.info.currentMonthIndexRate)){m.info.currentMonthIndexRate="-"}m.info.currentMonthCount=m.chart.real[k];m.info.currentYearIndexTooltip=u();m.info.currentYearIndexRate=parseInt(u()/a()*100);if(isNaN(m.info.currentYearIndexRate)){m.info.currentYearIndexRate="-"}m.info.fullYearTotalCount=u();m.info.fullYearCount=b();m.info.linkRelative=parseInt((m.chart.real[k-1]-m.chart.real[k-2])/m.chart.real[k-2]*100);if(isNaN(m.info.linkRelative)){m.info.linkRelative="-"}m.info.yearToYear=parseInt((m.chart.real[k-1]-m.chart.lastYear[k-1])/m.chart.lastYear[k-1]*100);if(isNaN(m.info.yearToYear)){m.info.yearToYear="-"}m.info.targetRate=parseInt((m.chart.real[k-1])/m.chart.budget[k-1]*100);if(isNaN(m.info.targetRate)){m.info.targetRate="-"}m.info.penetranceRate=j("number")(m.chart.real[k-1]/w.info.square/q(t));if(isNaN(m.info.penetranceRate)){m.info.penetranceRate="-"}}m.$on("$destroy",function(){r()});var h=null;function n(){h=$("#passenger-flow-main");o();setTimeout(function(){h.find(".amp-progress-bar").each(function(){var w=$(this).closest(".amp-progress").attr("data-value");$(this).find(".amp-progress-bar-finished").css("width",w+"%")})},200)}function e(){h.on("mouseenter",".amp-progress-bar",function(C){C.stopPropagation();C.preventDefault();clearTimeout(w);var B=parseInt(h.find(".amp-progress-tooltip").css("width"));var z=C.pageX-200-B/2;var D=C.pageY-44;var A=$(this).closest(".amp-progress").attr("data-tooltip");h.find(".amp-progress-tooltip span").html(A);h.find(".amp-progress-tooltip").css({left:z+"px",top:D+"px"});h.find(".amp-progress-tooltip").fadeIn("fast")});var w=null;h.on("mouseleave",".amp-progress-bar",function(x){x.stopPropagation();x.preventDefault();clearTimeout(w);w=setTimeout(function(){h.find(".amp-progress-tooltip").fadeOut("fast")},500)})}function o(){var w=echarts.init(h.find(".passenger-flow-chart .passenger-flow-chart-content")[0]);var x={color:["#5AB46E","#5CD3F5","#038BD9"],tooltip:{show:true},legend:{orient:"horizontal",x:"center",y:"bottom",borderWidth:0,padding:5,itemGap:20,itemWidth:15,temHeight:10,textStyle:{color:"#9EA8B5"},data:[{name:"实际",icon:"rect"},{name:"预算",icon:"rect"},{name:"去年同期",icon:"rect"}]},xAxis:{type:"category",axisLine:{show:true,lineStyle:{color:"#f3f4f8"}},axisLabel:{show:true,textStyle:{color:"#737e8c"}},splitLine:{show:false},axisTick:{show:false},data:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]},yAxis:{type:"value",axisTick:{show:false},splitLine:{show:false},axisLabel:{show:false},axisLine:{show:false}},series:[{barWidth:10,name:"实际",type:"bar",data:m.chart.real},{barWidth:10,name:"预算",type:"bar",data:m.chart.budget},{barWidth:10,name:"去年同期",type:"bar",data:m.chart.lastYear}]};w.setOption(x)}function r(){}function c(){return new Date().getDate()}function q(y){var w=new Date(y);var x=w.getMonth();w.setMonth(x+1);w.setDate(0);return w.getDate()}function s(B){var A=B.getMonth();var z=B.getFullYear();var x=B.getDate();var w=x;for(var y=0;y<A;y++){var x=new Date();x.setFullYear(z);x.setMonth(A);w+=q(x)}return w}function l(z){var w=0;var x=new Date(z);for(var y=0;y<12;y++){x.setMonth(y);w+=q(x)}return w}function p(){var w=f.curProject;var x="../static/js/mgt_analysis/data/"+w+"/passenger_flow_main_data.json";v.get(x).success(function(y){d(y);n();e()})}setTimeout(function(){p()},300)}]);ampApp.controller("passenger-flow-main-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#passenger-flow-main-left");amp_main.leftPanel_update();var j=new Date();var k=j.getFullYear();var l=j.getMonth()+1;if(l<10){l="0"+l}$(c).find(".amp-date-selector input").val(k+"-"+l);$(c).find(".amp-date-selector input").datetimepicker({language:"zh-CN",format:"yyyy-mm",todayBtn:"linked",startView:3,minView:3,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0})}function h(){$(c).on("click touchend",".amp-date-selector .amp-date-selector-prev",function(n){n.stopPropagation();n.preventDefault();var o=$(this).closest(".amp-date-selector").find("input").val();var k=parseInt(o.split("-")[0]);var m=parseInt(o.split("-")[1]);m--;var j=new Date();j.setFullYear(k);j.setMonth(m-1);var l="";if(j.getMonth()+1<10){l="0"+(j.getMonth()+1)}else{l=(j.getMonth()+1)}$(this).closest(".amp-date-selector").find("input").val(j.getFullYear()+"-"+l);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")});$(c).on("click touchend",".amp-date-selector .amp-date-selector-next",function(n){n.stopPropagation();n.preventDefault();var o=$(this).closest(".amp-date-selector").find("input").val();var k=parseInt(o.split("-")[0]);var m=parseInt(o.split("-")[1]);m++;var j=new Date();j.setFullYear(k);j.setMonth(m-1);var l="";if(j.getMonth()+1<10){l="0"+(j.getMonth()+1)}else{l=(j.getMonth()+1)}$(this).closest(".amp-date-selector").find("input").val(j.getFullYear()+"-"+l);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")});c.on("click touchend","a.enrolment-btn",function(j){j.stopPropagation();j.preventDefault();window.location="#/passenger_flow_main_enrolment"})}function e(){$(c).find(".amp-datetimepicker input").datetimepicker("remove")}function f(){b();h()}f()}]);ampApp.controller("passenger-flow-main-enrolment-controller",["$scope","$filter",function(c,e){c.record={year:2016,real1:"",real2:"",real3:"",real4:"",real5:"",real6:"",real7:"",real8:"",real9:"",real10:"",real11:"",real12:"",budget1:0,budget2:"",budget3:"",budget4:"",budget5:"",budget6:"",budget7:"",budget8:"",budget9:"",budget10:"",budget11:"",budget12:""};c.$on("$destroy",function(){d()});var b=null;function a(){b=$("#passenger-flow-main-enrolment")}function h(){b.on("click","a.nav-back-btn",function(j){j.stopPropagation();j.preventDefault();window.location="#/passenger_flow_main"});b.on("click","a.save-btn",function(j){j.stopPropagation();j.preventDefault();if(!validateAmpInputCollection($(b).find("[amp-input-validate]"))){return}});b.on("change",".amp-input[amp-input-validate] input",function(j){j.stopPropagation();j.preventDefault();validateAmpInputCollection($(this).parent())})}function d(){}function f(){a();h()}f()}]);ampApp.controller("passenger-flow-main-enrolment-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#passenger-flow-main-enrolment-left");amp_main.leftPanel_update();var j=new Date().getFullYear();$(c).find(".amp-date-selector input").val(j);$(c).find(".amp-date-selector input").datetimepicker({language:"zh-CN",format:"yyyy",todayBtn:"linked",startView:4,minView:4,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0});$(c).on("click touchend",".amp-date-selector .amp-date-selector-prev",function(l){l.stopPropagation();l.preventDefault();var k=$(this).closest(".amp-date-selector").find("input").val();k=parseInt(k);k--;$(this).closest(".amp-date-selector").find("input").val(k);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")});$(c).on("click touchend",".amp-date-selector .amp-date-selector-next",function(l){l.stopPropagation();l.preventDefault();var k=$(this).closest(".amp-date-selector").find("input").val();k=parseInt(k);k++;$(this).closest(".amp-date-selector").find("input").val(k);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")})}function h(){}function e(){$(c).find(".amp-datetimepicker input").datetimepicker("remove")}function f(){b();h()}f()}]);ampApp.controller("merchant-sale-main-controller",["$scope","$filter","$http","$rootScope",function(l,e,f,h){l.records=[];function o(p){l.records=p}l.$on("$destroy",function(){j()});var b=null;var a=null;function d(){b=$("#merchant-sale-main");k();n();if(isPC()){a=$(b).find(".dept-table-head").pin({containerSelector:$(b).find(".cost-manual-work-pin-wrapper"),padding:{top:44,bottom:50}})}}function c(){b.on("click",".pie-text",function(p){p.stopPropagation();p.preventDefault();window.location="#/shop_sale_rank"});b.on("click",".collapse-btn",function(q){q.stopPropagation();q.preventDefault();var p=$(this).attr("data-group");$(b).find("tr[data-group="+p+"]:not(.parent-record)").toggleClass("amp-display-hide");$(this).toggleClass("collapsed")});b.on("click",".table-block tbody tr:not(.parent-record) td:first-child",function(q){q.stopPropagation();q.preventDefault();var p=$(this).attr("data-type");if(p=="餐饮"){p="catering"}else{if(p=="配套"){p="mating"}else{if(p=="服装"){p="clothing"}else{if(p=="儿童"){p="children"}else{if(p=="影院"){p="cinema"}else{return}}}}}globalStorage.setSessionData("select_commercial_type_for_sale",p);window.location="#/shop_sale_type_list"})}function j(){}function k(){var r="sale-percent-pie";var p=echarts.init(document.getElementById(r));var q={color:["#5ab46e","#d9dedf"],tooltip:{show:true,formatter:"{d}%"},series:[{name:"销售",type:"pie",radius:["70px","100px"],avoidLabelOverlap:false,label:{normal:{show:false}},startAngle:90,data:[16251462.38,17696209.62],silent:false,hoverAnimation:false}]};p.setOption(q);$("#"+r).append("<div class='pie-text'>销售占比</div>")}function n(){var r="merchant-percent-pie";var p=echarts.init(document.getElementById(r));var q={color:["#5ab46e","#d9dedf"],tooltip:{show:true,formatter:"{d}%"},series:[{type:"pie",radius:["70px","100px"],avoidLabelOverlap:false,label:{normal:{show:false}},startAngle:90,data:[93,117],silent:false,hoverAnimation:false}]};p.setOption(q);$("#"+r).append("<div class='pie-text'>商家占比</div>")}function m(){var p=h.curProject;var q="../static/js/mgt_analysis/data/"+p+"/merchant_sale_main_data.json";f.get(q).success(function(r){o(r);d();c()})}setTimeout(function(){m()},300)}]);ampApp.controller("merchant-sale-main-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#merchant-sale-main-left");amp_main.leftPanel_update();var j=new Date();var k=j.getFullYear();var l=j.getMonth()+1;if(l<10){l="0"+l}$(c).find(".amp-date-selector input").val(k+"-"+l);$(c).find(".amp-date-selector input").datetimepicker({language:"zh-CN",format:"yyyy-mm",todayBtn:"linked",startView:3,minView:3,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0});$(c).on("click touchend",".amp-date-selector .amp-date-selector-prev",function(q){q.stopPropagation();q.preventDefault();var r=$(this).closest(".amp-date-selector").find("input").val();var n=parseInt(r.split("-")[0]);var p=parseInt(r.split("-")[1]);p--;var m=new Date();m.setFullYear(n);m.setMonth(p-1);var o="";if(m.getMonth()+1<10){o="0"+(m.getMonth()+1)}else{o=(m.getMonth()+1)}$(this).closest(".amp-date-selector").find("input").val(m.getFullYear()+"-"+o);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")});$(c).on("click touchend",".amp-date-selector .amp-date-selector-next",function(q){q.stopPropagation();q.preventDefault();var r=$(this).closest(".amp-date-selector").find("input").val();var n=parseInt(r.split("-")[0]);var p=parseInt(r.split("-")[1]);p++;var m=new Date();m.setFullYear(n);m.setMonth(p-1);var o="";if(m.getMonth()+1<10){o="0"+(m.getMonth()+1)}else{o=(m.getMonth()+1)}$(this).closest(".amp-date-selector").find("input").val(m.getFullYear()+"-"+o);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")})}function h(){}function e(){$(c).find(".amp-datetimepicker input").datetimepicker("remove")}function f(){b();h()}f()}]);ampApp.controller("rent-main-controller",["$scope","$http","$rootScope",function(m,h,j){m.records=[];m.saleRatePie=[];m.squareRatePie=[];m.rentList=[];m.investmentList=[];m.collapseTable=[];function q(r){m.records=r.records;m.saleRatePie=r.saleRatePie;m.squareRatePie=r.squareRatePie;m.rentList=r.rentList;m.investmentList=r.investmentList;m.collapseTable=r.collapseTable;m.hasRentedSquare=parseFloat(m.collapseTable[m.collapseTable.length-1].rentSquare);m.notRentedSquare=parseFloat(m.collapseTable[m.collapseTable.length-1].totalRentSquare)-parseFloat(m.collapseTable[m.collapseTable.length-1].rentSquare);m.rentContractCount=parseFloat(m.collapseTable[m.collapseTable.length-1].rentCount)}m.$on("$destroy",function(){k()});var b=null;var a=null;function e(){b=$("#rent-main");if(isPC()){a=$(b).find(".dept-table-head").pin({containerSelector:$(b).find(".rent-main-pin-wrapper"),padding:{top:44,bottom:50}})}l();o();c();f()}function d(){b.on("click",".collapse-btn",function(s){s.stopPropagation();s.preventDefault();var r=$(this).attr("data-group");$(b).find("tr[data-group="+r+"]:not(.parent-record)").toggleClass("amp-display-hide");$(this).toggleClass("collapsed")});b.on("click",".assets-table.amp-table-2 tr:not(.parent-record) td:first-child",function(s){s.stopPropagation();s.preventDefault();var r=$(this).attr("data-type");if(r=="餐饮"){r="catering"}else{if(r=="配套"){r="mating"}else{if(r=="服装"){r="clothing"}else{if(r=="儿童"){r="children"}else{if(r=="影院"){r="cinema"}else{return}}}}}globalStorage.setSessionData("select_commercial_type",r);window.location="#/business_merchant_list"})}function k(){}var p=["#0389db","#00b1f0","#2bdadb","#f3f3f3","#a6ed66","#dcf8a1","#47e6a7","#3d4d5f"];function l(){var r=$(b).find(".rent-income-percent-pie-chart .amp-chart-content");var s=echarts.init(r[0]);var t={color:p,tooltip:{show:true,formatter:"{b} : {d}%"},series:[{type:"pie",radius:["70px","100px"],avoidLabelOverlap:false,label:{normal:{show:false}},startAngle:90,data:m.saleRatePie,hoverAnimation:false}]};s.setOption(t);r.append("<div class='pie-text'>收入占比<br/>(租金收入)</div>")}function o(){var r=$(b).find(".square-percent-pie-chart .amp-chart-content");var s=echarts.init(r[0]);var t={color:p,tooltip:{show:true,formatter:"{b} : {d}%"},series:[{type:"pie",radius:["70px","100px"],avoidLabelOverlap:false,label:{normal:{show:false}},startAngle:90,data:m.squareRatePie,hoverAnimation:false}]};s.setOption(t);r.append("<div class='pie-text'>面积占比<br/>(计租面积)</div>")}function c(){var r=$(b).find(".lease-expired-bar-chart .amp-chart-content");var s=echarts.init(r[0]);var t={color:["#5cd4f4","#5ab46d"],grid:{top:"40",left:"0",right:"0",bottom:"40",containLabel:false},xAxis:[{type:"category",data:["2016","2017","2018","2019","2020","2020后"],axisLine:{show:true,lineStyle:{color:"#dee6eb"}},axisTick:{show:false},splitLine:{show:false},axisLabel:{show:true,textStyle:{color:"#8592a3"}}}],yAxis:[{type:"value",axisTick:{show:false},axisLine:{show:false},axisLabel:{show:false},splitLine:{show:false}}],series:[{label:{normal:{show:true,position:"top",textStyle:{color:"#373c42"}}},name:"租金",type:"bar",barWidth:20,data:[parseInt(1777/10000),parseInt(157771/10000),parseInt(5248804/10000),parseInt(18017489/10000),parseInt(38174069/10000),parseInt(17235143/10000)]},{label:{normal:{show:true,position:"top",textStyle:{color:"#373c42"}}},name:"面积",type:"bar",barWidth:20,data:[2029,47,2343,9149,24203,17467]}]};s.setOption(t)}function f(){var t={grid:{top:"40",left:"50",right:"20",bottom:"40",containLabel:false},xAxis:[{boundaryGap:false,type:"category",data:[" ","7月","8月","9月","10月","11月","12月"],axisTick:{show:false},axisLine:{show:false},splitLine:{show:true,lineStyle:{color:"#eaeaea"}},axisLabel:{textStyle:{fontSize:14}}}],yAxis:[{max:500,type:"value",axisTick:{show:false,alignWithLabel:true},axisLine:{show:false},splitLine:{show:true,lineStyle:{color:"#eaeaea"}},axisLabel:{formatter:function(u){if(u==0){return""}return(u+"").replace(/\d{1,3}(?=(\d{3})+(\.\d*)?$)/g,"$&,")},textStyle:{fontSize:14}}}],series:[{type:"line",symbolSize:6,lineStyle:{normal:{color:"#5ab46e"}},itemStyle:{normal:{color:"#5ab46e",borderWidth:2}},data:[,160,250,220,350,380]},{type:"line",symbolSize:6,lineStyle:{normal:{color:"#5ab46e",type:"dashed"}},itemStyle:{normal:{color:"#5ab46e",borderWidth:2}},data:[,,,,,380,360]},{type:"line",silent:true,tooltip:{show:false},data:[],markLine:{symbol:"circle",silent:true,symbolSize:5,label:{normal:{show:true,position:"middle",formatter:"{b}"}},lineStyle:{normal:{color:"#8493a3",width:1,type:"solid"}},data:[[{name:"7月平均线",coord:[1,200]},{coord:[2,200]}],[{name:"8月平均线",coord:[2,300]},{coord:[3,300]}],[{name:"9月平均线",coord:[3,200]},{coord:[4,200]}],[{name:"10月平均线",coord:[4,300]},{coord:[5,300]}],[{name:"11月平均线",coord:[5,400]},{coord:[6,400]}]]}}]};var r=$(b).find(".investment-line-chart .amp-chart-content");var s=echarts.init(r[0]);s.setOption(t)}function n(){var r=j.curProject;var s="../static/js/mgt_analysis/data/"+r+"/rent_main_data.json";h.get(s).success(function(t){q(t);e();d()})}setTimeout(function(){n()},300)}]);ampApp.controller("rent-main-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#rent-main-left");amp_main.leftPanel_update();var j=new Date();var k=j.getFullYear();var l=j.getMonth()+1;if(l<10){l="0"+l}$(c).find(".amp-date-selector input").val(k+"-"+l);$(c).find(".amp-date-selector input").datetimepicker({language:"zh-CN",format:"yyyy-mm",todayBtn:"linked",startView:3,minView:3,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0})}function h(){$(c).on("click touchend",".amp-date-selector .amp-date-selector-prev",function(n){n.stopPropagation();n.preventDefault();var o=$(this).closest(".amp-date-selector").find("input").val();var k=parseInt(o.split("-")[0]);var m=parseInt(o.split("-")[1]);m--;var j=new Date();j.setFullYear(k);j.setMonth(m-1);var l="";if(j.getMonth()+1<10){l="0"+(j.getMonth()+1)}else{l=(j.getMonth()+1)}$(this).closest(".amp-date-selector").find("input").val(j.getFullYear()+"-"+l);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")});$(c).on("click touchend",".amp-date-selector .amp-date-selector-next",function(n){n.stopPropagation();n.preventDefault();var o=$(this).closest(".amp-date-selector").find("input").val();var k=parseInt(o.split("-")[0]);var m=parseInt(o.split("-")[1]);m++;var j=new Date();j.setFullYear(k);j.setMonth(m-1);var l="";if(j.getMonth()+1<10){l="0"+(j.getMonth()+1)}else{l=(j.getMonth()+1)}$(this).closest(".amp-date-selector").find("input").val(j.getFullYear()+"-"+l);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")})}function e(){$(c).find(".amp-datetimepicker input").datetimepicker("remove")}function f(){b();h()}f()}]);ampApp.controller("arrears-main-controller",["$scope","$http","$rootScope",function(h,d,e){h.records=[];function k(l){h.records=l}h.$on("$destroy",function(){f()});var a=null;function c(){a=$("#arrears-main")}function b(){}function f(){}function j(){var l=e.curProject;var m="../static/js/mgt_analysis/data/"+l+"/arrears_main_data.json";d.get(m).success(function(n){k(n);c();b()})}j()}]);ampApp.controller("arrears-main-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#arrears-main-left");amp_main.leftPanel_update();f();$(c).find(".amp-date-selector input").datetimepicker({language:"zh-CN",format:"yyyy-mm",todayBtn:"linked",startView:3,minView:3,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0})}function j(){c.on("click touchend","a.arrears-detail-btn",function(k){k.stopPropagation();k.preventDefault();window.location="#/arrears_detail"});$(c).on("click touchend",".amp-date-selector .amp-date-selector-prev",function(o){o.stopPropagation();o.preventDefault();var p=$(this).closest(".amp-date-selector").find("input").val();var l=parseInt(p.split("-")[0]);var n=parseInt(p.split("-")[1]);n--;var k=new Date();k.setFullYear(l);k.setMonth(n-1);var m="";if(k.getMonth()+1<10){m="0"+(k.getMonth()+1)}else{m=(k.getMonth()+1)}$(this).closest(".amp-date-selector").find("input").val(k.getFullYear()+"-"+m);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")});$(c).on("click touchend",".amp-date-selector .amp-date-selector-next",function(o){o.stopPropagation();o.preventDefault();var p=$(this).closest(".amp-date-selector").find("input").val();var l=parseInt(p.split("-")[0]);var n=parseInt(p.split("-")[1]);n++;var k=new Date();k.setFullYear(l);k.setMonth(n-1);var m="";if(k.getMonth()+1<10){m="0"+(k.getMonth()+1)}else{m=(k.getMonth()+1)}$(this).closest(".amp-date-selector").find("input").val(k.getFullYear()+"-"+m);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")});$(c).on("click touchend","a.reset-btn",function(k){k.stopPropagation();k.preventDefault();f();$(c).find(".amp-date-selector").find("input").datetimepicker("update")})}function e(){$(c).find(".amp-date-selector input").datetimepicker("remove")}function f(){$(c).find(".amp-select input").val("全部");var k=new Date();var l=k.getFullYear();var m=k.getMonth()+1;if(m<10){m="0"+m}$(c).find(".amp-date-selector input").val(l+"-"+m);c.find(".amp-select li").removeClass("active")}function h(){b();j()}h()}]);ampApp.controller("arrears-detail-controller",["$scope","getPaginationResultFactory","$http","$rootScope",function(k,j,e,f){k.records=[];k.totalCount=null;k.paginationInfo={pageNo:null,pageCount:null,recordCount:null,pageSize:null,records:[]};k.fetchData=function(){k.paginationInfo=j(k.paginationInfo.pageNo,k.paginationInfo.pageSize,k.records);k.$apply()};function m(p){k.records=p;var o=0;p.forEach(function(r){var s=r.arrearsTotalAmount;if(!isNaN(s)){o+=parseFloat(s)}});k.totalCount=o;var q=1;var n=10;k.paginationInfo=j(q,n,k.records)}k.$on("$destroy",function(){h()});k.$on("arrears-detail.save-record",function(n,o){k.records.unshift(o);k.paginationInfo=j(k.paginationInfo.pageNo,k.paginationInfo.pageSize,k.records);k.$apply()});var b=null;var a=null;function d(){b=$("#arrears-detail");if(isPC()){a=$(b).find(".amp-thead").pin({containerSelector:$(b).find(".amp-collapse-table"),padding:{top:44,bottom:50}})}}function c(){b.on("click",".amp-table-row-content",function(p){p.stopPropagation();p.preventDefault();var o=$(this).attr("data-merchant-name");var q=$(this).attr("data-arrears-total-amount");var n=$(this).attr("data-deposit");globalStorage.setSessionData("arrears_merchant_name",o);globalStorage.setSessionData("arrears_merchant_amount",q);globalStorage.setSessionData("arrears_merchant_deposit",n);window.location="#/arrears_merchant_detail"})}function h(){}function l(){var n=f.curProject;var o="../static/js/mgt_analysis/data/"+n+"/arrears_detail_data.json";e.get(o).success(function(p){m(p);d();c()})}l()}]);ampApp.controller("arrears-detail-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#arrears-detail-left");amp_main.leftPanel_update()}function h(){c.on("click touchend","a.enrolment-btn",function(j){j.stopPropagation();j.preventDefault();a.$broadcast("arrears-detail.enrolment")})}function e(){}function f(){b();h()}f()}]);ampApp.controller("arrears-enrolment-controller",["$scope","$rootScope",function(j,f){j.$on("$destroy",function(){h()});j.$on("arrears-detail.enrolment",function(){b.removeClass("amp-display-hide");b.find(".contract-enrolment").addClass("amp-animated").addClass("amp-slide-left-in");a()});var b=null;function e(){b=$("#arrears-enrolment")}function c(){$(b).find(".amp-datetimepicker input").datetimepicker({language:"zh-CN",format:"yyyy-mm-dd",todayBtn:"linked",startView:2,minView:2,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0});$(b).find(".amp-datetimepicker").on("click",function(m){m.stopPropagation();m.preventDefault();$(this).closest(".amp-datetimepicker").find("input").datetimepicker("show")});b.find(".contract-enrolment").on("webkitAnimationEnd animationend",function(){if($(this).hasClass("amp-slide-right-out")){b.addClass("amp-display-hide");d()}$(this).removeClass("amp-slide-right-out");$(this).removeClass("amp-slide-left-in")});b.on("click","a.close-panel-btn",function(m){m.stopPropagation();m.preventDefault();b.find(".contract-enrolment").addClass("amp-slide-right-out");a()});function l(){var u=$(b).find("[data-name=merchantName]").val();var v=$(b).find("[data-name=receivableDate]").val();var m=$(b).find("[data-name=arrearsTotalAmount]").val();var p=$(b).find("[data-name=arrearsType]").val();var n=new Date();var r=n.getFullYear();var t=n.getMonth()+1;var q=parseInt(v.split("-")[0]);var o=parseInt(v.split("-")[1]);var s=(q-r)*12+o-t;if(s<0){s=0}if(isNaN(s)){s="-"}return{merchantName:u,arrearsTotalAmount:m,deposit:"-",depositRate:"-",crashStoreRate:"-",dateItem1:"-",dateItem2:"-",dateItem3:"-",dateItem4:"-",rentAmount:"-",contractLeaveMonth:s}}b.on("click","a.save-btn",function(m){m.stopPropagation();m.preventDefault();if(!validateAmpInputCollection($(b).find("[amp-input-validate]"))){return}f.$broadcast("arrears-detail.save-record",l());j.$apply();b.find(".contract-enrolment").addClass("amp-slide-right-out")});b.on("click","a.continue-save-btn",function(m){m.stopPropagation();m.preventDefault();if(!validateAmpInputCollection($(b).find("[amp-input-validate]"))){return}f.$broadcast("arrears-detail.save-record",l());j.$apply();d()});b.on("change",".amp-input[amp-input-validate] input",function(m){m.stopPropagation();m.preventDefault();validateAmpInputCollection($(this).parent())})}function a(){setTimeout(function(){if(b.find(".contract-enrolment").hasClass("amp-slide-right-out")){b.addClass("amp-display-hide");d()}b.find(".contract-enrolment").removeClass("amp-slide-right-out");b.find(".contract-enrolment").removeClass("amp-slide-left-in")},500)}function h(){$(b).find(".amp-datetimepicker input").datetimepicker("remove")}function d(){$(b).find("[data-name]").val("");$(b).find(".amp-input-error").removeClass("amp-input-error")}function k(){e();c()}k()}]);ampApp.controller("arrears-merchant-detail-controller",["$scope","getPaginationResultFactory","$filter","$rootScope","$http",function(n,l,e,h,f){var k=globalStorage.getSessionData("arrears_merchant_name");var b=globalStorage.getSessionData("arrears_merchant_amount");var o=globalStorage.getSessionData("arrears_merchant_deposit");var m={merchantName:k};n.records=[];n.filteredRecords=[];n.merchantName=k;n.arrearsTotalAmount=b;n.deposit=o;n.arrearsCount=null;n.paginationInfo={pageNo:null,pageCount:null,recordCount:null,pageSize:null,records:[]};n.fetchData=function(){n.paginationInfo=l(n.paginationInfo.pageNo,n.paginationInfo.pageSize,n.filteredRecords);n.$apply()};function q(s){n.records=s;n.filteredRecords=e("filter")(n.records,m);n.arrearsCount=n.filteredRecords.length;var t=1;var r=10;n.paginationInfo=l(t,r,n.filteredRecords)}n.$on("$destroy",function(){j()});n.$on("arrears-merchant-detail.query",function(r,s){m=s;m.merchantName=k;n.filteredRecords=e("filter")(n.records,m);n.paginationInfo=l(n.paginationInfo.pageNo,n.paginationInfo.pageSize,n.filteredRecords);n.$apply()});n.$on("arrears-merchant-detail.received",function(r,t){var s=[];a.find(".amp-checkbox.checked").each(function(){var u=$(this).next().html();s.push(u)});n.records=n.records.filter(function(v){for(var u=0;u<s.length;u++){if(v.arrearsType==s[u]){return false}}return true});n.filteredRecords=e("filter")(n.records,m);n.paginationInfo=l(n.paginationInfo.pageNo,n.paginationInfo.pageSize,n.filteredRecords);n.$apply()});var a=null;function d(){a=$("#arrears-merchant-detail")}function c(){a.on("click",".amp-checkbox",function(r){r.stopPropagation();r.preventDefault();$(this).toggleClass("checked");var s=[];a.find(".amp-checkbox.checked").each(function(){var t=$(this).next().html();var u=parseFloat($(this).parent().next().attr("data-value"));s.push({arrearsType:t,arrearsAmount:u})});h.$broadcast("arrears-merchant-detail.select",s)})}function j(){}function p(){var r=h.curProject;var s="../static/js/mgt_analysis/data/"+r+"/arrears_merchant_detail_data.json";f.get(s).success(function(t){q(t);d();c()})}p()}]);ampApp.controller("arrears-merchant-detail-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#arrears-merchant-detail-left");amp_main.leftPanel_update()}function h(){c.on("click touchend","a.receive-confirmation-btn",function(j){j.stopPropagation();j.preventDefault();a.$broadcast("arrears-merchant-detail.receive")});c.on("click touchend",".arrears-type-select ul li",function(k){k.preventDefault();var j=$(this).html();if(j=="全部"){j=""}a.$broadcast("arrears-merchant-detail.query",{arrearsType:j})})}function e(){}function f(){b();h()}f()}]);ampApp.controller("arrears-merchant-detail-receiving-controller",["$scope","$rootScope",function(k,f){k.records=d([]);var h=globalStorage.getSessionData("arrears_merchant_name");k.merchantName=h;d();function d(m){m=m||[];var n=0;m.forEach(function(p){var o=parseFloat(p.arrearsAmount);n+=o});m.push({arrearsType:"合计",arrearsAmount:n});return m}k.$on("$destroy",function(){j()});k.$on("arrears-merchant-detail.select",function(m,n){k.records=d(n);k.$apply()});k.$on("arrears-merchant-detail.receive",function(){b.removeClass("amp-display-hide");b.find(".contract-enrolment").addClass("amp-animated").addClass("amp-slide-left-in");a()});var b=null;function e(){b=$("#arrears-merchant-detail-receiving")}function c(){b.find(".contract-enrolment").on("webkitAnimationEnd animationend",function(){if($(this).hasClass("amp-slide-right-out")){b.addClass("amp-display-hide")}$(this).removeClass("amp-slide-right-out");$(this).removeClass("amp-slide-left-in")});b.on("click","a.close-panel-btn",function(m){m.stopPropagation();m.preventDefault();b.find(".contract-enrolment").addClass("amp-slide-right-out");a()});b.on("click","a.receive-btn",function(m){m.stopPropagation();m.preventDefault();b.find(".contract-enrolment").addClass("amp-slide-right-out");f.$broadcast("arrears-merchant-detail.received");k.records=[];k.$apply()})}function j(){}function a(){setTimeout(function(){if(b.find(".contract-enrolment").hasClass("amp-slide-right-out")){b.addClass("amp-display-hide")}b.find(".contract-enrolment").removeClass("amp-slide-right-out");b.find(".contract-enrolment").removeClass("amp-slide-left-in")},500)}function l(){e();c()}l()}]);ampApp.controller("shop-sale-type-list-controller",["$scope","getPaginationResultFactory","$http","$rootScope",function(k,j,d,e){var h=globalStorage.getSessionData("select_commercial_type_for_sale");k.commercialTypeSummary={};k.commercialType=null;k.records=[];k.paginationInfo={pageNo:null,pageCount:null,recordCount:null,pageSize:null,records:[]};k.fetchData=function(){k.paginationInfo=j(k.paginationInfo.pageNo,k.paginationInfo.pageSize,k.records);k.$apply()};function m(o){k.records=o.allData[h];k.commercialTypeSummary=o.allCommercialTypeSummary[h];k.commercialType=o.allType[h];var p=1;var n=10;console.log(h);console.log(o.allData);k.paginationInfo=j(p,n,k.records)}k.$on("$destroy",function(){f()});k.$on("shop-sale-type.save-record",function(n,o){k.records.unshift(o);k.paginationInfo=j(k.paginationInfo.pageNo,k.paginationInfo.pageSize,k.records);k.$apply()});var a=null;function c(){a=$("#shop-sale-type-list")}function b(){}function f(){}function l(){var n=e.curProject;var o="../static/js/mgt_analysis/data/"+n+"/shop_sale_type_list_data.json";d.get(o).success(function(p){m(p);c();b()})}l()}]);ampApp.controller("shop-sale-type-list-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#shop-sale-type-list-left");amp_main.leftPanel_update();f();$(c).find(".amp-date-selector input").datetimepicker({language:"zh-CN",format:"yyyy-mm",todayBtn:"linked",startView:3,minView:3,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0})}function j(){$(c).on("click touchend",".amp-date-selector .amp-date-selector-prev",function(o){o.stopPropagation();o.preventDefault();var p=$(this).closest(".amp-date-selector").find("input").val();var l=parseInt(p.split("-")[0]);var n=parseInt(p.split("-")[1]);n--;var k=new Date();k.setFullYear(l);k.setMonth(n-1);var m="";if(k.getMonth()+1<10){m="0"+(k.getMonth()+1)}else{m=(k.getMonth()+1)}$(this).closest(".amp-date-selector").find("input").val(k.getFullYear()+"-"+m);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")});$(c).on("click touchend",".amp-date-selector .amp-date-selector-next",function(o){o.stopPropagation();o.preventDefault();var p=$(this).closest(".amp-date-selector").find("input").val();var l=parseInt(p.split("-")[0]);var n=parseInt(p.split("-")[1]);n++;var k=new Date();k.setFullYear(l);k.setMonth(n-1);var m="";if(k.getMonth()+1<10){m="0"+(k.getMonth()+1)}else{m=(k.getMonth()+1)}$(this).closest(".amp-date-selector").find("input").val(k.getFullYear()+"-"+m);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")});c.on("click touchend","a.reset-btn",function(k){k.stopPropagation();k.preventDefault();f();$(c).find(".amp-date-selector").find("input").datetimepicker("update")});c.on("click touchend","a.enrolment-btn",function(k){k.stopPropagation();k.preventDefault();a.$broadcast("shop-sale-type.enrolment")})}function e(){$(c).find(".amp-datetimepicker input").datetimepicker("remove")}function f(){$(c).find(".amp-select input").val("全部");var k=new Date();var l=k.getFullYear();var m=k.getMonth()+1;if(m<10){m="0"+m}$(c).find(".amp-date-selector input").val(l+"-"+m);$(c).find("[data-name=commercial-type]").val("全部");c.find(".amp-select li").removeClass("active")}function h(){b();j()}h()}]);ampApp.controller("shop-sale-type-enrolment-controller",["$scope","$rootScope",function(j,f){j.$on("$destroy",function(){h()});j.$on("shop-sale-type.enrolment",function(){b.removeClass("amp-display-hide");b.find(".contract-enrolment").addClass("amp-animated").addClass("amp-slide-left-in");a()});var b=null;function e(){b=$("#shop-sale-type-enrolment")}function c(){b.find(".contract-enrolment").on("webkitAnimationEnd animationend",function(){if($(this).hasClass("amp-slide-right-out")){b.addClass("amp-display-hide");d()}$(this).removeClass("amp-slide-right-out");$(this).removeClass("amp-slide-left-in")});b.on("click","a.close-panel-btn",function(m){m.stopPropagation();m.preventDefault();b.find(".contract-enrolment").addClass("amp-slide-right-out");a()});function l(){var o=$(b).find("[data-name=brandName]").val();var m=$(b).find("[data-name=saleAmount]").val();var n=$(b).find("[data-name=performanceValue]").val();var p=$(b).find("[data-name=rentSaleRate]").val();return{brandName:o,saleAmount:m,performanceValue:n,rentSaleRate:p}}b.on("click","a.save-btn",function(m){m.stopPropagation();m.preventDefault();if(!validateAmpInputCollection($(b).find("[amp-input-validate]"))){return}f.$broadcast("shop-sale-type.save-record",l());j.$apply();b.find(".contract-enrolment").addClass("amp-slide-right-out")});b.on("click","a.continue-save-btn",function(m){m.stopPropagation();m.preventDefault();if(!validateAmpInputCollection($(b).find("[amp-input-validate]"))){return}f.$broadcast("shop-sale-type.save-record",l());j.$apply();d()});b.on("change",".amp-input[amp-input-validate] input",function(m){m.stopPropagation();m.preventDefault();validateAmpInputCollection($(this).parent())})}function h(){}function a(){setTimeout(function(){if(b.find(".contract-enrolment").hasClass("amp-slide-right-out")){b.addClass("amp-display-hide");d()}b.find(".contract-enrolment").removeClass("amp-slide-right-out");b.find(".contract-enrolment").removeClass("amp-slide-left-in")},500)}function d(){$(b).find("[data-name]").val("");$(b).find(".amp-input-error").removeClass("amp-input-error")}function k(){e();c()}k()}]);ampApp.controller("shop-sale-rank-controller",["$scope","$http","$rootScope",function(n,k,l){var h={};var d={};var f={};var b={};var a={};function p(q){h=q.commercialDataAll;d=q.commercialDataCatering;f=q.commercialDataChildren;b=q.commercialDataClothing;a=q.commercialDataMating;n.records=h}n.$on("$destroy",function(){m()});var c=null;function j(){c=$("#shop-sale-rank")}function e(){c.on("click",".commercial-item a[data-href]",function(s){s.stopPropagation();s.preventDefault();var r=$(this).attr("data-href");var q=n.records;if(r=="all"){n.records=h}else{if(r=="catering"){n.records=d}else{if(r=="children"){n.records=f}else{if(r=="clothing"){n.records=b}else{if(r=="mating"){n.records=a}}}}}if(n.records==null){n.records=q}else{$(this).closest(".commercial-item-list").find("a").removeClass("active");$(this).addClass("active")}n.$apply()})}function m(){}function o(){var q=l.curProject;var r="../static/js/mgt_analysis/data/"+q+"/shop_sale_rank_data.json";k.get(r).success(function(s){p(s);j();e()})}o()}]);ampApp.controller("business-main-controller",["$scope","$filter","$http","$rootScope",function(n,h,j,k){var f=[];var m=[];n.records=f;n.dataType="租金";function p(q){f=q.rentData;m=q.propertyData;n.records=f;n.dataType="租金"}n.$on("business-main.query",function(q,r){if(r.businessType=="租金"){n.records=f}else{if(r.businessType=="物管费"){n.records=m}}n.dataType=r.businessType;d();n.$apply()});n.$on("$destroy",function(){l()});var b=null;var a=null;function e(){b=$("#business-main");d();if(isPC()){a=$(b).find(".dept-table-head").pin({containerSelector:$(b).find(".cost-manual-work-pin-wrapper"),padding:{top:44,bottom:50}})}}function c(){b.on("click",".collapse-btn",function(r){r.stopPropagation();r.preventDefault();var q=$(this).attr("data-group");$(b).find("tr[data-group="+q+"]:not(.parent-record)").toggleClass("amp-display-hide");$(this).toggleClass("collapsed")});b.on("click",".table-block tbody tr:not(.parent-record,.empty-record) td:first-child",function(r){r.stopPropagation();r.preventDefault();var q=$(this).attr("data-type");if(q=="餐饮"){q="catering"}else{if(q=="配套"){q="mating"}else{if(q=="服装"){q="clothing"}else{if(q=="儿童"){q="children"}else{if(q=="影院"){q="cinema"}else{return}}}}}globalStorage.setSessionData("select_commercial_type",q);window.location="#/business_merchant_list"})}function l(){}function d(){var u="rent-income-bar-chart";var q=echarts.init(document.getElementById(u));var t=[];var s=[];n.records.forEach(function(v){if(v.hide==true){t.push(v.commercialType);s.push(v.curOfficialReceipts)}});var r={color:["#5ab46e"],grid:{top:"20",left:"0",right:"0",bottom:"0",containLabel:true},tooltip:{show:true,formatter:function(v){return v.name+" : "+h("numberFormatDefault")(v.value,2)}},xAxis:[{type:"category",data:t,axisLine:{show:false},axisTick:{show:false},splitLine:{show:false}}],yAxis:[{type:"value",axisTick:{show:false},axisLine:{show:false},splitNumber:3}],series:[{name:"实际收入",type:"bar",barWidth:24,data:s}]};q.setOption(r)}function o(){var q=k.curProject;var r="../static/js/mgt_analysis/data/"+q+"/business_main_data.json";j.get(r).success(function(s){p(s);e();c()})}setTimeout(function(){o()},300)}]);ampApp.controller("business-main-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#business-main-left");amp_main.leftPanel_update()}function j(){c.on("click touchend","a.reset-btn",function(k){k.stopPropagation();k.preventDefault();f()});c.on("click touchend","a.search-btn",function(k){k.stopPropagation();k.preventDefault();var l=$(c).find("[data-name=business-type]").val();a.$broadcast("business-main.query",{businessType:l})})}function e(){}function f(){$(c).find("[data-name=business-type]").val("租金");$(c).find("[data-name=commercial-type]").val("全部");$(c).find("[data-name=income-type]").val("全部");c.find(".amp-select li").removeClass("active")}function h(){b();j()}h()}]);ampApp.controller("business-merchant-list-controller",["$scope","$filter","$http","$rootScope","getPaginationResultFactory",function(l,d,e,f,j){l.commercialType=null;l.records=[];l.filteredRecords=[];var o=globalStorage.getSessionData("select_commercial_type");var k={brandName:"",storeNo:""};l.paginationInfo={pageNo:null,pageCount:null,recordCount:null,pageSize:null,records:[]};l.fetchData=function(){l.paginationInfo=j(l.paginationInfo.pageNo,l.paginationInfo.pageSize,l.filteredRecords);l.$apply()};function n(q){l.commercialType=q.allType[o];l.records=q.allData[o];l.filteredRecords=d("filter")(l.records,k);var r=1;var p=10;l.paginationInfo=j(r,p,l.filteredRecords)}l.$on("$destroy",function(){h()});l.$on("business-merchant-list.search",function(p,q){k=q;l.filteredRecords=d("filter")(l.records,k);l.paginationInfo=j(l.paginationInfo.pageNo,l.paginationInfo.pageSize,l.filteredRecords);l.$apply()});var a=null;function c(){a=$("#business-merchant-list");if(isPC()){$(a).find(".amp-thead").pin({containerSelector:$(a).find(".amp-collapse-table"),padding:{top:44,bottom:50}})}}function b(){a.on("click","ul.amp-table-row-content",function(q){q.stopPropagation();q.preventDefault();var p=$(this).find("li:first-child").html();globalStorage.setSessionData("selected_merchant_name",p);window.location="#/business_merchant_detail"})}function h(){}function m(){var p=f.curProject;var q="../static/js/mgt_analysis/data/"+p+"/business_merchant_list_data.json";e.get(q).success(function(r){n(r);c();b()})}m()}]);ampApp.controller("business-merchant-list-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#business-merchant-list-left");amp_main.leftPanel_update()}function h(){c.on("click touchend","a.reset-btn",function(j){j.stopPropagation();j.preventDefault();c.find("input").val("")});c.on("click touchend","a.search-btn",function(l){l.stopPropagation();l.preventDefault();var k=$(c).find("[data-name=brandName]").val();var j=$(c).find("[data-name=storeNo]").val();a.$broadcast("business-merchant-list.search",{brandName:k,storeNo:j})})}function e(){}function f(){b();h()}f()}]);ampApp.controller("business-merchant-detail-controller",["$scope","getPaginationResultFactory","$filter","$http","$rootScope",function(m,l,e,f,h){var p=globalStorage.getSessionData("select_commercial_type");var k=globalStorage.getSessionData("selected_merchant_name");m.records=[];m.merchantName=k;m.commercialType=null;m.merchantSummary={contractStartTime:null,rentPeriod:null,rentType:null};m.paginationInfo={pageNo:null,pageCount:null,recordCount:null,pageSize:null,records:[]};m.fetchData=function(){m.paginationInfo=l(m.paginationInfo.pageNo,m.paginationInfo.pageSize,m.records);m.$apply()};function o(s){m.records=e("filter")(s.initData,{merchantName:k});m.merchantName=k;m.commercialType=s.allType[p];var q=e("filter")(s.merchantSummaryList,{merchantName:k});if(q.length>0){m.merchantSummary=q[0]}var t=1;var r=10;m.paginationInfo=l(t,r,m.records)}m.$on("$destroy",function(){j()});m.$on("business-merchant-detail-enrolment.save-record",function(q,r){m.records.unshift(r);m.paginationInfo=l(m.paginationInfo.pageNo,m.paginationInfo.pageSize,m.records);m.$apply()});var b=null;var a=null;function d(){b=$("#business-merchant-detail");if(isPC()){a=$(b).find(".dept-table-head").pin({containerSelector:$(b).find(".ys-table-block"),padding:{top:44,bottom:50}})}}function c(){}function j(){}function n(){var q=h.curProject;var r="../static/js/mgt_analysis/data/"+q+"/business_merchant_detail_data.json";f.get(r).success(function(s){o(s);d();c()})}n()}]);ampApp.controller("business-merchant-detail-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#business-merchant-detail-left");amp_main.leftPanel_update()}function j(){c.on("click touchend","a.enrolment-btn",function(k){k.stopPropagation();k.preventDefault();a.$broadcast("business-merchant-detail.enrolment")})}function e(){}function f(){$(c).find("[data-name=business-type]").val("租金");$(c).find("[data-name=commercial-type]").val("全部");$(c).find("[data-name=income-type]").val("全部")}function h(){b();j()}h()}]);ampApp.controller("business-merchant-detail-enrolment-controller",["$scope","$rootScope",function(j,f){j.$on("$destroy",function(){h()});j.$on("business-merchant-detail.enrolment",function(){b.removeClass("amp-display-hide");b.find(".contract-enrolment").addClass("amp-animated").addClass("amp-slide-left-in");a()});var b=null;function e(){b=$("#business-merchant-detail-enrolment")}function c(){$(b).find(".amp-datetimepicker input").datetimepicker({language:"zh-CN",format:"yyyy-mm",todayBtn:"linked",startView:3,minView:3,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0});$(b).find(".amp-datetimepicker").on("click",function(l){l.stopPropagation();l.preventDefault();$(this).closest(".amp-datetimepicker").find("input").datetimepicker("show")});b.find(".contract-enrolment").on("webkitAnimationEnd animationend",function(){if($(this).hasClass("amp-slide-right-out")){b.addClass("amp-display-hide");d()}$(this).removeClass("amp-slide-right-out");$(this).removeClass("amp-slide-left-in")});b.on("click","a.close-panel-btn",function(l){l.stopPropagation();l.preventDefault();b.find(".contract-enrolment").addClass("amp-slide-right-out");a()});b.on("click","a.save-btn",function(n){n.stopPropagation();n.preventDefault();if(!validateAmpInputCollection($(b).find("[amp-input-validate]"))){return}var l={};b.find("[data-name]").each(function(){var o=$(this).attr("data-name");var p=$(this).val();l[o]=p});var m=new Date();l.chargeDate=m.getFullYear()+"-"+(m.getMonth()+1)+"-"+m.getDate();f.$broadcast("business-merchant-detail-enrolment.save-record",l);j.$apply();b.find(".contract-enrolment").addClass("amp-slide-right-out")});b.on("click","a.continue-save-btn",function(n){n.stopPropagation();n.preventDefault();if(!validateAmpInputCollection($(b).find("[amp-input-validate]"))){return}var l={};b.find("[data-name]").each(function(){var o=$(this).attr("data-name");var p=$(this).val();l[o]=p});var m=new Date();l.chargeDate=m.getFullYear()+"-"+(m.getMonth()+1)+"-"+m.getDate();f.$broadcast("business-merchant-detail-enrolment.save-record",l);j.$apply();d()});b.on("change",".amp-input[amp-input-validate] input",function(l){l.stopPropagation();l.preventDefault();validateAmpInputCollection($(this).parent())})}function h(){$(b).find(".amp-datetimepicker input").datetimepicker("remove")}function a(){setTimeout(function(){if(b.find(".contract-enrolment").hasClass("amp-slide-right-out")){b.addClass("amp-display-hide");d()}b.find(".contract-enrolment").removeClass("amp-slide-right-out");b.find(".contract-enrolment").removeClass("amp-slide-left-in")},500)}function d(){$(b).find("[data-name]").val("");$(b).find(".amp-input-error").removeClass("amp-input-error")}function k(){e();c()}k()}]);ampApp.controller("investment-detail-controller",["$scope","getPaginationResultFactory","$http","$rootScope",function(j,h,d,e){j.records=[{projectItemName:"当月签约面积",budget:2570,real:1256,rate:"20%"}];j.$on("$destroy",function(){f()});var a=null;function c(){a=$("#investment-detail")}function b(){}function f(){}function k(){c();b()}k()}]);ampApp.controller("investment-detail-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#investment-detail-left");amp_main.leftPanel_update();f();$(c).find(".amp-date-selector input").datetimepicker({language:"zh-CN",format:"yyyy-mm",todayBtn:"linked",startView:3,minView:3,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0})}function j(){$(c).on("click touchend",".amp-date-selector .amp-date-selector-prev",function(o){o.stopPropagation();o.preventDefault();var p=$(this).closest(".amp-date-selector").find("input").val();var l=parseInt(p.split("-")[0]);var n=parseInt(p.split("-")[1]);n--;var k=new Date();k.setFullYear(l);k.setMonth(n-1);var m="";if(k.getMonth()+1<10){m="0"+(k.getMonth()+1)}else{m=(k.getMonth()+1)}$(this).closest(".amp-date-selector").find("input").val(k.getFullYear()+"-"+m);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")});$(c).on("click touchend",".amp-date-selector .amp-date-selector-next",function(o){o.stopPropagation();o.preventDefault();var p=$(this).closest(".amp-date-selector").find("input").val();var l=parseInt(p.split("-")[0]);var n=parseInt(p.split("-")[1]);n++;var k=new Date();k.setFullYear(l);k.setMonth(n-1);var m="";if(k.getMonth()+1<10){m="0"+(k.getMonth()+1)}else{m=(k.getMonth()+1)}$(this).closest(".amp-date-selector").find("input").val(k.getFullYear()+"-"+m);$(this).closest(".amp-date-selector").find("input").datetimepicker("update")});c.on("click touchend","a.reset-btn",function(k){k.stopPropagation();k.preventDefault();f();$(c).find(".amp-date-selector").find("input").datetimepicker("update")});c.on("click touchend","a.enrolment-btn",function(k){k.stopPropagation();k.preventDefault();a.$broadcast("investment-detail.enrolment")})}function e(){$(c).find(".amp-datetimepicker input").datetimepicker("remove")}function f(){$(c).find(".amp-select input").val("全部");var k=new Date();var l=k.getFullYear();var m=k.getMonth()+1;if(m<10){m="0"+m}$(c).find(".amp-date-selector input").val(l+"-"+m);$(c).find("[data-name=commercial-type]").val("全部");c.find(".amp-select li").removeClass("active")}function h(){b();j()}h()}]);ampApp.controller("investment-detail-enrolment-controller",["$scope","$rootScope",function(j,f){j.record={projectItemName:null,budget:null,real:null,rate:"-"};j.$on("$destroy",function(){h()});j.$on("investment-detail.enrolment",function(){b.removeClass("amp-display-hide");b.find(".contract-enrolment").addClass("amp-animated").addClass("amp-slide-left-in");a()});var b=null;function e(){b=$("#investment-detail-enrolment")}function c(){b.find(".contract-enrolment").on("webkitAnimationEnd animationend",function(){if($(this).hasClass("amp-slide-right-out")){b.addClass("amp-display-hide");d()}$(this).removeClass("amp-slide-right-out");$(this).removeClass("amp-slide-left-in")});b.on("click","a.close-panel-btn",function(l){l.stopPropagation();l.preventDefault();b.find(".contract-enrolment").addClass("amp-slide-right-out");a()});b.on("click","a.save-btn",function(l){l.stopPropagation();l.preventDefault();b.find(".contract-enrolment").addClass("amp-slide-right-out")});b.on("click","a.continue-save-btn",function(l){l.stopPropagation();l.preventDefault();d()})}function h(){}function a(){setTimeout(function(){if(b.find(".contract-enrolment").hasClass("amp-slide-right-out")){b.addClass("amp-display-hide");d()}b.find(".contract-enrolment").removeClass("amp-slide-right-out");b.find(".contract-enrolment").removeClass("amp-slide-left-in")},500)}function d(){$(b).find("[data-name]").val("");$(b).find(".amp-input-error").removeClass("amp-input-error")}function k(){e();c()}k()}]);ampApp.controller("floor-mgt-controller",["$scope","$filter","$http","$rootScope","getPaginationResultFactory",function(k,d,e,f,j){k.records=[{floorNo:"5F",floorName:"5层"},{floorNo:"4F",floorName:"4层"},{floorNo:"3F",floorName:"3层"},{floorNo:"2F",floorName:"2层"},{floorNo:"1F",floorName:"1层"}];k.$on("$destroy",function(){h()});var a=null;function c(){a=$("#contract-main")}function b(){}function h(){}function l(){c();b()}l()}]);ampApp.controller("floor-mgt-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#floor-mgt-left")}function h(){c.on("click touchend","a.enrolment-btn",function(j){j.stopPropagation();j.preventDefault();a.$broadcast("floor-mgt.enrolment")})}function e(){}function f(){b();h()}f()}]);ampApp.controller("floor-mgt-enrolment-controller",["$scope","$rootScope",function(j,f){j.$on("$destroy",function(){h()});j.$on("floor-mgt.enrolment",function(){b.removeClass("amp-display-hide");b.find(".contract-enrolment").addClass("amp-animated").addClass("amp-slide-left-in");a()});var b=null;function e(){b=$("#floor-mgt-enrolment")}function c(){b.on("click","a.close-panel-btn",function(l){l.stopPropagation();l.preventDefault();b.find(".contract-enrolment").addClass("amp-slide-right-out");a()});b.on("click","a.save-btn",function(l){l.stopPropagation();l.preventDefault()});b.on("click","a.continue-save-btn",function(l){l.stopPropagation();l.preventDefault()})}function a(){setTimeout(function(){if(b.find(".contract-enrolment").hasClass("amp-slide-right-out")){b.addClass("amp-display-hide");d()}b.find(".contract-enrolment").removeClass("amp-slide-right-out");b.find(".contract-enrolment").removeClass("amp-slide-left-in")},500)}function h(){}function d(){}function k(){e();c()}k()}]);ampApp.controller("noi-enrolment-controller",["$scope","$filter",function(k,e){k.record={year:2016,real1:"",real2:"",real3:"",real4:"",real5:"",real6:"",real7:"",real8:"",real9:"",real10:"",real11:"",real12:"",budget1:0,budget2:"",budget3:"",budget4:"",budget5:"",budget6:"",budget7:"",budget8:"",budget9:"",budget10:"",budget11:"",budget12:""};var m=new Date();var f=m.getFullYear();var c=m.getMonth()+1;var h="";if(c<10){h="0"+c}else{h=c}k.date=f+"-"+h;k.$on("$destroy",function(){j()});k.$on("noi-enrolment.change-month",function(n,o){k.date=o;k.$apply()});var a=null;function d(){a=$("#noi-enrolment")}function b(){$(a).find(".amp-datetimepicker input").datetimepicker({language:"zh-CN",format:"yyyy-mm-dd",todayBtn:"linked",startView:2,minView:2,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0});a.on("click","a.nav-back-btn",function(n){n.stopPropagation();n.preventDefault()});a.on("click","a.save-btn",function(n){n.stopPropagation();n.preventDefault()})}function j(){}function l(){d();b()}l()}]);ampApp.controller("noi-enrolment-left-controller",["$scope","$rootScope",function(d,a){d.$on("$destroy",function(){e()});var c=null;function b(){c=$("#noi-enrolment-left");amp_main.leftPanel_update();var j=new Date();var k=j.getFullYear();var l=j.getMonth()+1;if(l<10){l="0"+l}$(c).find(".amp-date-selector input").val(k+"-"+l);$(c).find(".amp-date-selector input").datetimepicker({language:"zh-CN",format:"yyyy-mm",todayBtn:"linked",startView:3,minView:3,weekStart:1,todayHighlight:1,autoclose:1,forceParse:0})}function h(){$(c).on("click touchend",".amp-date-selector .amp-date-selector-prev",function(n){n.stopPropagation();n.preventDefault();var o=$(this).closest(".amp-date-selector").find("input").val();var k=parseInt(o.split("-")[0]);var m=parseInt(o.split("-")[1]);m--;var j=new Date();j.setFullYear(k);j.setMonth(m-1);var l="";if(j.getMonth()+1<10){l="0"+(j.getMonth()+1)}else{l=(j.getMonth()+1)}$(this).closest(".amp-date-selector").find("input").val(j.getFullYear()+"-"+l);$(this).closest(".amp-date-selector").find("input").datetimepicker("update");a.$broadcast("noi-enrolment.change-month",j.getFullYear()+"-"+l)});$(c).on("click touchend",".amp-date-selector .amp-date-selector-next",function(n){n.stopPropagation();n.preventDefault();var o=$(this).closest(".amp-date-selector").find("input").val();var k=parseInt(o.split("-")[0]);var m=parseInt(o.split("-")[1]);m++;var j=new Date();j.setFullYear(k);j.setMonth(m-1);var l="";if(j.getMonth()+1<10){l="0"+(j.getMonth()+1)}else{l=(j.getMonth()+1)}$(this).closest(".amp-date-selector").find("input").val(j.getFullYear()+"-"+l);$(this).closest(".amp-date-selector").find("input").datetimepicker("update");a.$broadcast("noi-enrolment.change-month",j.getFullYear()+"-"+l)})}function e(){$(c).find(".amp-datetimepicker input").datetimepicker("remove")}function f(){b();h()}f()}]);